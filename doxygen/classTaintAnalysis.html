<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head><meta http-equiv="Content-Type" content="text/html;charset=iso-8859-1">
<title>ROSE: TaintAnalysis Class Reference</title>
<link href="doxygen.css" rel="stylesheet" type="text/css">
<link href="tabs.css" rel="stylesheet" type="text/css">
</head><body>
<!-- Generated by Doxygen 1.4.7 -->
<div class="tabs">
  <ul>
    <li><a href="main.html"><span>Main&nbsp;Page</span></a></li>
    <li><a href="modules.html"><span>Modules</span></a></li>
    <li><a href="namespaces.html"><span>Namespaces</span></a></li>
    <li id="current"><a href="annotated.html"><span>Classes</span></a></li>
    <li><a href="files.html"><span>Files</span></a></li>
    <li><a href="pages.html"><span>Related&nbsp;Pages</span></a></li>
    <li><a href="examples.html"><span>Examples</span></a></li>
    <li>
      <form action="search.php" method="get">
        <table cellspacing="0" cellpadding="0" border="0">
          <tr>
            <td><label>&nbsp;<u>S</u>earch&nbsp;for&nbsp;</label></td>
            <td><input type="text" name="query" value="" size="20" accesskey="s"/></td>
          </tr>
        </table>
      </form>
    </li>
  </ul></div>
<div class="tabs">
  <ul>
    <li><a href="annotated.html"><span>Class&nbsp;List</span></a></li>
    <li><a href="hierarchy.html"><span>Class&nbsp;Hierarchy</span></a></li>
    <li><a href="functions.html"><span>Class&nbsp;Members</span></a></li>
  </ul></div>
<h1>TaintAnalysis Class Reference</h1><!-- doxytag: class="TaintAnalysis" --><!-- doxytag: inherits="IntraFWDataflow" --><code>#include &lt;<a class="el" href="taintAnalysis_8h-source.html">taintAnalysis.h</a>&gt;</code>
<p>
Inheritance diagram for TaintAnalysis:<p><center><img src="classTaintAnalysis__inherit__graph.png" border="0" usemap="#TaintAnalysis__inherit__map" alt="Inheritance graph"></center>
<map name="TaintAnalysis__inherit__map">
<area href="classIntraFWDataflow.html" shape="rect" coords="40,393,165,420" alt="">
<area href="classIntraUniDirectionalDataflow.html" shape="rect" coords="5,316,200,343" alt="">
<area href="classIntraUnitDataflow.html" shape="rect" coords="37,239,168,265" alt="">
<area href="classIntraProceduralDataflow.html" shape="rect" coords="16,161,189,188" alt="">
<area href="classIntraProceduralAnalysis.html" shape="rect" coords="19,84,187,111" alt="">
<area href="classAnalysis.html" shape="rect" coords="65,7,140,33" alt="">
</map>
<center><font size="2">[<a target="top" href="graph_legend.html">legend</a>]</font></center>Collaboration diagram for TaintAnalysis:<p><center><img src="classTaintAnalysis__coll__graph.png" border="0" usemap="#TaintAnalysis__coll__map" alt="Collaboration graph"></center>
<map name="TaintAnalysis__coll__map">
<area href="classIntraFWDataflow.html" shape="rect" coords="24,476,149,503" alt="">
<area href="classIntraUniDirectionalDataflow.html" shape="rect" coords="5,343,200,369" alt="">
<area href="classIntraBWDataflow.html" shape="rect" coords="124,423,249,449" alt="">
<area href="classIntraUnitDataflow.html" shape="rect" coords="37,263,168,289" alt="">
<area href="classIntraProceduralDataflow.html" shape="rect" coords="16,183,189,209" alt="">
<area href="classIntraProceduralAnalysis.html" shape="rect" coords="137,87,305,113" alt="">
<area href="classInterProceduralAnalysis.html" shape="rect" coords="213,183,381,209" alt="">
<area href="classAnalysis.html" shape="rect" coords="300,7,375,33" alt="">
<area href="classLiveDeadVarsAnalysis.html" shape="rect" coords="124,529,287,556" alt="">
<area href="classfuncSideEffectUses.html" shape="rect" coords="273,423,420,449" alt="">
</map>
<center><font size="2">[<a target="top" href="graph_legend.html">legend</a>]</font></center><a href="classTaintAnalysis-members.html">List of all members.</a><hr><a name="_details"></a><h2>Detailed Description</h2>

<p>

<p>
Definition at line <a class="el" href="taintAnalysis_8h-source.html#l00134">134</a> of file <a class="el" href="taintAnalysis_8h-source.html">taintAnalysis.h</a>.<table border="0" cellpadding="0" cellspacing="0">
<tr><td></td></tr>
<tr><td colspan="2"><br><h2>Public Member Functions</h2></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classTaintAnalysis.html#1d71e9bb6adb63d7e1f5868cf9564f3d">TaintAnalysis</a> (<a class="el" href="classLiveDeadVarsAnalysis.html">LiveDeadVarsAnalysis</a> *<a class="el" href="classTaintAnalysis.html#438eede95572c38b334617ee111b5115">ldv_analysis</a>)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classTaintAnalysis.html#30c082b4ab5508943cfc43ab05516213">genInitState</a> (const <a class="el" href="classFunction.html">Function</a> &amp;func, const <a class="el" href="classVirtualCFG_1_1DataflowNode.html">DataflowNode</a> &amp;node, const <a class="el" href="classNodeState.html">NodeState</a> &amp;state, std::vector&lt; <a class="el" href="classLattice.html">Lattice</a> * &gt; &amp;initLattices, std::vector&lt; <a class="el" href="classNodeFact.html">NodeFact</a> * &gt; &amp;initFacts)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Generate initial lattice state.  <a href="#30c082b4ab5508943cfc43ab05516213"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">bool&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classTaintAnalysis.html#58a9dc7bcd324418a4ee576ec0b1c9e1">transfer</a> (const <a class="el" href="classFunction.html">Function</a> &amp;func, const <a class="el" href="classVirtualCFG_1_1DataflowNode.html">DataflowNode</a> &amp;node_, <a class="el" href="classNodeState.html">NodeState</a> &amp;state, const std::vector&lt; <a class="el" href="classLattice.html">Lattice</a> * &gt; &amp;dfInfo)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Adjust a result vertex pointer.  <a href="#58a9dc7bcd324418a4ee576ec0b1c9e1"></a><br></td></tr>
<tr><td colspan="2"><div class="groupHeader"></div></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">std::ostream *&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classTaintAnalysis.html#e69ccd5ce433fdb5bd6098750b1e4828">get_debug</a> () const </td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Accessor for debug settings.  <a href="#e69ccd5ce433fdb5bd6098750b1e4828"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classTaintAnalysis.html#eae6460ab3aaf2be202322afb973f62d">set_debug</a> (std::ostream *os)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Accessor for debug settings.  <a href="#eae6460ab3aaf2be202322afb973f62d"></a><br></td></tr>
<tr><td colspan="2"><br><h2>Protected Member Functions</h2></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">bool&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classTaintAnalysis.html#072ff509d9bdeaf7bb8c97443ae765b6">magic_tainted</a> (<a class="el" href="classSgNode.html">SgNode</a> *node, <a class="el" href="classFiniteVarsExprsProductLattice.html">FiniteVarsExprsProductLattice</a> *prodLat)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Make certain variables always tainted.  <a href="#072ff509d9bdeaf7bb8c97443ae765b6"></a><br></td></tr>
<tr><td colspan="2"><br><h2>Static Protected Member Functions</h2></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">static std::string&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classTaintAnalysis.html#ea22d6b1d2ec147510113c8cc7caecb8">lattice_info</a> (const <a class="el" href="classTaintLattice.html">TaintLattice</a> *lattice)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Helps print lattice pointers.  <a href="#ea22d6b1d2ec147510113c8cc7caecb8"></a><br></td></tr>
<tr><td colspan="2"><br><h2>Protected Attributes</h2></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="el" href="classLiveDeadVarsAnalysis.html">LiveDeadVarsAnalysis</a> *&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classTaintAnalysis.html#438eede95572c38b334617ee111b5115">ldv_analysis</a></td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">std::ostream *&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classTaintAnalysis.html#6d82fdaab64e93f035705c9eef5601f2">debug</a></td></tr>

</table>
<hr><h2>Constructor &amp; Destructor Documentation</h2>
<a class="anchor" name="1d71e9bb6adb63d7e1f5868cf9564f3d"></a><!-- doxytag: member="TaintAnalysis::TaintAnalysis" ref="1d71e9bb6adb63d7e1f5868cf9564f3d" args="(LiveDeadVarsAnalysis *ldv_analysis)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">TaintAnalysis::TaintAnalysis           </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classLiveDeadVarsAnalysis.html">LiveDeadVarsAnalysis</a> *&nbsp;</td>
          <td class="paramname"> <em>ldv_analysis</em>          </td>
          <td>&nbsp;)&nbsp;</td>
          <td width="100%"><code> [inline]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>

<p>
Definition at line <a class="el" href="taintAnalysis_8h-source.html#l00143">143</a> of file <a class="el" href="taintAnalysis_8h-source.html">taintAnalysis.h</a>.
</div>
</div><p>
<hr><h2>Member Function Documentation</h2>
<a class="anchor" name="e69ccd5ce433fdb5bd6098750b1e4828"></a><!-- doxytag: member="TaintAnalysis::get_debug" ref="e69ccd5ce433fdb5bd6098750b1e4828" args="() const " -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">std::ostream* TaintAnalysis::get_debug           </td>
          <td>(</td>
          <td class="paramname">          </td>
          <td>&nbsp;)&nbsp;</td>
          <td width="100%"> const<code> [inline]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Accessor for debug settings. 
<p>
If a non-null output stream is supplied, then debugging information will be sent to that stream; otherwise debugging information is suppressed. Debugging is disabled by default. 
<p>
Definition at line <a class="el" href="taintAnalysis_8h-source.html#l00149">149</a> of file <a class="el" href="taintAnalysis_8h-source.html">taintAnalysis.h</a>.
<p>
References <a class="el" href="taintAnalysis_8h-source.html#l00137">debug</a>.
</div>
</div><p>
<a class="anchor" name="eae6460ab3aaf2be202322afb973f62d"></a><!-- doxytag: member="TaintAnalysis::set_debug" ref="eae6460ab3aaf2be202322afb973f62d" args="(std::ostream *os)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void TaintAnalysis::set_debug           </td>
          <td>(</td>
          <td class="paramtype">std::ostream *&nbsp;</td>
          <td class="paramname"> <em>os</em>          </td>
          <td>&nbsp;)&nbsp;</td>
          <td width="100%"><code> [inline]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Accessor for debug settings. 
<p>
If a non-null output stream is supplied, then debugging information will be sent to that stream; otherwise debugging information is suppressed. Debugging is disabled by default. 
<p>
Definition at line <a class="el" href="taintAnalysis_8h-source.html#l00150">150</a> of file <a class="el" href="taintAnalysis_8h-source.html">taintAnalysis.h</a>.
<p>
References <a class="el" href="taintAnalysis_8h-source.html#l00137">debug</a>.
</div>
</div><p>
<a class="anchor" name="30c082b4ab5508943cfc43ab05516213"></a><!-- doxytag: member="TaintAnalysis::genInitState" ref="30c082b4ab5508943cfc43ab05516213" args="(const Function &amp;func, const DataflowNode &amp;node, const NodeState &amp;state, std::vector&lt; Lattice * &gt; &amp;initLattices, std::vector&lt; NodeFact * &gt; &amp;initFacts)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void TaintAnalysis::genInitState           </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="classFunction.html">Function</a> &amp;&nbsp;</td>
          <td class="paramname"> <em>func</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classVirtualCFG_1_1DataflowNode.html">DataflowNode</a> &amp;&nbsp;</td>
          <td class="paramname"> <em>node</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classNodeState.html">NodeState</a> &amp;&nbsp;</td>
          <td class="paramname"> <em>state</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">std::vector&lt; <a class="el" href="classLattice.html">Lattice</a> * &gt; &amp;&nbsp;</td>
          <td class="paramname"> <em>initLattices</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">std::vector&lt; <a class="el" href="classNodeFact.html">NodeFact</a> * &gt; &amp;&nbsp;</td>
          <td class="paramname"> <em>initFacts</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td width="100%"><code> [virtual]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Generate initial lattice state. 
<p>
Generates the initial lattice state for the given dataflow node, in the given function, with the given node state. 
<p>
Implements <a class="el" href="classIntraProceduralDataflow.html#76dd5e2d5be3dfe73a8446f39f5a8feb">IntraProceduralDataflow</a>.
</div>
</div><p>
<a class="anchor" name="58a9dc7bcd324418a4ee576ec0b1c9e1"></a><!-- doxytag: member="TaintAnalysis::transfer" ref="58a9dc7bcd324418a4ee576ec0b1c9e1" args="(const Function &amp;func, const DataflowNode &amp;node_, NodeState &amp;state, const std::vector&lt; Lattice * &gt; &amp;dfInfo)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool TaintAnalysis::transfer           </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="classFunction.html">Function</a> &amp;&nbsp;</td>
          <td class="paramname"> <em>func</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classVirtualCFG_1_1DataflowNode.html">DataflowNode</a> &amp;&nbsp;</td>
          <td class="paramname"> <em>node_</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classNodeState.html">NodeState</a> &amp;&nbsp;</td>
          <td class="paramname"> <em>state</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const std::vector&lt; <a class="el" href="classLattice.html">Lattice</a> * &gt; &amp;&nbsp;</td>
          <td class="paramname"> <em>dfInfo</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td width="100%"><code> [virtual]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Adjust a result vertex pointer. 
<p>
This function has an opportunity to adjust the result lattice vertex pointer based on input lattice vertices at a particular AST node at a particular time in the data flow. For instance, if the AST node is an <a class="el" href="classSgAddOp.html">SgAddOp</a> binry operation then we can obtain the vertices to which the two operands point (say, VERTEX_TAINTED and VERTEX_UNTAINTED) and adjust the result so it points to a particular vertex (say, VERTEX_TAINTED).<p>
This method returns true if it changed where the result points, and false otherwise. For example, if the result originally pointed to VERTEX_BOTTOM but now points to VERTEX_TAINTED then we would return true. 
<p>
Implements <a class="el" href="classIntraUnitDataflow.html#f90d475c8bbb60c00982377fda98d45c">IntraUnitDataflow</a>.
</div>
</div><p>
<a class="anchor" name="ea22d6b1d2ec147510113c8cc7caecb8"></a><!-- doxytag: member="TaintAnalysis::lattice_info" ref="ea22d6b1d2ec147510113c8cc7caecb8" args="(const TaintLattice *lattice)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">static std::string TaintAnalysis::lattice_info           </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="classTaintLattice.html">TaintLattice</a> *&nbsp;</td>
          <td class="paramname"> <em>lattice</em>          </td>
          <td>&nbsp;)&nbsp;</td>
          <td width="100%"><code> [inline, static, protected]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Helps print lattice pointers. 
<p>
Like std::cout &lt;&lt;"lhs lattice is " &lt;&lt;lattice_info(lhs) &lt;&lt;"\n". Convenient because the live/dead analysis causes some lattices to be missing (null). 
<p>
Definition at line <a class="el" href="taintAnalysis_8h-source.html#l00189">189</a> of file <a class="el" href="taintAnalysis_8h-source.html">taintAnalysis.h</a>.
<p>
References <a class="el" href="classTaintLattice.html#b052496a5329679e5b613f8238b81170">TaintLattice::to_string()</a>.
</div>
</div><p>
<a class="anchor" name="072ff509d9bdeaf7bb8c97443ae765b6"></a><!-- doxytag: member="TaintAnalysis::magic_tainted" ref="072ff509d9bdeaf7bb8c97443ae765b6" args="(SgNode *node, FiniteVarsExprsProductLattice *prodLat)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool TaintAnalysis::magic_tainted           </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classSgNode.html">SgNode</a> *&nbsp;</td>
          <td class="paramname"> <em>node</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classFiniteVarsExprsProductLattice.html">FiniteVarsExprsProductLattice</a> *&nbsp;</td>
          <td class="paramname"> <em>prodLat</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td width="100%"><code> [protected]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Make certain variables always tainted. 
<p>
Variables whose names begin with the string "TAINTED" are assumed to be tainted regardless of their situation. This is our currently kludgy way of introducing taint into a specimen -- the user modifies the specimen and introduces taint with these specially named variables. E.g.,<p>
<div class="fragment"><pre class="fragment">   ORIGINAL                               MODIFIED
   ------------------------------------   ------------------------------------
   <span class="keywordtype">int</span> specimen() {                       <span class="keywordtype">int</span> specimen() {
                                              <span class="keyword">extern</span> <span class="keywordtype">int</span> TAINTED;
       <span class="keywordtype">int</span> a = 2 * foo();                     <span class="keywordtype">int</span> a = 2 * foo() + TAINTED;
       <span class="keywordflow">return</span> a;                              <span class="keywordflow">return</span> a;
   }                                      }
</pre></div> 
</div>
</div><p>
<hr><h2>Member Data Documentation</h2>
<a class="anchor" name="438eede95572c38b334617ee111b5115"></a><!-- doxytag: member="TaintAnalysis::ldv_analysis" ref="438eede95572c38b334617ee111b5115" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classLiveDeadVarsAnalysis.html">LiveDeadVarsAnalysis</a>* <a class="el" href="classTaintAnalysis.html#438eede95572c38b334617ee111b5115">TaintAnalysis::ldv_analysis</a><code> [protected]</code>          </td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>

<p>
Definition at line <a class="el" href="taintAnalysis_8h-source.html#l00136">136</a> of file <a class="el" href="taintAnalysis_8h-source.html">taintAnalysis.h</a>.
</div>
</div><p>
<a class="anchor" name="6d82fdaab64e93f035705c9eef5601f2"></a><!-- doxytag: member="TaintAnalysis::debug" ref="6d82fdaab64e93f035705c9eef5601f2" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">std::ostream* <a class="el" href="classTaintAnalysis.html#6d82fdaab64e93f035705c9eef5601f2">TaintAnalysis::debug</a><code> [protected]</code>          </td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>

<p>
Definition at line <a class="el" href="taintAnalysis_8h-source.html#l00137">137</a> of file <a class="el" href="taintAnalysis_8h-source.html">taintAnalysis.h</a>.
<p>
Referenced by <a class="el" href="taintAnalysis_8h-source.html#l00149">get_debug()</a>, and <a class="el" href="taintAnalysis_8h-source.html#l00150">set_debug()</a>.
</div>
</div><p>
<hr>The documentation for this class was generated from the following file:<ul>
<li><a class="el" href="taintAnalysis_8h-source.html">taintAnalysis.h</a></ul>
<hr size="1"><address style="align: right;"><small>Generated on 20 Jan 2013 for ROSE by&nbsp;
<a href="http://www.doxygen.org/index.html">
<img src="doxygen.png" alt="doxygen" align="middle" border="0"></a> 1.4.7 </small></address>
</body>
</html>
