<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head><meta http-equiv="Content-Type" content="text/html;charset=iso-8859-1">
<title>ROSE: Shared vs. Nonshared IR Nodes within Sage III</title>
<link href="doxygen.css" rel="stylesheet" type="text/css">
<link href="tabs.css" rel="stylesheet" type="text/css">
</head><body>
<!-- Generated by Doxygen 1.4.7 -->
<div class="tabs">
  <ul>
    <li><a href="main.html"><span>Main&nbsp;Page</span></a></li>
    <li><a href="modules.html"><span>Modules</span></a></li>
    <li><a href="namespaces.html"><span>Namespaces</span></a></li>
    <li><a href="annotated.html"><span>Classes</span></a></li>
    <li><a href="files.html"><span>Files</span></a></li>
    <li><a href="pages.html"><span>Related&nbsp;Pages</span></a></li>
    <li><a href="examples.html"><span>Examples</span></a></li>
    <li>
      <form action="search.php" method="get">
        <table cellspacing="0" cellpadding="0" border="0">
          <tr>
            <td><label>&nbsp;<u>S</u>earch&nbsp;for&nbsp;</label></td>
            <td><input type="text" name="query" value="" size="20" accesskey="s"/></td>
          </tr>
        </table>
      </form>
    </li>
  </ul></div>
<h1><a class="anchor" name="SharedNodes">Shared vs. Nonshared IR Nodes within Sage III</a></h1>Within the AST some types of IR nodes referenced via pointers and are shared while others are never shared:<ul>
<li>Never shared IR nodes:<ol type=a>
<li><a class="el" href="classSg__File__Info.html">Sg_File_Info</a> (this is only a warning and not an error, at present)</li><li><a class="el" href="classSgStatement.html">SgStatement</a> (all but <a class="el" href="classSgDeclarationStatement.html">SgDeclarationStatement</a> IR nodes)</li><li><a class="el" href="classSgExpression.html">SgExpression</a></li><li><a class="el" href="classSgProject.html">SgProject</a></li><li><a class="el" href="classSgFile.html">SgFile</a></li><li><a class="el" href="classSgFileList.html">SgFileList</a></li><li><a class="el" href="classSgDirectory.html">SgDirectory</a></li><li><a class="el" href="classSgDirectoryList.html">SgDirectoryList</a></li><li><a class="el" href="classSgInitializedName.html">SgInitializedName</a></li></ol>
</li><li>Sometimes shared IR nodes:<ol type=a>
<li><a class="el" href="classSgDeclarationStatement.html">SgDeclarationStatement</a></li></ol>
</li><li>Always Shared IR nodes:<ol type=a>
<li><a class="el" href="classSgType.html">SgType</a> (all types derived from <a class="el" href="classSgType.html">SgType</a>)</li><li><a class="el" href="classSgSymbol.html">SgSymbol</a> (all types derived from <a class="el" href="classSgSymbol.html">SgSymbol</a> and having the same name in the same scope) Other IR nodes are never referenced directly by pointers (stored as data members instead of pointer to instances):</li></ol>
<ul>
<li><a class="el" href="classSgName.html">SgName</a></li><li><a class="el" href="classSgModifier.html">SgModifier</a> (and all classes derived from <a class="el" href="classSgModifier.html">SgModifier</a>)</li></ul>
</li></ul>
<p>
Within the AST it makes since to share some IR nodes and not share others. Still other IR nodes become special cases that are sometimes shared. Types are good IR nodes to share since within the language definition, within any scope a type can have only a single definition. Any statement referencing that type can thus share a reference with any other statement. Any change to that type thus effects all the statements refeerencing that type, this is reasonable and intuitive behavior. Symbols are related to types in that they hold the mapping between declarations (which might define types, as in <a class="el" href="classSgClassDeclaration.html">SgClassDeclaration</a>) and variable names. In general, since within C++ a name is unique within a single scope a <a class="el" href="classSgSymbol.html">SgSymbol</a> object is unique and thus shared between all possible references (as long as it referes to a unique named entity, variable name, type name, etc.).<p>
Some IR nodes are not meant to be shared, many <a class="el" href="classSgStatement.html">SgStatement</a> and <a class="el" href="classSgExpression.html">SgExpression</a> nodes (classes derived from <a class="el" href="classSgStatement.html">SgStatement</a> and <a class="el" href="classSgExpression.html">SgExpression</a>) are like this. And expression exists once within the AST and is not shared. Again the structure of C++ as a language is used as a guide, expressions are written once within a single location within the source code and C++ provides no mechanism for share references to the same expression. Most C++ statements have a similar representation (e.g. a <a class="el" href="classSgForStatement.html">SgForStatement</a> is not shared within the AST).<p>
Some cases are more complex and require special attention, SgDeclarationStatements fit into this catagory. Where they are used within types, symbols, typedefs, etc., they can be shared. However, where they appear as forward declarations by them selves as statements they are reprlicated. Thus two forward declarations to the same class, function, member function, enum, etc., will exist as two separate declarations, each referencing the same definition (for class, function, or member function declaration).<p>
With the new AST Merge mechanism, many more declartions can now be shared as part of the merger of different AST from files that may change some of the same header files.<p>
Some AST tests confirm/test the sharing and nonsharing semantics within the Sage III AST (<dl compact><dt><b>See also:</b></dt><dd>AST_Diagnostics):<ul>
<li>All statements in a single scope are unique</li><li>All <a class="el" href="classSg__File__Info.html">Sg_File_Info</a> objects are unique </li></ul>
</dd></dl>
<hr size="1"><address style="align: right;"><small>Generated on 20 Jan 2013 for ROSE by&nbsp;
<a href="http://www.doxygen.org/index.html">
<img src="doxygen.png" alt="doxygen" align="middle" border="0"></a> 1.4.7 </small></address>
</body>
</html>
