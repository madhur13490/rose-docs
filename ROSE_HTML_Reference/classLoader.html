<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head><meta http-equiv="Content-Type" content="text/html;charset=iso-8859-1">
<title>ROSE: Loader Class Reference</title>
<link href="doxygen.css" rel="stylesheet" type="text/css">
<link href="tabs.css" rel="stylesheet" type="text/css">
</head><body>
<!-- Generated by Doxygen 1.4.7 -->
<div class="tabs">
  <ul>
    <li><a href="main.html"><span>Main&nbsp;Page</span></a></li>
    <li><a href="modules.html"><span>Modules</span></a></li>
    <li><a href="namespaces.html"><span>Namespaces</span></a></li>
    <li id="current"><a href="annotated.html"><span>Classes</span></a></li>
    <li><a href="files.html"><span>Files</span></a></li>
    <li><a href="pages.html"><span>Related&nbsp;Pages</span></a></li>
    <li><a href="examples.html"><span>Examples</span></a></li>
    <li>
      <form action="search.php" method="get">
        <table cellspacing="0" cellpadding="0" border="0">
          <tr>
            <td><label>&nbsp;<u>S</u>earch&nbsp;for&nbsp;</label></td>
            <td><input type="text" name="query" value="" size="20" accesskey="s"/></td>
          </tr>
        </table>
      </form>
    </li>
  </ul></div>
<div class="tabs">
  <ul>
    <li><a href="annotated.html"><span>Class&nbsp;List</span></a></li>
    <li><a href="hierarchy.html"><span>Class&nbsp;Hierarchy</span></a></li>
    <li><a href="functions.html"><span>Class&nbsp;Members</span></a></li>
  </ul></div>
<h1>Loader Class Reference</h1><!-- doxytag: class="Loader" --><code>#include &lt;<a class="el" href="Loader_8h-source.html">Loader.h</a>&gt;</code>
<p>
Inheritance diagram for Loader:<p><center><img src="classLoader__inherit__graph.png" border="0" usemap="#Loader__inherit__map" alt="Inheritance graph"></center>
<map name="Loader__inherit__map">
<area href="classLoaderELF.html" shape="rect" coords="17,84,103,111" alt="">
<area href="classLoaderPE.html" shape="rect" coords="127,84,207,111" alt="">
<area href="classLoaderELFObj.html" shape="rect" coords="5,161,115,188" alt="">
</map>
<center><font size="2">[<a target="top" href="graph_legend.html">legend</a>]</font></center><a href="classLoader-members.html">List of all members.</a><hr><a name="_details"></a><h2>Detailed Description</h2>
This class is the interface for binary file loaders. 
<p>
A <a class="el" href="classLoader.html">Loader</a> is reponsible for constructing a <a class="el" href="classMemoryMap.html">MemoryMap</a> describing a mapping from virtual memory to file content and emulates the actions taken by real-world loaders. Each real-world loader will be represented as a subclass of <a class="el" href="classLoader.html">Loader</a>. The loaders are registered with ROSE by calling register_loader(), making them available to modules such as the instruction disassembler.<p>
For example, given a Windows PE executable containing a DOS executable and a PE executable, this is how one would create a mapping to describe all the code-containing sections that are part of the PE executable:<p>
<div class="fragment"><pre class="fragment">  <a class="code" href="classSgAsmPEFileHeader.html">SgAsmPEFileHeader</a> *pe_header = ...;
  <a class="code" href="classLoader.html">Loader</a> *loader = <a class="code" href="classLoader.html#834cf99ed03ee2fef2afb3510e988e55">Loader::find_loader</a>(pe_header); <span class="comment">// Get the best loader for PE</span>
  <a class="code" href="classMemoryMap.html">MemoryMap</a> *map = loader-&gt;<a class="code" href="classLoader.html#73f93ddcc81c149983d0512448518add">map_code_sections</a>(pe_header);
</pre></div><p>
The high-level functions, <a class="el" href="classLoader.html#15e91c426af24473cd85a7028d8fe34a">map_all_sections()</a>, <a class="el" href="classLoader.html#73f93ddcc81c149983d0512448518add">map_code_sections()</a>, <a class="el" href="classLoader.html#f02b353a6664cd40898e0410d6bb0bad">map_executable_sections()</a>, <a class="el" href="classLoader.html#681132f07ea47cf919d13f54e3e1e309">map_writable_sections()</a>, and possibly others in the future each have three overloaded versions: one that selects sections from the entire file, one that selects sections belonging to a particular binary header, and one that selects sections from a specified list. These are all declared virtual so that a subclass can provide new definitions, although normally only the last version (the one that takes a list of sections) is overridden since the other two are defined in terms of it.<p>
The high-level functions then call <a class="el" href="classLoader.html#23401962c4f727ea6abe50066010d54f">create_map()</a>, supplying a local class using the <a class="el" href="classLoader_1_1Selector.html">Selector</a> interface to describe which specific sections contribute to the final mapping and how they contribute. The sections are sorted (see <a class="el" href="classLoader.html#376bcc8d6d63f42e6af4333d42c431f3">order_sections()</a>) and then each contributing section is then run through the <a class="el" href="classLoader.html#a3e285b9e9351122e80b444502b564f8">align_values()</a> method to satisfy alignment constraints, choose new virtual addresses, and/or eliminate the section from consideration.<p>
Finally, once values are aligned addresses are added to or removed from the <a class="el" href="classMemoryMap.html">MemoryMap</a> that is eventually returned. For each section that is added to the memory map, the section's starting address is assigned with <a class="el" href="classSgAsmGenericSection.html#a07a22e01606f4fe86d28d1624e1ff32">SgAsmGenericSection::set_mapped_actual_rva()</a>. 
<p>
<table border="0" cellpadding="0" cellspacing="0">
<tr><td></td></tr>
<tr><td colspan="2"><br><h2>Public Types</h2></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classLoader.html#820ed89e67b157f4447f609de206614537f4bacf35a1e562d27aef722314986f">CONTRIBUTE_NONE</a></td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Section does not contribute to final mapping.  <a href="#820ed89e67b157f4447f609de206614537f4bacf35a1e562d27aef722314986f"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classLoader.html#820ed89e67b157f4447f609de20661457a142150b6c585d41acc847ddce50ab5">CONTRIBUTE_ADD</a></td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Section is added to the mapping.  <a href="#820ed89e67b157f4447f609de20661457a142150b6c585d41acc847ddce50ab5"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classLoader.html#820ed89e67b157f4447f609de20661451590d4f8f58ec81e544eb9c780bec149">CONTRIBUTE_SUB</a></td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Section is subtracted from the mapping.  <a href="#820ed89e67b157f4447f609de20661451590d4f8f58ec81e544eb9c780bec149"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">enum &nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classLoader.html#820ed89e67b157f4447f609de2066145">Contribution</a> { <br>
&nbsp;&nbsp;<a class="el" href="classLoader.html#820ed89e67b157f4447f609de206614537f4bacf35a1e562d27aef722314986f">CONTRIBUTE_NONE</a>, 
<br>
&nbsp;&nbsp;<a class="el" href="classLoader.html#820ed89e67b157f4447f609de20661457a142150b6c585d41acc847ddce50ab5">CONTRIBUTE_ADD</a>, 
<br>
&nbsp;&nbsp;<a class="el" href="classLoader.html#820ed89e67b157f4447f609de20661451590d4f8f58ec81e544eb9c780bec149">CONTRIBUTE_SUB</a>
<br>
 }</td></tr>

<tr><td colspan="2"><br><h2>Public Member Functions</h2></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classLoader.html#74f03e0603181535652621209de19aab">Loader</a> ()</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">virtual&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classLoader.html#d005d4f811cbdd00f14befa928126b33">~Loader</a> ()</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">virtual bool&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classLoader.html#a823d8c34f91ab8f0fbddf30a139da09">can_handle</a> (<a class="el" href="classSgAsmGenericHeader.html">SgAsmGenericHeader</a> *)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Indicates whether a loader can handle a specific type of file.  <a href="#a823d8c34f91ab8f0fbddf30a139da09"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">virtual <a class="el" href="classMemoryMap.html">MemoryMap</a> *&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classLoader.html#15e91c426af24473cd85a7028d8fe34a">map_all_sections</a> (<a class="el" href="classMemoryMap.html">MemoryMap</a> *map, <a class="el" href="classSgAsmGenericFile.html">SgAsmGenericFile</a> *file, bool allow_overmap=true)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Creates a map containing all mappable sections in the file.  <a href="#15e91c426af24473cd85a7028d8fe34a"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">virtual <a class="el" href="classMemoryMap.html">MemoryMap</a> *&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classLoader.html#c945df394df8d75e130b705bea7df9bb">map_all_sections</a> (<a class="el" href="classMemoryMap.html">MemoryMap</a> *map, <a class="el" href="classSgAsmGenericHeader.html">SgAsmGenericHeader</a> *fhdr, bool allow_overmap=true)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Creates a map containing all mappable sections in a file header.  <a href="#c945df394df8d75e130b705bea7df9bb"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">virtual <a class="el" href="classMemoryMap.html">MemoryMap</a> *&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classLoader.html#7ea9f62a6bc3df26a2ee39fdb3ed3240">map_all_sections</a> (<a class="el" href="classMemoryMap.html">MemoryMap</a> *, const <a class="el" href="Cxx__Grammar_8h.html#69641d670cf625a600a51ee017219d0e">SgAsmGenericSectionPtrList</a> &amp;sections, bool allow_overmap=true)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Creates a map containing the specified sections (if they are mapped).  <a href="#7ea9f62a6bc3df26a2ee39fdb3ed3240"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">virtual <a class="el" href="classMemoryMap.html">MemoryMap</a> *&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classLoader.html#73f93ddcc81c149983d0512448518add">map_code_sections</a> (<a class="el" href="classMemoryMap.html">MemoryMap</a> *map, <a class="el" href="classSgAsmGenericFile.html">SgAsmGenericFile</a> *file, bool allow_overmap=true)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Creates a map for all code-containing sections in the file.  <a href="#73f93ddcc81c149983d0512448518add"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">virtual <a class="el" href="classMemoryMap.html">MemoryMap</a> *&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classLoader.html#77a140386e7f6bbcd9f28877ac6d07ee">map_code_sections</a> (<a class="el" href="classMemoryMap.html">MemoryMap</a> *map, <a class="el" href="classSgAsmGenericHeader.html">SgAsmGenericHeader</a> *fhdr, bool allow_overmap=true)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Creates a map for all code-containing sections reachable from the file header.  <a href="#77a140386e7f6bbcd9f28877ac6d07ee"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">virtual <a class="el" href="classMemoryMap.html">MemoryMap</a> *&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classLoader.html#8e652960415b44d41308e4b66566046d">map_code_sections</a> (<a class="el" href="classMemoryMap.html">MemoryMap</a> *, const <a class="el" href="Cxx__Grammar_8h.html#69641d670cf625a600a51ee017219d0e">SgAsmGenericSectionPtrList</a> &amp;sections, bool allow_overmap=true)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Creates a map for all code-containing sections from the specified list.  <a href="#8e652960415b44d41308e4b66566046d"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">virtual <a class="el" href="classMemoryMap.html">MemoryMap</a> *&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classLoader.html#f02b353a6664cd40898e0410d6bb0bad">map_executable_sections</a> (<a class="el" href="classMemoryMap.html">MemoryMap</a> *map, <a class="el" href="classSgAsmGenericFile.html">SgAsmGenericFile</a> *file, bool allow_overmap=true)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Creates a map for all executable sections in the file.  <a href="#f02b353a6664cd40898e0410d6bb0bad"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">virtual <a class="el" href="classMemoryMap.html">MemoryMap</a> *&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classLoader.html#481c250b4c96091326fd59da596d667b">map_executable_sections</a> (<a class="el" href="classMemoryMap.html">MemoryMap</a> *map, <a class="el" href="classSgAsmGenericHeader.html">SgAsmGenericHeader</a> *fhdr, bool allow_overmap=true)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Creates a map for all executable sections reachable from the file header.  <a href="#481c250b4c96091326fd59da596d667b"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">virtual <a class="el" href="classMemoryMap.html">MemoryMap</a> *&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classLoader.html#8e445fbbcb20e4c058bfbaee647e5cd1">map_executable_sections</a> (<a class="el" href="classMemoryMap.html">MemoryMap</a> *, const <a class="el" href="Cxx__Grammar_8h.html#69641d670cf625a600a51ee017219d0e">SgAsmGenericSectionPtrList</a> &amp;sections, bool allow_overmap=true)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Creates a map for all executable sections from the specified list.  <a href="#8e445fbbcb20e4c058bfbaee647e5cd1"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">virtual <a class="el" href="classMemoryMap.html">MemoryMap</a> *&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classLoader.html#681132f07ea47cf919d13f54e3e1e309">map_writable_sections</a> (<a class="el" href="classMemoryMap.html">MemoryMap</a> *map, <a class="el" href="classSgAsmGenericFile.html">SgAsmGenericFile</a> *file, bool allow_overmap=true)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Creates a map for all writable sections in the file.  <a href="#681132f07ea47cf919d13f54e3e1e309"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">virtual <a class="el" href="classMemoryMap.html">MemoryMap</a> *&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classLoader.html#917936ca19d17c7453db87a784069c2b">map_writable_sections</a> (<a class="el" href="classMemoryMap.html">MemoryMap</a> *map, <a class="el" href="classSgAsmGenericHeader.html">SgAsmGenericHeader</a> *fhdr, bool allow_overmap=true)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Creates a map for all writable sections reachable from the file header.  <a href="#917936ca19d17c7453db87a784069c2b"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">virtual <a class="el" href="classMemoryMap.html">MemoryMap</a> *&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classLoader.html#b724b99fd5a29701f10839ec92985c0d">map_writable_sections</a> (<a class="el" href="classMemoryMap.html">MemoryMap</a> *, const <a class="el" href="Cxx__Grammar_8h.html#69641d670cf625a600a51ee017219d0e">SgAsmGenericSectionPtrList</a> &amp;sections, bool allow_overmap=true)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Creates a map for all writable sections from the specified list.  <a href="#b724b99fd5a29701f10839ec92985c0d"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">virtual rose_addr_t&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classLoader.html#a3e285b9e9351122e80b444502b564f8">align_values</a> (<a class="el" href="classSgAsmGenericSection.html">SgAsmGenericSection</a> *, <a class="el" href="classLoader.html#820ed89e67b157f4447f609de2066145">Contribution</a>, rose_addr_t *va, rose_addr_t *mem_size, rose_addr_t *offset, rose_addr_t *file_size, const <a class="el" href="classMemoryMap.html">MemoryMap</a> *current)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Computes memory mapping addresses for a section.  <a href="#a3e285b9e9351122e80b444502b564f8"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">virtual <a class="el" href="Cxx__Grammar_8h.html#69641d670cf625a600a51ee017219d0e">SgAsmGenericSectionPtrList</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classLoader.html#376bcc8d6d63f42e6af4333d42c431f3">order_sections</a> (const <a class="el" href="Cxx__Grammar_8h.html#69641d670cf625a600a51ee017219d0e">SgAsmGenericSectionPtrList</a> &amp;)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Sort sections for mapping.  <a href="#376bcc8d6d63f42e6af4333d42c431f3"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">virtual <a class="el" href="classMemoryMap.html">MemoryMap</a> *&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classLoader.html#23401962c4f727ea6abe50066010d54f">create_map</a> (<a class="el" href="classMemoryMap.html">MemoryMap</a> *map, const <a class="el" href="Cxx__Grammar_8h.html#69641d670cf625a600a51ee017219d0e">SgAsmGenericSectionPtrList</a> &amp;, <a class="el" href="classLoader_1_1Selector.html">Selector</a> *, bool allow_overmap=true)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Creates a memory map containing sections that satisfy some constraint.  <a href="#23401962c4f727ea6abe50066010d54f"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classLoader.html#5c38dd75ed82e43e9a8fe1e8073d710e">set_debug</a> (FILE *f)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Turns debugging output on or off.  <a href="#5c38dd75ed82e43e9a8fe1e8073d710e"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">FILE *&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classLoader.html#68233cb023b440260ee22fd1d24aa9c8">get_debug</a> () const </td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Returns debugging status.  <a href="#68233cb023b440260ee22fd1d24aa9c8"></a><br></td></tr>
<tr><td colspan="2"><br><h2>Static Public Member Functions</h2></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">static void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classLoader.html#80143c5479eaa7e470068851f131058d">register_subclass</a> (<a class="el" href="classLoader.html">Loader</a> *)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Class method to register a loader.  <a href="#80143c5479eaa7e470068851f131058d"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">static <a class="el" href="classLoader.html">Loader</a> *&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classLoader.html#834cf99ed03ee2fef2afb3510e988e55">find_loader</a> (<a class="el" href="classSgAsmGenericHeader.html">SgAsmGenericHeader</a> *)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Class method to find a registered loader supporting the specified file header.  <a href="#834cf99ed03ee2fef2afb3510e988e55"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">static void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classLoader.html#c96fd6526c5b19301dd5890b234f2384">initclass</a> ()</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Class method to register ROSE built-in loaders.  <a href="#c96fd6526c5b19301dd5890b234f2384"></a><br></td></tr>
<tr><td colspan="2"><br><h2>Private Member Functions</h2></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classLoader.html#975347158ba12cf9c1f836a3687db03b">ctor</a> ()</td></tr>

<tr><td colspan="2"><br><h2>Private Attributes</h2></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">FILE *&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classLoader.html#707e243b85129f6195d18e6a106d11e2">p_debug</a></td></tr>

<tr><td colspan="2"><br><h2>Static Private Attributes</h2></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">static std::vector&lt; <a class="el" href="classLoader.html">Loader</a> * &gt;&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classLoader.html#c5c3a3d246740076039ca7afd6a047e9">p_registered</a></td></tr>

<tr><td colspan="2"><br><h2>Classes</h2></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">class &nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classLoader_1_1Selector.html">Selector</a></td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">The interface for deciding whether a section contributes to a mapping.  <a href="classLoader_1_1Selector.html#_details">More...</a><br></td></tr>
</table>
<hr><h2>Member Enumeration Documentation</h2>
<a class="anchor" name="820ed89e67b157f4447f609de2066145"></a><!-- doxytag: member="Loader::Contribution" ref="820ed89e67b157f4447f609de2066145" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">enum <a class="el" href="classLoader.html#820ed89e67b157f4447f609de2066145">Loader::Contribution</a>          </td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
<dl compact><dt><b>Enumerator: </b></dt><dd>
<table border="0" cellspacing="2" cellpadding="0">
<tr><td valign="top"><em><a class="anchor" name="820ed89e67b157f4447f609de206614537f4bacf35a1e562d27aef722314986f"></a><!-- doxytag: member="CONTRIBUTE_NONE" ref="820ed89e67b157f4447f609de206614537f4bacf35a1e562d27aef722314986f" args="" -->CONTRIBUTE_NONE</em>&nbsp;</td><td>
Section does not contribute to final mapping. </td></tr>
<tr><td valign="top"><em><a class="anchor" name="820ed89e67b157f4447f609de20661457a142150b6c585d41acc847ddce50ab5"></a><!-- doxytag: member="CONTRIBUTE_ADD" ref="820ed89e67b157f4447f609de20661457a142150b6c585d41acc847ddce50ab5" args="" -->CONTRIBUTE_ADD</em>&nbsp;</td><td>
Section is added to the mapping. </td></tr>
<tr><td valign="top"><em><a class="anchor" name="820ed89e67b157f4447f609de20661451590d4f8f58ec81e544eb9c780bec149"></a><!-- doxytag: member="CONTRIBUTE_SUB" ref="820ed89e67b157f4447f609de20661451590d4f8f58ec81e544eb9c780bec149" args="" -->CONTRIBUTE_SUB</em>&nbsp;</td><td>
Section is subtracted from the mapping. </td></tr>
</table>
</dl>

</div>
</div><p>
<hr><h2>Constructor &amp; Destructor Documentation</h2>
<a class="anchor" name="74f03e0603181535652621209de19aab"></a><!-- doxytag: member="Loader::Loader" ref="74f03e0603181535652621209de19aab" args="()" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">Loader::Loader           </td>
          <td>(</td>
          <td class="paramname">          </td>
          <td>&nbsp;)&nbsp;</td>
          <td width="100%"><code> [inline]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>

</div>
</div><p>
<a class="anchor" name="d005d4f811cbdd00f14befa928126b33"></a><!-- doxytag: member="Loader::~Loader" ref="d005d4f811cbdd00f14befa928126b33" args="()" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">virtual Loader::~Loader           </td>
          <td>(</td>
          <td class="paramname">          </td>
          <td>&nbsp;)&nbsp;</td>
          <td width="100%"><code> [inline, virtual]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>

</div>
</div><p>
<hr><h2>Member Function Documentation</h2>
<a class="anchor" name="80143c5479eaa7e470068851f131058d"></a><!-- doxytag: member="Loader::register_subclass" ref="80143c5479eaa7e470068851f131058d" args="(Loader *)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void Loader::register_subclass           </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classLoader.html">Loader</a> *&nbsp;</td>
          <td class="paramname">          </td>
          <td>&nbsp;)&nbsp;</td>
          <td width="100%"><code> [static]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Class method to register a loader. 
<p>
This allows users to define loaders at runtime and register them with ROSE. When loader functionality is needed by the parser, disassembler, etc., ROSE will try each loader in the reverse order they were registered until one indicates that it can handle the request. A loader indicates it can handle a request when its <a class="el" href="classLoader.html#a823d8c34f91ab8f0fbddf30a139da09">can_handle()</a> method returns true. The loader's built into ROSE are also registered automatically by ROSE. 
</div>
</div><p>
<a class="anchor" name="834cf99ed03ee2fef2afb3510e988e55"></a><!-- doxytag: member="Loader::find_loader" ref="834cf99ed03ee2fef2afb3510e988e55" args="(SgAsmGenericHeader *)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classLoader.html">Loader</a> * Loader::find_loader           </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classSgAsmGenericHeader.html">SgAsmGenericHeader</a> *&nbsp;</td>
          <td class="paramname">          </td>
          <td>&nbsp;)&nbsp;</td>
          <td width="100%"><code> [static]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Class method to find a registered loader supporting the specified file header. 
<p>
This method will call the <a class="el" href="classLoader.html#a823d8c34f91ab8f0fbddf30a139da09">can_handle()</a> method of each registered loader, in reverse order of their registration, until one returns true. 
</div>
</div><p>
<a class="anchor" name="a823d8c34f91ab8f0fbddf30a139da09"></a><!-- doxytag: member="Loader::can_handle" ref="a823d8c34f91ab8f0fbddf30a139da09" args="(SgAsmGenericHeader *)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">virtual bool Loader::can_handle           </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classSgAsmGenericHeader.html">SgAsmGenericHeader</a> *&nbsp;</td>
          <td class="paramname">          </td>
          <td>&nbsp;)&nbsp;</td>
          <td width="100%"><code> [inline, virtual]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Indicates whether a loader can handle a specific type of file. 
<p>
Returns true if the loader is able to handle the specified file header. For instance, the <a class="el" href="classLoaderELFObj.html">LoaderELFObj</a> loader would return true if the header is for an ELF object file. The generic <a class="el" href="classLoader.html">Loader</a> advertises that it can handle all types of file headers, so subclasses should definitely override this. 
<p>
Reimplemented in <a class="el" href="classLoaderELF.html#144b6bfdfee7aa08987e1bd7f256b682">LoaderELF</a>, <a class="el" href="classLoaderELFObj.html#e7929d0b8495d3c74a238ba4f9d6e928">LoaderELFObj</a>, and <a class="el" href="classLoaderPE.html#4548b6898ec422be45d44d78c741fd90">LoaderPE</a>.
</div>
</div><p>
<a class="anchor" name="c96fd6526c5b19301dd5890b234f2384"></a><!-- doxytag: member="Loader::initclass" ref="c96fd6526c5b19301dd5890b234f2384" args="()" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void Loader::initclass           </td>
          <td>(</td>
          <td class="paramname">          </td>
          <td>&nbsp;)&nbsp;</td>
          <td width="100%"><code> [static]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Class method to register ROSE built-in loaders. 
<p>
This is called automatically by <a class="el" href="classLoader.html#80143c5479eaa7e470068851f131058d">register_subclass()</a>. 
</div>
</div><p>
<a class="anchor" name="15e91c426af24473cd85a7028d8fe34a"></a><!-- doxytag: member="Loader::map_all_sections" ref="15e91c426af24473cd85a7028d8fe34a" args="(MemoryMap *map, SgAsmGenericFile *file, bool allow_overmap=true)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">virtual <a class="el" href="classMemoryMap.html">MemoryMap</a>* Loader::map_all_sections           </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classMemoryMap.html">MemoryMap</a> *&nbsp;</td>
          <td class="paramname"> <em>map</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classSgAsmGenericFile.html">SgAsmGenericFile</a> *&nbsp;</td>
          <td class="paramname"> <em>file</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">bool&nbsp;</td>
          <td class="paramname"> <em>allow_overmap</em> = <code>true</code></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td width="100%"><code> [inline, virtual]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Creates a map containing all mappable sections in the file. 
<p>
If <code>map</code> is non-null then it will be modified in place and returned, otherwise a new map is created. 
</div>
</div><p>
<a class="anchor" name="c945df394df8d75e130b705bea7df9bb"></a><!-- doxytag: member="Loader::map_all_sections" ref="c945df394df8d75e130b705bea7df9bb" args="(MemoryMap *map, SgAsmGenericHeader *fhdr, bool allow_overmap=true)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">virtual <a class="el" href="classMemoryMap.html">MemoryMap</a>* Loader::map_all_sections           </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classMemoryMap.html">MemoryMap</a> *&nbsp;</td>
          <td class="paramname"> <em>map</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classSgAsmGenericHeader.html">SgAsmGenericHeader</a> *&nbsp;</td>
          <td class="paramname"> <em>fhdr</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">bool&nbsp;</td>
          <td class="paramname"> <em>allow_overmap</em> = <code>true</code></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td width="100%"><code> [inline, virtual]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Creates a map containing all mappable sections in a file header. 
<p>
If <code>map</code> is non-null then it will be modified in place and returned, otherwise a new map is created. 
</div>
</div><p>
<a class="anchor" name="7ea9f62a6bc3df26a2ee39fdb3ed3240"></a><!-- doxytag: member="Loader::map_all_sections" ref="7ea9f62a6bc3df26a2ee39fdb3ed3240" args="(MemoryMap *, const SgAsmGenericSectionPtrList &amp;sections, bool allow_overmap=true)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classMemoryMap.html">MemoryMap</a> * Loader::map_all_sections           </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classMemoryMap.html">MemoryMap</a> *&nbsp;</td>
          <td class="paramname">, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="Cxx__Grammar_8h.html#69641d670cf625a600a51ee017219d0e">SgAsmGenericSectionPtrList</a> &amp;&nbsp;</td>
          <td class="paramname"> <em>sections</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">bool&nbsp;</td>
          <td class="paramname"> <em>allow_overmap</em> = <code>true</code></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td width="100%"><code> [virtual]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Creates a map containing the specified sections (if they are mapped). 
<p>
If <code>map</code> is non-null then it will be modified in place and returned, otherwise a new map is created. 
</div>
</div><p>
<a class="anchor" name="73f93ddcc81c149983d0512448518add"></a><!-- doxytag: member="Loader::map_code_sections" ref="73f93ddcc81c149983d0512448518add" args="(MemoryMap *map, SgAsmGenericFile *file, bool allow_overmap=true)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">virtual <a class="el" href="classMemoryMap.html">MemoryMap</a>* Loader::map_code_sections           </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classMemoryMap.html">MemoryMap</a> *&nbsp;</td>
          <td class="paramname"> <em>map</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classSgAsmGenericFile.html">SgAsmGenericFile</a> *&nbsp;</td>
          <td class="paramname"> <em>file</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">bool&nbsp;</td>
          <td class="paramname"> <em>allow_overmap</em> = <code>true</code></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td width="100%"><code> [inline, virtual]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Creates a map for all code-containing sections in the file. 
<p>
If <code>map</code> is non-null then it will be modified in place and returned, otherwise a new map is created. 
</div>
</div><p>
<a class="anchor" name="77a140386e7f6bbcd9f28877ac6d07ee"></a><!-- doxytag: member="Loader::map_code_sections" ref="77a140386e7f6bbcd9f28877ac6d07ee" args="(MemoryMap *map, SgAsmGenericHeader *fhdr, bool allow_overmap=true)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">virtual <a class="el" href="classMemoryMap.html">MemoryMap</a>* Loader::map_code_sections           </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classMemoryMap.html">MemoryMap</a> *&nbsp;</td>
          <td class="paramname"> <em>map</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classSgAsmGenericHeader.html">SgAsmGenericHeader</a> *&nbsp;</td>
          <td class="paramname"> <em>fhdr</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">bool&nbsp;</td>
          <td class="paramname"> <em>allow_overmap</em> = <code>true</code></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td width="100%"><code> [inline, virtual]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Creates a map for all code-containing sections reachable from the file header. 
<p>
If <code>map</code> is non-null then it will be modified in place and returned, otherwise a new map is created. 
</div>
</div><p>
<a class="anchor" name="8e652960415b44d41308e4b66566046d"></a><!-- doxytag: member="Loader::map_code_sections" ref="8e652960415b44d41308e4b66566046d" args="(MemoryMap *, const SgAsmGenericSectionPtrList &amp;sections, bool allow_overmap=true)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classMemoryMap.html">MemoryMap</a> * Loader::map_code_sections           </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classMemoryMap.html">MemoryMap</a> *&nbsp;</td>
          <td class="paramname">, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="Cxx__Grammar_8h.html#69641d670cf625a600a51ee017219d0e">SgAsmGenericSectionPtrList</a> &amp;&nbsp;</td>
          <td class="paramname"> <em>sections</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">bool&nbsp;</td>
          <td class="paramname"> <em>allow_overmap</em> = <code>true</code></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td width="100%"><code> [virtual]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Creates a map for all code-containing sections from the specified list. 
<p>
If <code>map</code> is non-null then it will be modified in place and returned, otherwise a new map is created. 
</div>
</div><p>
<a class="anchor" name="f02b353a6664cd40898e0410d6bb0bad"></a><!-- doxytag: member="Loader::map_executable_sections" ref="f02b353a6664cd40898e0410d6bb0bad" args="(MemoryMap *map, SgAsmGenericFile *file, bool allow_overmap=true)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">virtual <a class="el" href="classMemoryMap.html">MemoryMap</a>* Loader::map_executable_sections           </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classMemoryMap.html">MemoryMap</a> *&nbsp;</td>
          <td class="paramname"> <em>map</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classSgAsmGenericFile.html">SgAsmGenericFile</a> *&nbsp;</td>
          <td class="paramname"> <em>file</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">bool&nbsp;</td>
          <td class="paramname"> <em>allow_overmap</em> = <code>true</code></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td width="100%"><code> [inline, virtual]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Creates a map for all executable sections in the file. 
<p>
If <code>map</code> is non-null then it will be modified in place and returned, otherwise a new map is created. 
</div>
</div><p>
<a class="anchor" name="481c250b4c96091326fd59da596d667b"></a><!-- doxytag: member="Loader::map_executable_sections" ref="481c250b4c96091326fd59da596d667b" args="(MemoryMap *map, SgAsmGenericHeader *fhdr, bool allow_overmap=true)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">virtual <a class="el" href="classMemoryMap.html">MemoryMap</a>* Loader::map_executable_sections           </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classMemoryMap.html">MemoryMap</a> *&nbsp;</td>
          <td class="paramname"> <em>map</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classSgAsmGenericHeader.html">SgAsmGenericHeader</a> *&nbsp;</td>
          <td class="paramname"> <em>fhdr</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">bool&nbsp;</td>
          <td class="paramname"> <em>allow_overmap</em> = <code>true</code></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td width="100%"><code> [inline, virtual]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Creates a map for all executable sections reachable from the file header. 
<p>
If <code>map</code> is non-null then it will be modified in place and returned, otherwise a new map is created. 
</div>
</div><p>
<a class="anchor" name="8e445fbbcb20e4c058bfbaee647e5cd1"></a><!-- doxytag: member="Loader::map_executable_sections" ref="8e445fbbcb20e4c058bfbaee647e5cd1" args="(MemoryMap *, const SgAsmGenericSectionPtrList &amp;sections, bool allow_overmap=true)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classMemoryMap.html">MemoryMap</a> * Loader::map_executable_sections           </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classMemoryMap.html">MemoryMap</a> *&nbsp;</td>
          <td class="paramname">, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="Cxx__Grammar_8h.html#69641d670cf625a600a51ee017219d0e">SgAsmGenericSectionPtrList</a> &amp;&nbsp;</td>
          <td class="paramname"> <em>sections</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">bool&nbsp;</td>
          <td class="paramname"> <em>allow_overmap</em> = <code>true</code></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td width="100%"><code> [virtual]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Creates a map for all executable sections from the specified list. 
<p>
If <code>map</code> is non-null then it will be modified in place and returned, otherwise a new map is created. 
</div>
</div><p>
<a class="anchor" name="681132f07ea47cf919d13f54e3e1e309"></a><!-- doxytag: member="Loader::map_writable_sections" ref="681132f07ea47cf919d13f54e3e1e309" args="(MemoryMap *map, SgAsmGenericFile *file, bool allow_overmap=true)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">virtual <a class="el" href="classMemoryMap.html">MemoryMap</a>* Loader::map_writable_sections           </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classMemoryMap.html">MemoryMap</a> *&nbsp;</td>
          <td class="paramname"> <em>map</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classSgAsmGenericFile.html">SgAsmGenericFile</a> *&nbsp;</td>
          <td class="paramname"> <em>file</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">bool&nbsp;</td>
          <td class="paramname"> <em>allow_overmap</em> = <code>true</code></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td width="100%"><code> [inline, virtual]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Creates a map for all writable sections in the file. 
<p>
If <code>map</code> is non-null then it will be modified in place and returned, otherwise a new map is created. 
</div>
</div><p>
<a class="anchor" name="917936ca19d17c7453db87a784069c2b"></a><!-- doxytag: member="Loader::map_writable_sections" ref="917936ca19d17c7453db87a784069c2b" args="(MemoryMap *map, SgAsmGenericHeader *fhdr, bool allow_overmap=true)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">virtual <a class="el" href="classMemoryMap.html">MemoryMap</a>* Loader::map_writable_sections           </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classMemoryMap.html">MemoryMap</a> *&nbsp;</td>
          <td class="paramname"> <em>map</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classSgAsmGenericHeader.html">SgAsmGenericHeader</a> *&nbsp;</td>
          <td class="paramname"> <em>fhdr</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">bool&nbsp;</td>
          <td class="paramname"> <em>allow_overmap</em> = <code>true</code></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td width="100%"><code> [inline, virtual]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Creates a map for all writable sections reachable from the file header. 
<p>
If <code>map</code> is non-null then it will be modified in place and returned, otherwise a new map is created. 
</div>
</div><p>
<a class="anchor" name="b724b99fd5a29701f10839ec92985c0d"></a><!-- doxytag: member="Loader::map_writable_sections" ref="b724b99fd5a29701f10839ec92985c0d" args="(MemoryMap *, const SgAsmGenericSectionPtrList &amp;sections, bool allow_overmap=true)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classMemoryMap.html">MemoryMap</a> * Loader::map_writable_sections           </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classMemoryMap.html">MemoryMap</a> *&nbsp;</td>
          <td class="paramname">, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="Cxx__Grammar_8h.html#69641d670cf625a600a51ee017219d0e">SgAsmGenericSectionPtrList</a> &amp;&nbsp;</td>
          <td class="paramname"> <em>sections</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">bool&nbsp;</td>
          <td class="paramname"> <em>allow_overmap</em> = <code>true</code></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td width="100%"><code> [virtual]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Creates a map for all writable sections from the specified list. 
<p>
If <code>map</code> is non-null then it will be modified in place and returned, otherwise a new map is created. 
</div>
</div><p>
<a class="anchor" name="a3e285b9e9351122e80b444502b564f8"></a><!-- doxytag: member="Loader::align_values" ref="a3e285b9e9351122e80b444502b564f8" args="(SgAsmGenericSection *, Contribution, rose_addr_t *va, rose_addr_t *mem_size, rose_addr_t *offset, rose_addr_t *file_size, const MemoryMap *current)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">rose_addr_t Loader::align_values           </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classSgAsmGenericSection.html">SgAsmGenericSection</a> *&nbsp;</td>
          <td class="paramname">, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classLoader.html#820ed89e67b157f4447f609de2066145">Contribution</a>&nbsp;</td>
          <td class="paramname">, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">rose_addr_t *&nbsp;</td>
          <td class="paramname"> <em>va</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">rose_addr_t *&nbsp;</td>
          <td class="paramname"> <em>mem_size</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">rose_addr_t *&nbsp;</td>
          <td class="paramname"> <em>offset</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">rose_addr_t *&nbsp;</td>
          <td class="paramname"> <em>file_size</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classMemoryMap.html">MemoryMap</a> *&nbsp;</td>
          <td class="paramname"> <em>current</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td width="100%"><code> [virtual]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Computes memory mapping addresses for a section. 
<p>
Operating systems generally have some alignment constraints for how a file is mapped to virtual memory, and these correspond to the page size. For example, see the man page for Unix mmap(). There are three parts to the information returned:<p>
First, we need to know the entire range of file offsets that are mapped. On Unix systems only entire pages of a file can be mapped. If the section begins with a partial page then we align the starting offset downward. Likewise if the section ends with a partial page we extend the range. Both of these adjustments can increase the number of file bytes that are mapped. The starting offset and file size are returned through the <code>offset</code> and <code>file_size</code> arguments.<p>
Second, we need to know the entire range of virtual addresses that are affected. Again, at least on Unix systems, only entire pages of memory can be mapped. We therefore make the same adjustments to memory as we did to the file, aligning the starting virtual address downward and the ending address upward. Both of these adjustments can affect the size of the virtual address region affected. The starting address and memory size are returned through the <code>va</code> and <code>mem_size</code> arguments. When the returned memory size is larger than the returned file size then the mapping will include an anonymous region (memory that is initialized to zero rather than file contents).<p>
Finally, we need to indicate where the first byte of the section is located in memory. If we needed to make adjustments to the first affected virtual address then the start-of-section will not be the same as the first affected virtual address. The start-of-section virtual address is the return value of this function.<p>
Additionally, this function can veto a section mapping by returning a zero memory size. This can happen when the <a class="el" href="classLoader_1_1Selector.html">Selector</a> selects a section indiscriminantly (as with <a class="el" href="classLoader.html#15e91c426af24473cd85a7028d8fe34a">map_all_sections()</a>) but there is not enough information to determine where the section should be mapped. On the other hand, it can also define a mapping for a section that doesn't have any mapping attributes (for instance, the ELF object file loader, <a class="el" href="classLoaderELFObj.html">LoaderELFObj</a>, maps function text sections that are marked as "not mapped" in the ELF container by choosing free regions of virtual memory using the <code>current</code> argument that contains the most up-to-date mapping). 
</div>
</div><p>
<a class="anchor" name="376bcc8d6d63f42e6af4333d42c431f3"></a><!-- doxytag: member="Loader::order_sections" ref="376bcc8d6d63f42e6af4333d42c431f3" args="(const SgAsmGenericSectionPtrList &amp;)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="Cxx__Grammar_8h.html#69641d670cf625a600a51ee017219d0e">SgAsmGenericSectionPtrList</a> Loader::order_sections           </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="Cxx__Grammar_8h.html#69641d670cf625a600a51ee017219d0e">SgAsmGenericSectionPtrList</a> &amp;&nbsp;</td>
          <td class="paramname">          </td>
          <td>&nbsp;)&nbsp;</td>
          <td width="100%"><code> [virtual]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Sort sections for mapping. 
<p>
Given a list of sections, sort the sections according to the order they should contribute to the mapping. For instance, ELF Segments should contribute to the mapping before ELF Sections.<p>
This method can also be used as a first-line for excluding sections that meet certain criteria. It is called by <a class="el" href="classLoader.html#23401962c4f727ea6abe50066010d54f">create_map()</a> before sections are passed through the <a class="el" href="classLoader_1_1Selector.html">Selector</a> object. The default implementation excludes any section that was synthesized by the binary parser, keeping only those that were created due to the parser encountering a description of the section in some kind of table. 
<p>
Reimplemented in <a class="el" href="classLoaderELF.html#dcf704966e04a6ba3e7a41766926591e">LoaderELF</a>, and <a class="el" href="classLoaderPE.html#6cfba4cd8eafcf7dfe09f027e90486f3">LoaderPE</a>.
</div>
</div><p>
<a class="anchor" name="23401962c4f727ea6abe50066010d54f"></a><!-- doxytag: member="Loader::create_map" ref="23401962c4f727ea6abe50066010d54f" args="(MemoryMap *map, const SgAsmGenericSectionPtrList &amp;, Selector *, bool allow_overmap=true)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classMemoryMap.html">MemoryMap</a> * Loader::create_map           </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classMemoryMap.html">MemoryMap</a> *&nbsp;</td>
          <td class="paramname"> <em>map</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="Cxx__Grammar_8h.html#69641d670cf625a600a51ee017219d0e">SgAsmGenericSectionPtrList</a> &amp;&nbsp;</td>
          <td class="paramname">, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classLoader_1_1Selector.html">Selector</a> *&nbsp;</td>
          <td class="paramname">, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">bool&nbsp;</td>
          <td class="paramname"> <em>allow_overmap</em> = <code>true</code></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td width="100%"><code> [virtual]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Creates a memory map containing sections that satisfy some constraint. 
<p>
The sections are mapped in the order specified by <a class="el" href="classLoader.html#376bcc8d6d63f42e6af4333d42c431f3">order_sections()</a>, contribute to the final mapping according to the specified <a class="el" href="classLoader_1_1Selector.html">Selector</a>, and are aligned according to the rules in <a class="el" href="classLoader.html#a3e285b9e9351122e80b444502b564f8">align_values()</a>. If <code>allow_overmap</code> is set (the default) then any section that contributes to the map in an additive manner will first have its virtual address space removed from the map in order to prevent a <a class="el" href="structMemoryMap_1_1Inconsistent.html">MemoryMap::Inconsistent</a> exception; otherwise a <a class="el" href="structMemoryMap_1_1Inconsistent.html">MemoryMap::Inconsistent</a> exception will be thrown when a single virtual address would map to two different source bytes, such as two different offsets in a file.<p>
If a memory map is supplied, then it will be modified in place and returned; otherwise a new map is allocated. 
</div>
</div><p>
<a class="anchor" name="5c38dd75ed82e43e9a8fe1e8073d710e"></a><!-- doxytag: member="Loader::set_debug" ref="5c38dd75ed82e43e9a8fe1e8073d710e" args="(FILE *f)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void Loader::set_debug           </td>
          <td>(</td>
          <td class="paramtype">FILE *&nbsp;</td>
          <td class="paramname"> <em>f</em>          </td>
          <td>&nbsp;)&nbsp;</td>
          <td width="100%"><code> [inline]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Turns debugging output on or off. 
<p>
If <code>f</code> is null then debugging is turned off, otherwise debugging output is sent to the specified file. The default can be changed at the top of the <a class="el" href="Loader_8C.html">Loader.C</a> file. 
</div>
</div><p>
<a class="anchor" name="68233cb023b440260ee22fd1d24aa9c8"></a><!-- doxytag: member="Loader::get_debug" ref="68233cb023b440260ee22fd1d24aa9c8" args="() const " -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">FILE* Loader::get_debug           </td>
          <td>(</td>
          <td class="paramname">          </td>
          <td>&nbsp;)&nbsp;</td>
          <td width="100%"> const<code> [inline]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Returns debugging status. 
<p>
If debugging is off a null pointer is returned, otherwise the file to which debugging information is being emitted is returned. 
</div>
</div><p>
<a class="anchor" name="975347158ba12cf9c1f836a3687db03b"></a><!-- doxytag: member="Loader::ctor" ref="975347158ba12cf9c1f836a3687db03b" args="()" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void Loader::ctor           </td>
          <td>(</td>
          <td class="paramname">          </td>
          <td>&nbsp;)&nbsp;</td>
          <td width="100%"><code> [private]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>

</div>
</div><p>
<hr><h2>Member Data Documentation</h2>
<a class="anchor" name="c5c3a3d246740076039ca7afd6a047e9"></a><!-- doxytag: member="Loader::p_registered" ref="c5c3a3d246740076039ca7afd6a047e9" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">std::vector&lt; <a class="el" href="classLoader.html">Loader</a> * &gt; <a class="el" href="classLoader.html#c5c3a3d246740076039ca7afd6a047e9">Loader::p_registered</a><code> [static, private]</code>          </td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>

</div>
</div><p>
<a class="anchor" name="707e243b85129f6195d18e6a106d11e2"></a><!-- doxytag: member="Loader::p_debug" ref="707e243b85129f6195d18e6a106d11e2" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">FILE* <a class="el" href="classLoader.html#707e243b85129f6195d18e6a106d11e2">Loader::p_debug</a><code> [private]</code>          </td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>

</div>
</div><p>
<hr>The documentation for this class was generated from the following files:<ul>
<li><a class="el" href="Loader_8h-source.html">Loader.h</a><li><a class="el" href="Loader_8C.html">Loader.C</a></ul>
<hr size="1"><address style="align: right;"><small>Generated on Mon Aug 30 21:33:56 2010 for ROSE by&nbsp;
<a href="http://www.doxygen.org/index.html">
<img src="doxygen.png" alt="doxygen" align="middle" border="0"></a> 1.4.7 </small></address>
</body>
</html>
