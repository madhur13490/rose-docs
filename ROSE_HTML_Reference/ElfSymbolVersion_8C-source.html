<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head><meta http-equiv="Content-Type" content="text/html;charset=iso-8859-1">
<title>ROSE: ElfSymbolVersion.C Source File</title>
<link href="doxygen.css" rel="stylesheet" type="text/css">
<link href="tabs.css" rel="stylesheet" type="text/css">
</head><body>
<!-- Generated by Doxygen 1.4.7 -->
<div class="tabs">
  <ul>
    <li><a href="main.html"><span>Main&nbsp;Page</span></a></li>
    <li><a href="modules.html"><span>Modules</span></a></li>
    <li><a href="namespaces.html"><span>Namespaces</span></a></li>
    <li><a href="annotated.html"><span>Classes</span></a></li>
    <li id="current"><a href="files.html"><span>Files</span></a></li>
    <li><a href="pages.html"><span>Related&nbsp;Pages</span></a></li>
    <li><a href="examples.html"><span>Examples</span></a></li>
    <li>
      <form action="search.php" method="get">
        <table cellspacing="0" cellpadding="0" border="0">
          <tr>
            <td><label>&nbsp;<u>S</u>earch&nbsp;for&nbsp;</label></td>
            <td><input type="text" name="query" value="" size="20" accesskey="s"/></td>
          </tr>
        </table>
      </form>
    </li>
  </ul></div>
<div class="tabs">
  <ul>
    <li><a href="files.html"><span>File&nbsp;List</span></a></li>
    <li><a href="globals.html"><span>File&nbsp;Members</span></a></li>
  </ul></div>
<h1>ElfSymbolVersion.C</h1><a href="ElfSymbolVersion_8C.html">Go to the documentation of this file.</a><div class="fragment"><pre class="fragment"><a name="l00001"></a>00001 <span class="comment">/* ELF Symbol Versioning</span>
<a name="l00002"></a>00002 <span class="comment"> *</span>
<a name="l00003"></a>00003 <span class="comment"> * Symver Symbol Versioning (gnu extension) defines .gnu.version, .gnu.version_d, .gnu.version_r</span>
<a name="l00004"></a>00004 <span class="comment"> * For more information see</span>
<a name="l00005"></a>00005 <span class="comment"> * Sun: http://docs.sun.com/app/docs/doc/819-0690/chapter6-54676?a=view</span>
<a name="l00006"></a>00006 <span class="comment"> * LSB: http://refspecs.freestandards.org/LSB_3.1.0/LSB-Core-generic/LSB-Core-generic/symversion.html</span>
<a name="l00007"></a>00007 <span class="comment"> * Redhat: http://people.redhat.com/drepper/symbol-versioning</span>
<a name="l00008"></a>00008 <span class="comment"> *</span>
<a name="l00009"></a>00009 <span class="comment"> * Related SageIII classes:</span>
<a name="l00010"></a>00010 <span class="comment"> *    SgAsmElfSymverSection -- GNU Symvol Version Table; The ".gnu.version" section, subclass of SgAsmElfSection. This</span>
<a name="l00011"></a>00011 <span class="comment"> *                             table is parallel to the list of symbols in the ".dynsym" section.</span>
<a name="l00012"></a>00012 <span class="comment"> *    SgAsmElfSymverEntry   -- A single entry in an SgAsmElfSymverSection, usually an index into one of the other</span>
<a name="l00013"></a>00013 <span class="comment"> *                             version tables, but some special values are also defined.</span>
<a name="l00014"></a>00014 <span class="comment"> */</span>
<a name="l00015"></a>00015 
<a name="l00016"></a>00016 <span class="preprocessor">#include "<a class="code" href="sage3basic_8h.html">sage3basic.h</a>"</span>
<a name="l00017"></a>00017 
<a name="l00018"></a>00018 <span class="comment">/*========================================================================================================================</span>
<a name="l00019"></a>00019 <span class="comment"> * Methods for classes related to the GNU Symbol Version Table</span>
<a name="l00020"></a>00020 <span class="comment"> *</span>
<a name="l00021"></a>00021 <span class="comment"> * SgAsmElfSymverSection, contains a list of</span>
<a name="l00022"></a>00022 <span class="comment"> * SgAsmElfSymverEntry</span>
<a name="l00023"></a>00023 <span class="comment"> *======================================================================================================================== */</span>
<a name="l00024"></a>00024 
<a name="l00026"></a>00026 <span class="keywordtype">void</span>
<a name="l00027"></a><a class="code" href="classSgAsmElfSymverEntry.html#cd03a50ec477f5abdf9362caf782ee37">00027</a> <a class="code" href="classSgAsmElfSymverEntry.html#cd03a50ec477f5abdf9362caf782ee37">SgAsmElfSymverEntry::ctor</a>(<a class="code" href="classSgAsmElfSymverSection.html">SgAsmElfSymverSection</a> *symver)
<a name="l00028"></a>00028 {
<a name="l00029"></a>00029     ROSE_ASSERT(NULL != symver);
<a name="l00030"></a>00030     
<a name="l00031"></a>00031     ROSE_ASSERT(symver-&gt;<a class="code" href="classSgAsmElfSymverSection.html#76bff88390ca5b600ec536b7726329f6">get_entries</a>()!=NULL);
<a name="l00032"></a>00032     symver-&gt;<a class="code" href="classSgAsmElfSymverSection.html#76bff88390ca5b600ec536b7726329f6">get_entries</a>()-&gt;<a class="code" href="classSgAsmElfSymverEntryList.html#b2187bab8c2f3a613feeb8ab4373dc91">get_entries</a>().push_back(<span class="keyword">this</span>);
<a name="l00033"></a>00033     ROSE_ASSERT(symver-&gt;<a class="code" href="classSgAsmElfSymverSection.html#76bff88390ca5b600ec536b7726329f6">get_entries</a>()-&gt;<a class="code" href="classSgAsmElfSymverEntryList.html#b2187bab8c2f3a613feeb8ab4373dc91">get_entries</a>().size()&gt;0);
<a name="l00034"></a>00034     <a class="code" href="classSgNode.html#83017efa378d75b031330739c963749d">set_parent</a>(symver-&gt;<a class="code" href="classSgAsmElfSymverSection.html#76bff88390ca5b600ec536b7726329f6">get_entries</a>());
<a name="l00035"></a>00035 
<a name="l00036"></a>00036     <a class="code" href="classSgAsmElfSymverEntry.html#8e7442e5b813031dad35f9b97387fd14">set_value</a>(0);
<a name="l00037"></a>00037 }
<a name="l00038"></a>00038 
<a name="l00040"></a>00040 <span class="keywordtype">void</span>
<a name="l00041"></a><a class="code" href="classSgAsmElfSymverEntry.html#47580a33b3019c9faa4ed94665654223">00041</a> <a class="code" href="classSgAsmElfSymverEntry.html#47580a33b3019c9faa4ed94665654223">SgAsmElfSymverEntry::dump</a>(FILE *f, <span class="keyword">const</span> <span class="keywordtype">char</span> *<a class="code" href="SgUnaryOp_8docs.html#c6cf1576467b95ef29f025f8e47eea437afa939f8bd773f5f7e326990b07580c">prefix</a>, ssize_t idx)<span class="keyword"> const</span>
<a name="l00042"></a>00042 <span class="keyword"></span>{
<a name="l00043"></a>00043     <span class="keywordtype">char</span> p[4096];
<a name="l00044"></a>00044     <span class="keywordflow">if</span> (idx&gt;=0) {
<a name="l00045"></a>00045         sprintf(p, <span class="stringliteral">"%sElfSymverEntry[%zd]."</span>, prefix, idx);
<a name="l00046"></a>00046     } <span class="keywordflow">else</span> {
<a name="l00047"></a>00047         sprintf(p, <span class="stringliteral">"%sElfSymver."</span>, prefix);
<a name="l00048"></a>00048     }
<a name="l00049"></a>00049     <span class="keyword">const</span> <span class="keywordtype">int</span> w = std::max(1, <a class="code" href="Cxx__Grammar_8h.html#b09cd568db5adadb46869d1ae0f6db69">DUMP_FIELD_WIDTH</a>-(<span class="keywordtype">int</span>)strlen(p));
<a name="l00050"></a>00050   
<a name="l00051"></a>00051     fprintf(f, <span class="stringliteral">"%s%-*s = %zu"</span>, p, w, <span class="stringliteral">""</span>, <a class="code" href="classSgAsmElfSymverEntry.html#c21f927aede2385e5ddcdea17c07240c">p_value</a>);
<a name="l00052"></a>00052     <span class="keywordflow">switch</span> (<a class="code" href="classSgAsmElfSymverEntry.html#c21f927aede2385e5ddcdea17c07240c">p_value</a>) {
<a name="l00053"></a>00053         <span class="keywordflow">case</span> 0: fprintf(f, <span class="stringliteral">" (local)\n"</span>); <span class="keywordflow">break</span>;
<a name="l00054"></a>00054         <span class="keywordflow">case</span> 1: fprintf(f, <span class="stringliteral">" (global)\n"</span>); <span class="keywordflow">break</span>;
<a name="l00055"></a>00055         <span class="keywordflow">default</span>: fprintf(f, <span class="stringliteral">"\n"</span>); <span class="keywordflow">break</span>;
<a name="l00056"></a>00056     }
<a name="l00057"></a>00057 }
<a name="l00058"></a>00058 
<a name="l00060"></a>00060 <span class="keywordtype">void</span>
<a name="l00061"></a><a class="code" href="classSgAsmElfSymverSection.html#45164d0fcefe3c952f7520375176e792">00061</a> <a class="code" href="classSgAsmElfSymverSection.html#45164d0fcefe3c952f7520375176e792">SgAsmElfSymverSection::ctor</a>()
<a name="l00062"></a>00062 {
<a name="l00063"></a>00063     <a class="code" href="classSgAsmElfSymverSection.html#3259ba955f946994e0f6d1f29eabacdc">p_entries</a> = <span class="keyword">new</span> <a class="code" href="classSgAsmElfSymverEntryList.html">SgAsmElfSymverEntryList</a>;
<a name="l00064"></a>00064     <a class="code" href="classSgAsmElfSymverSection.html#3259ba955f946994e0f6d1f29eabacdc">p_entries</a>-&gt;<a class="code" href="classSgNode.html#83017efa378d75b031330739c963749d">set_parent</a>(<span class="keyword">this</span>);
<a name="l00065"></a>00065 }
<a name="l00066"></a>00066 
<a name="l00068"></a>00068 <a class="code" href="classSgAsmElfSymverSection.html">SgAsmElfSymverSection</a> *
<a name="l00069"></a><a class="code" href="classSgAsmElfSymverSection.html#be6324dfc034eaaf2d3a33570607a70a">00069</a> <a class="code" href="classSgAsmElfSymverSection.html#be6324dfc034eaaf2d3a33570607a70a">SgAsmElfSymverSection::parse</a>()
<a name="l00070"></a>00070 {
<a name="l00071"></a>00071     <a class="code" href="classSgAsmGenericSection.html#06e6f2a4c28be5858d6a0b92573908d7">SgAsmElfSection::parse</a>();
<a name="l00072"></a>00072   
<a name="l00073"></a>00073     <a class="code" href="classSgAsmElfFileHeader.html">SgAsmElfFileHeader</a> *fhdr = <a class="code" href="classSgAsmElfSection.html#a430cf4e1e6376e12f3b5dc8363099c4">get_elf_header</a>();
<a name="l00074"></a>00074     ROSE_ASSERT(fhdr!=NULL);
<a name="l00075"></a>00075     <a class="code" href="classSgAsmElfSectionTableEntry.html">SgAsmElfSectionTableEntry</a> *shdr = <a class="code" href="classSgAsmElfSection.html#9ef7cc77be330cde6c32ef598e312971">get_section_entry</a>();
<a name="l00076"></a>00076     ROSE_ASSERT(shdr!=NULL);
<a name="l00077"></a>00077   
<a name="l00078"></a>00078     size_t entry_size, struct_size, extra_size, nentries;
<a name="l00079"></a>00079     <a class="code" href="classSgAsmElfSymverSection.html#46023426b2ebef0558f9b9346563f96b">calculate_sizes</a>(&amp;entry_size, &amp;struct_size, &amp;extra_size, &amp;nentries);
<a name="l00080"></a>00080     ROSE_ASSERT(entry_size==shdr-&gt;<a class="code" href="classSgAsmElfSectionTableEntry.html#2336763fad7e464207a6d19dec4e45d7">get_sh_entsize</a>());
<a name="l00081"></a>00081   
<a name="l00082"></a>00082     <span class="comment">/* Parse each entry */</span>
<a name="l00083"></a>00083     <span class="keywordflow">for</span> (size_t i=0; i&lt;nentries; ++i) {
<a name="l00084"></a>00084         <a class="code" href="classSgAsmElfSymverEntry.html">SgAsmElfSymverEntry</a> *entry=0;
<a name="l00085"></a>00085         entry = <span class="keyword">new</span> <a class="code" href="classSgAsmElfSymverEntry.html">SgAsmElfSymverEntry</a>(<span class="keyword">this</span>); <span class="comment">/*adds symver to this symver table*/</span>
<a name="l00086"></a>00086         uint16_t value;
<a name="l00087"></a>00087         <a class="code" href="classSgAsmGenericSection.html#e7516833466da3f886fafd0b1bc1f803">read_content_local</a>(i*entry_size, &amp;value, struct_size);
<a name="l00088"></a>00088         entry-&gt;set_value(<a class="code" href="classSgAsmExecutableFileFormat.html#52cc73212f6067429beb52b06b9ecc75">disk_to_host</a>(fhdr-&gt;<a class="code" href="classSgAsmGenericHeader.html#3269e8ea6c30182607e9d4ee79fc05a8">get_sex</a>(), value));
<a name="l00089"></a>00089     }
<a name="l00090"></a>00090     <span class="keywordflow">return</span> <span class="keyword">this</span>;
<a name="l00091"></a>00091 }
<a name="l00092"></a>00092 
<a name="l00094"></a>00094 <a class="code" href="rosedefs_8h.html#03b4aab6bc70ede394422915678b18df">rose_addr_t</a>
<a name="l00095"></a><a class="code" href="classSgAsmElfSymverSection.html#46023426b2ebef0558f9b9346563f96b">00095</a> <a class="code" href="classSgAsmElfSymverSection.html#46023426b2ebef0558f9b9346563f96b">SgAsmElfSymverSection::calculate_sizes</a>(size_t *entsize, size_t *required, size_t *optional, size_t *entcount)<span class="keyword"> const</span>
<a name="l00096"></a>00096 <span class="keyword"></span>{
<a name="l00097"></a>00097     std::vector&lt;size_t&gt; extra_sizes;
<a name="l00098"></a>00098     <span class="keywordflow">return</span> <a class="code" href="classSgAsmElfSymverSection.html#46023426b2ebef0558f9b9346563f96b">calculate_sizes</a>(<span class="keyword">sizeof</span>(uint16_t),
<a name="l00099"></a>00099                            <span class="keyword">sizeof</span>(uint16_t),
<a name="l00100"></a>00100                            extra_sizes,
<a name="l00101"></a>00101                            entsize, required, optional, entcount);
<a name="l00102"></a>00102 }
<a name="l00103"></a>00103 
<a name="l00105"></a>00105 <span class="keywordtype">void</span>
<a name="l00106"></a><a class="code" href="classSgAsmElfSymverSection.html#1fd27c1bdbf68e31fe5eff7647a52a4c">00106</a> <a class="code" href="classSgAsmElfSymverSection.html#1fd27c1bdbf68e31fe5eff7647a52a4c">SgAsmElfSymverSection::unparse</a>(std::ostream &amp;f)<span class="keyword"> const</span>
<a name="l00107"></a>00107 <span class="keyword"></span>{
<a name="l00108"></a>00108     <a class="code" href="classSgAsmElfFileHeader.html">SgAsmElfFileHeader</a> *fhdr = <a class="code" href="classSgAsmElfSection.html#a430cf4e1e6376e12f3b5dc8363099c4">get_elf_header</a>();
<a name="l00109"></a>00109     ROSE_ASSERT(fhdr);
<a name="l00110"></a>00110     <a class="code" href="classSgAsmExecutableFileFormat.html#9f34e9e7666815ddeee9be5df5573a80">ByteOrder</a> sex = fhdr-&gt;<a class="code" href="classSgAsmGenericHeader.html#3269e8ea6c30182607e9d4ee79fc05a8">get_sex</a>();
<a name="l00111"></a>00111   
<a name="l00112"></a>00112     size_t entry_size, struct_size, extra_size, nentries;
<a name="l00113"></a>00113     <a class="code" href="classSgAsmElfSymverSection.html#46023426b2ebef0558f9b9346563f96b">calculate_sizes</a>(&amp;entry_size, &amp;struct_size, &amp;extra_size, &amp;nentries);
<a name="l00114"></a>00114 
<a name="l00115"></a>00115     <span class="comment">/* Adjust the entry size stored in the ELF Section Table */</span>
<a name="l00116"></a>00116     <a class="code" href="classSgAsmElfSection.html#9ef7cc77be330cde6c32ef598e312971">get_section_entry</a>()-&gt;<a class="code" href="classSgAsmElfSectionTableEntry.html#d4f8b40b80fd40a7ce026db601e85911">set_sh_entsize</a>(entry_size);
<a name="l00117"></a>00117   
<a name="l00118"></a>00118     <span class="comment">/* Write each entry's required part followed by the optional part */</span>
<a name="l00119"></a>00119     <span class="keywordflow">for</span> (size_t i=0; i&lt;nentries; i++) {
<a name="l00120"></a>00120         uint16_t val;
<a name="l00121"></a>00121     
<a name="l00122"></a>00122         <a class="code" href="classSgAsmElfSymverEntry.html">SgAsmElfSymverEntry</a> *entry = <a class="code" href="classSgAsmElfSymverSection.html#3259ba955f946994e0f6d1f29eabacdc">p_entries</a>-&gt;<a class="code" href="classSgAsmElfSymverEntryList.html#b2187bab8c2f3a613feeb8ab4373dc91">get_entries</a>()[i];
<a name="l00123"></a>00123         <a class="code" href="classSgAsmExecutableFileFormat.html#19727362aeeba713bc0cc666de3c3f13">host_to_disk</a>(sex,entry-&gt;<a class="code" href="classSgAsmElfSymverEntry.html#0048807d185ddaa5f7fc90fc3a167c8b">get_value</a>(),&amp;val);
<a name="l00124"></a>00124 
<a name="l00125"></a>00125         <a class="code" href="rosedefs_8h.html#03b4aab6bc70ede394422915678b18df">rose_addr_t</a> spos = i * entry_size;
<a name="l00126"></a>00126         spos = <a class="code" href="classSgAsmGenericSection.html#8e0601bfbe531ff8973c2458543aaad6">write</a>(f, spos, struct_size, &amp;val);
<a name="l00127"></a>00127     }
<a name="l00128"></a>00128     <a class="code" href="classSgAsmGenericSection.html#5093c3cf64be87688030517c67370dae">unparse_holes</a>(f);
<a name="l00129"></a>00129 }
<a name="l00130"></a>00130 
<a name="l00132"></a>00132 <span class="keywordtype">void</span>
<a name="l00133"></a><a class="code" href="classSgAsmElfSymverSection.html#e2f0f49af10a1ad89ed3e11c5e092256">00133</a> <a class="code" href="classSgAsmElfSymverSection.html#e2f0f49af10a1ad89ed3e11c5e092256">SgAsmElfSymverSection::dump</a>(FILE *f, <span class="keyword">const</span> <span class="keywordtype">char</span> *<a class="code" href="SgUnaryOp_8docs.html#c6cf1576467b95ef29f025f8e47eea437afa939f8bd773f5f7e326990b07580c">prefix</a>, ssize_t idx)<span class="keyword"> const</span>
<a name="l00134"></a>00134 <span class="keyword"></span>{
<a name="l00135"></a>00135     <span class="keywordtype">char</span> p[4096];
<a name="l00136"></a>00136     <span class="keywordflow">if</span> (idx&gt;=0) {
<a name="l00137"></a>00137         sprintf(p, <span class="stringliteral">"%sElfSymverSection[%zd]."</span>, prefix, idx);
<a name="l00138"></a>00138     } <span class="keywordflow">else</span> {
<a name="l00139"></a>00139         sprintf(p, <span class="stringliteral">"%sElfSymverSection."</span>, prefix);
<a name="l00140"></a>00140     }
<a name="l00141"></a>00141     <span class="keyword">const</span> <span class="keywordtype">int</span> w = std::max(1, <a class="code" href="Cxx__Grammar_8h.html#b09cd568db5adadb46869d1ae0f6db69">DUMP_FIELD_WIDTH</a>-(<span class="keywordtype">int</span>)strlen(p));
<a name="l00142"></a>00142   
<a name="l00143"></a>00143     <a class="code" href="classSgAsmElfSection.html#4fd8ef83c67a6b432974fab51f4122b7">SgAsmElfSection::dump</a>(f, p, -1);
<a name="l00144"></a>00144     fprintf(f, <span class="stringliteral">"%s%-*s = %zu entries\n"</span>, p, w, <span class="stringliteral">"entries.size"</span>, <a class="code" href="classSgAsmElfSymverSection.html#3259ba955f946994e0f6d1f29eabacdc">p_entries</a>-&gt;<a class="code" href="classSgAsmElfSymverEntryList.html#b2187bab8c2f3a613feeb8ab4373dc91">get_entries</a>().size());
<a name="l00145"></a>00145     <span class="keywordflow">for</span> (size_t i = 0; i &lt; <a class="code" href="classSgAsmElfSymverSection.html#3259ba955f946994e0f6d1f29eabacdc">p_entries</a>-&gt;<a class="code" href="classSgAsmElfSymverEntryList.html#b2187bab8c2f3a613feeb8ab4373dc91">get_entries</a>().size(); i++) {
<a name="l00146"></a>00146         <a class="code" href="classSgAsmElfSymverSection.html#3259ba955f946994e0f6d1f29eabacdc">p_entries</a>-&gt;<a class="code" href="classSgAsmElfSymverEntryList.html#b2187bab8c2f3a613feeb8ab4373dc91">get_entries</a>()[i]-&gt;dump(f, p, i);
<a name="l00147"></a>00147     }
<a name="l00148"></a>00148   
<a name="l00149"></a>00149     <span class="keywordflow">if</span> (<a class="code" href="classSgAsmElfSymverSection.html#b234b5a4a136fb1ee626539d7f5b3b3c">variantT</a>() == <a class="code" href="Cxx__Grammar_8h.html#adcb00b11de1167a498bced81d3e34649aa39fce89e5f78aaab82d413126f285">V_SgAsmElfSymverSection</a>) <span class="comment">/*unless a base class*/</span>
<a name="l00150"></a>00150         <a class="code" href="classSgAsmExecutableFileFormat.html#548279193ba7eec2ae9ff2419c9e4d62">hexdump</a>(f, 0, std::string(p)+<span class="stringliteral">"data at "</span>, <a class="code" href="classSgAsmGenericSection.html#96573fffe8f4f825c56ead24cc89a474">p_data</a>);
<a name="l00151"></a>00151 }
<a name="l00152"></a>00152 
<a name="l00153"></a>00153 <span class="comment">/*========================================================================================================================</span>
<a name="l00154"></a>00154 <span class="comment"> * Methods for classes related to the GNU Symbol Version Definition Table</span>
<a name="l00155"></a>00155 <span class="comment"> *</span>
<a name="l00156"></a>00156 <span class="comment"> * SgAsmElfSymverDefinedSection, each containing a list of</span>
<a name="l00157"></a>00157 <span class="comment"> * SgAsmElfSymverDefinedEntry, each containing a list of</span>
<a name="l00158"></a>00158 <span class="comment"> * SgAsmElfSymverDefinedAux, each pointing to a name string</span>
<a name="l00159"></a>00159 <span class="comment"> *======================================================================================================================== */</span>
<a name="l00160"></a>00160 
<a name="l00162"></a>00162 <span class="keywordtype">void</span>
<a name="l00163"></a><a class="code" href="classSgAsmElfSymverDefinedAux.html#73779be251d0ab45f0b2b1e211d43d79">00163</a> <a class="code" href="classSgAsmElfSymverDefinedAux.html#73779be251d0ab45f0b2b1e211d43d79">SgAsmElfSymverDefinedAux::ctor</a>(<a class="code" href="classSgAsmElfSymverDefinedEntry.html">SgAsmElfSymverDefinedEntry</a>* entry, <a class="code" href="classSgAsmElfSymverDefinedSection.html">SgAsmElfSymverDefinedSection</a>* symver)
<a name="l00164"></a>00164 {
<a name="l00165"></a>00165     <a class="code" href="classSgAsmElfStringSection.html">SgAsmElfStringSection</a> *strsec = <a class="code" href="Cxx__Grammar_8h.html#64d6dfe1ab5333d310d55fa2e7cbc923">isSgAsmElfStringSection</a>(symver-&gt;<a class="code" href="classSgAsmElfSection.html#44bf34de24ece59722ba6a9b3861e0cb">get_linked_section</a>());
<a name="l00166"></a>00166     ROSE_ASSERT(strsec!=NULL);
<a name="l00167"></a>00167 
<a name="l00168"></a>00168     <a class="code" href="classSgAsmStoredString.html">SgAsmStoredString</a> *name = <span class="keyword">new</span> <a class="code" href="classSgAsmStoredString.html">SgAsmStoredString</a>(strsec-&gt;<a class="code" href="classSgAsmElfStringSection.html#8b3438dd540f7aeb4dc27226f4eb9a07">get_strtab</a>(), 0);
<a name="l00169"></a>00169     <a class="code" href="classSgAsmElfSymverDefinedAux.html#17c96cecd2e35fa554ae2e3d7d752807">set_name</a>(name);
<a name="l00170"></a>00170     name-&gt;<a class="code" href="classSgNode.html#83017efa378d75b031330739c963749d">set_parent</a>(<span class="keyword">this</span>);
<a name="l00171"></a>00171   
<a name="l00172"></a>00172     ROSE_ASSERT(NULL != entry);
<a name="l00173"></a>00173     ROSE_ASSERT(NULL != entry-&gt;<a class="code" href="classSgAsmElfSymverDefinedEntry.html#0e6da0786faa25f3391e8f4029dd357f">get_entries</a>());
<a name="l00174"></a>00174     
<a name="l00175"></a>00175     entry-&gt;<a class="code" href="classSgAsmElfSymverDefinedEntry.html#0e6da0786faa25f3391e8f4029dd357f">get_entries</a>()-&gt;<a class="code" href="classSgAsmElfSymverDefinedAuxList.html#b6f2d79ae3fb4d505fac7e0d4380915f">get_entries</a>().push_back(<span class="keyword">this</span>);
<a name="l00176"></a>00176     <a class="code" href="classSgNode.html#83017efa378d75b031330739c963749d">set_parent</a>(entry-&gt;<a class="code" href="classSgAsmElfSymverDefinedEntry.html#0e6da0786faa25f3391e8f4029dd357f">get_entries</a>());
<a name="l00177"></a>00177 }
<a name="l00178"></a>00178 
<a name="l00182"></a>00182 <span class="keywordtype">void</span>
<a name="l00183"></a><a class="code" href="classSgAsmElfSymverDefinedAux.html#a003de80f93cbb0d6f3bee52f5ded978">00183</a> <a class="code" href="classSgAsmElfSymverDefinedAux.html#a003de80f93cbb0d6f3bee52f5ded978">SgAsmElfSymverDefinedAux::dump</a>(FILE *f, <span class="keyword">const</span> <span class="keywordtype">char</span> *<a class="code" href="SgUnaryOp_8docs.html#c6cf1576467b95ef29f025f8e47eea437afa939f8bd773f5f7e326990b07580c">prefix</a>, ssize_t idx)<span class="keyword"> const</span>
<a name="l00184"></a>00184 <span class="keyword"></span>{
<a name="l00185"></a>00185     <span class="keywordtype">char</span> p[4096];
<a name="l00186"></a>00186     <span class="keywordflow">if</span> (idx&gt;=0) {
<a name="l00187"></a>00187         sprintf(p, <span class="stringliteral">"%sElfSymverDefinedAux[%zd]."</span>, prefix, idx);
<a name="l00188"></a>00188     } <span class="keywordflow">else</span> {
<a name="l00189"></a>00189         sprintf(p, <span class="stringliteral">"%sElfSymverDefinedAux."</span>, prefix);
<a name="l00190"></a>00190     }
<a name="l00191"></a>00191     <span class="keyword">const</span> <span class="keywordtype">int</span> w = std::max(1, <a class="code" href="Cxx__Grammar_8h.html#b09cd568db5adadb46869d1ae0f6db69">DUMP_FIELD_WIDTH</a>-(<span class="keywordtype">int</span>)strlen(p));
<a name="l00192"></a>00192   
<a name="l00193"></a>00193     fprintf(f, <span class="stringliteral">"%s%-*s = %s \n"</span>, p, w, <span class="stringliteral">"name"</span>, <a class="code" href="classSgAsmElfSymverDefinedAux.html#f1048957f7ea8572fe8b445016bfb479">get_name</a>()-&gt;get_string(<span class="keyword">true</span>).c_str());
<a name="l00194"></a>00194 }
<a name="l00195"></a>00195 
<a name="l00197"></a>00197 <span class="keywordtype">void</span>
<a name="l00198"></a>00198 <a class="code" href="classSgAsmElfSymverDefinedAux.html#364f9d03789ec4fddf24629f9d03e909">SgAsmElfSymverDefinedAux::parse</a>(ByteOrder sex, <span class="keyword">const</span> ElfSymverDefinedAux_disk* disk)
<a name="l00199"></a>00199 {
<a name="l00200"></a>00200     <a class="code" href="rosedefs_8h.html#03b4aab6bc70ede394422915678b18df">rose_addr_t</a> name_offset  = <a class="code" href="classSgAsmExecutableFileFormat.html#52cc73212f6067429beb52b06b9ecc75">disk_to_host</a>(sex, disk-&gt;vda_name);
<a name="l00201"></a>00201     <a class="code" href="classSgAsmElfSymverDefinedAux.html#f1048957f7ea8572fe8b445016bfb479">get_name</a>()-&gt;<a class="code" href="classSgAsmGenericString.html#041608b8297d9f4bd334806d8f277e1b">set_string</a>(name_offset);
<a name="l00202"></a>00202 }
<a name="l00203"></a>00203 
<a name="l00205"></a>00205 <span class="keywordtype">void</span> *
<a name="l00206"></a>00206 <a class="code" href="classSgAsmElfSymverDefinedAux.html#79950fce64f6780962797683d0f9f488">SgAsmElfSymverDefinedAux::encode</a>(ByteOrder sex, ElfSymverDefinedAux_disk* disk)<span class="keyword"> const</span>
<a name="l00207"></a>00207 <span class="keyword"></span>{
<a name="l00208"></a>00208     <a class="code" href="rosedefs_8h.html#03b4aab6bc70ede394422915678b18df">rose_addr_t</a> name_offset = <a class="code" href="classSgAsmElfSymverDefinedAux.html#a09e4550c5f766e78deaca0f3a860957">p_name</a>-&gt;<a class="code" href="classSgAsmGenericString.html#a89c6a26f3ac3e61962059d30b3bd91b">get_offset</a>();
<a name="l00209"></a>00209     ROSE_ASSERT(name_offset!=<a class="code" href="classSgAsmGenericString.html#8f170b44372ce5149d912e62fd1f7d61">SgAsmGenericString::unallocated</a>);
<a name="l00210"></a>00210     <a class="code" href="classSgAsmExecutableFileFormat.html#19727362aeeba713bc0cc666de3c3f13">host_to_disk</a>(sex, name_offset, &amp;(disk-&gt;vda_name));
<a name="l00211"></a>00211     <span class="keywordflow">return</span> disk;
<a name="l00212"></a>00212 }
<a name="l00213"></a>00213 
<a name="l00215"></a>00215 <span class="keywordtype">void</span>
<a name="l00216"></a><a class="code" href="classSgAsmElfSymverDefinedEntry.html#a7e6c01888dcbb3a45861d52ddce3bea">00216</a> <a class="code" href="classSgAsmElfSymverDefinedEntry.html#a7e6c01888dcbb3a45861d52ddce3bea">SgAsmElfSymverDefinedEntry::ctor</a>(<a class="code" href="classSgAsmElfSymverDefinedSection.html">SgAsmElfSymverDefinedSection</a> *section)
<a name="l00217"></a>00217 {
<a name="l00218"></a>00218     ROSE_ASSERT(NULL != section);
<a name="l00219"></a>00219   
<a name="l00220"></a>00220     ROSE_ASSERT(NULL != section-&gt;<a class="code" href="classSgAsmElfSymverDefinedSection.html#746d4c8968db59523dce3fad8cb01719">get_entries</a>());
<a name="l00221"></a>00221     section-&gt;<a class="code" href="classSgAsmElfSymverDefinedSection.html#746d4c8968db59523dce3fad8cb01719">get_entries</a>()-&gt;<a class="code" href="classSgAsmElfSymverDefinedEntryList.html#c48109a0f9024c3708e3f6faab05e696">get_entries</a>().push_back(<span class="keyword">this</span>);
<a name="l00222"></a>00222 
<a name="l00223"></a>00223     ROSE_ASSERT(section-&gt;<a class="code" href="classSgAsmElfSymverDefinedSection.html#746d4c8968db59523dce3fad8cb01719">get_entries</a>()-&gt;<a class="code" href="classSgAsmElfSymverDefinedEntryList.html#c48109a0f9024c3708e3f6faab05e696">get_entries</a>().size()&gt;0);
<a name="l00224"></a>00224     <a class="code" href="classSgNode.html#83017efa378d75b031330739c963749d">set_parent</a>(section-&gt;<a class="code" href="classSgAsmElfSymverDefinedSection.html#746d4c8968db59523dce3fad8cb01719">get_entries</a>());
<a name="l00225"></a>00225 
<a name="l00226"></a>00226     <a class="code" href="classSgAsmElfSymverDefinedEntry.html#e62caf5a93cd74a4a67b4be02dca233b">p_entries</a> = <span class="keyword">new</span> <a class="code" href="classSgAsmElfSymverDefinedAuxList.html">SgAsmElfSymverDefinedAuxList</a>;
<a name="l00227"></a>00227     <a class="code" href="classSgAsmElfSymverDefinedEntry.html#b9f17f0956a359764b06c87fd8c87613">p_version</a>  = 0;
<a name="l00228"></a>00228     <a class="code" href="classSgAsmElfSymverDefinedEntry.html#255e43ca2de08648b205a0d89da3e9f0">p_flags</a>  = 0;
<a name="l00229"></a>00229     <a class="code" href="classSgAsmElfSymverDefinedEntry.html#6ee18bbb9bbf0a539271d3f55ba1c405">p_index</a> = 0;
<a name="l00230"></a>00230     <a class="code" href="classSgAsmElfSymverDefinedEntry.html#a953c17fd184fd8b99f002313e982e72">p_hash</a>  = 0;
<a name="l00231"></a>00231 }
<a name="l00232"></a>00232 
<a name="l00234"></a>00234 <span class="keywordtype">void</span>
<a name="l00235"></a>00235 <a class="code" href="classSgAsmElfSymverDefinedEntry.html#5287b7b03ca58153cf944d18c4b69530">SgAsmElfSymverDefinedEntry::parse</a>(ByteOrder sex, <span class="keyword">const</span> ElfSymverDefinedEntry_disk *disk)
<a name="l00236"></a>00236 {
<a name="l00237"></a>00237     <a class="code" href="classSgAsmElfSymverDefinedEntry.html#b9f17f0956a359764b06c87fd8c87613">p_version</a>  = <a class="code" href="classSgAsmExecutableFileFormat.html#52cc73212f6067429beb52b06b9ecc75">disk_to_host</a>(sex, disk-&gt;vd_version);
<a name="l00238"></a>00238     <a class="code" href="classSgAsmElfSymverDefinedEntry.html#255e43ca2de08648b205a0d89da3e9f0">p_flags</a>  = <a class="code" href="classSgAsmExecutableFileFormat.html#52cc73212f6067429beb52b06b9ecc75">disk_to_host</a>(sex, disk-&gt;vd_flags);
<a name="l00239"></a>00239     <a class="code" href="classSgAsmElfSymverDefinedEntry.html#6ee18bbb9bbf0a539271d3f55ba1c405">p_index</a> = <a class="code" href="classSgAsmExecutableFileFormat.html#52cc73212f6067429beb52b06b9ecc75">disk_to_host</a>(sex, disk-&gt;vd_ndx);
<a name="l00240"></a>00240     <a class="code" href="classSgAsmElfSymverDefinedEntry.html#a953c17fd184fd8b99f002313e982e72">p_hash</a>  = <a class="code" href="classSgAsmExecutableFileFormat.html#52cc73212f6067429beb52b06b9ecc75">disk_to_host</a>(sex, disk-&gt;vd_hash);  
<a name="l00241"></a>00241 }
<a name="l00242"></a>00242 
<a name="l00244"></a>00244 <span class="keywordtype">void</span> *
<a name="l00245"></a>00245 <a class="code" href="classSgAsmElfSymverDefinedEntry.html#322ec0a6fbe48cf087f3aed39ce19fab">SgAsmElfSymverDefinedEntry::encode</a>(ByteOrder sex, ElfSymverDefinedEntry_disk *disk)<span class="keyword"> const</span>
<a name="l00246"></a>00246 <span class="keyword"></span>{
<a name="l00247"></a>00247     <a class="code" href="classSgAsmExecutableFileFormat.html#19727362aeeba713bc0cc666de3c3f13">host_to_disk</a>(sex, <a class="code" href="classSgAsmElfSymverDefinedEntry.html#b9f17f0956a359764b06c87fd8c87613">p_version</a>, &amp;(disk-&gt;vd_version));
<a name="l00248"></a>00248     <a class="code" href="classSgAsmExecutableFileFormat.html#19727362aeeba713bc0cc666de3c3f13">host_to_disk</a>(sex, <a class="code" href="classSgAsmElfSymverDefinedEntry.html#255e43ca2de08648b205a0d89da3e9f0">p_flags</a>, &amp;(disk-&gt;vd_flags));
<a name="l00249"></a>00249     <a class="code" href="classSgAsmExecutableFileFormat.html#19727362aeeba713bc0cc666de3c3f13">host_to_disk</a>(sex, <a class="code" href="classSgAsmElfSymverDefinedEntry.html#6ee18bbb9bbf0a539271d3f55ba1c405">p_index</a>, &amp;(disk-&gt;vd_ndx));
<a name="l00250"></a>00250     <a class="code" href="classSgAsmExecutableFileFormat.html#19727362aeeba713bc0cc666de3c3f13">host_to_disk</a>(sex, <a class="code" href="classSgAsmElfSymverDefinedEntry.html#a953c17fd184fd8b99f002313e982e72">p_hash</a>, &amp;(disk-&gt;vd_hash));  
<a name="l00251"></a>00251     <span class="keywordflow">return</span> disk;
<a name="l00252"></a>00252 }
<a name="l00253"></a>00253 
<a name="l00255"></a>00255 <span class="keywordtype">void</span>
<a name="l00256"></a><a class="code" href="classSgAsmElfSymverDefinedEntry.html#77ca2cc9695d2e86e61edac27d4db0f8">00256</a> <a class="code" href="classSgAsmElfSymverDefinedEntry.html#77ca2cc9695d2e86e61edac27d4db0f8">SgAsmElfSymverDefinedEntry::dump</a>(FILE *f, <span class="keyword">const</span> <span class="keywordtype">char</span> *<a class="code" href="SgUnaryOp_8docs.html#c6cf1576467b95ef29f025f8e47eea437afa939f8bd773f5f7e326990b07580c">prefix</a>, ssize_t idx)<span class="keyword"> const</span>
<a name="l00257"></a>00257 <span class="keyword"></span>{
<a name="l00258"></a>00258     <span class="keywordtype">char</span> p[4096];
<a name="l00259"></a>00259     <span class="keywordflow">if</span> (idx&gt;=0) {
<a name="l00260"></a>00260         sprintf(p, <span class="stringliteral">"%sElfSymverDefinedEntry[%zd]."</span>, prefix, idx);
<a name="l00261"></a>00261     } <span class="keywordflow">else</span> {
<a name="l00262"></a>00262         sprintf(p, <span class="stringliteral">"%sElfSymverDefinedEntry."</span>, prefix);
<a name="l00263"></a>00263     }
<a name="l00264"></a>00264     <span class="keyword">const</span> <span class="keywordtype">int</span> w = std::max(1, <a class="code" href="Cxx__Grammar_8h.html#b09cd568db5adadb46869d1ae0f6db69">DUMP_FIELD_WIDTH</a>-(<span class="keywordtype">int</span>)strlen(p));
<a name="l00265"></a>00265 
<a name="l00266"></a>00266     <span class="comment">/* compact one-line-per-entry format */</span>
<a name="l00267"></a>00267     <span class="keywordflow">if</span> (0==idx)
<a name="l00268"></a>00268         fprintf(f, <span class="stringliteral">"%s%-*s   %-8s %6s %10s %6s %-6s \n"</span>, p, w, <span class="stringliteral">""</span>, <span class="stringliteral">"Version"</span>, <span class="stringliteral">"Index"</span>, <span class="stringliteral">"Hash"</span>, <span class="stringliteral">"Flags"</span>, <span class="stringliteral">"Names"</span>);
<a name="l00269"></a>00269     fprintf(f,   <span class="stringliteral">"%s%-*s =  0x%04zx  0x%04zx 0x%08x 0x%04x"</span>, p, w, <span class="stringliteral">""</span>, <a class="code" href="classSgAsmElfSymverDefinedEntry.html#b9f17f0956a359764b06c87fd8c87613">p_version</a>, <a class="code" href="classSgAsmElfSymverDefinedEntry.html#6ee18bbb9bbf0a539271d3f55ba1c405">p_index</a>, <a class="code" href="classSgAsmElfSymverDefinedEntry.html#a953c17fd184fd8b99f002313e982e72">p_hash</a>, (uint32_t)<a class="code" href="classSgAsmElfSymverDefinedEntry.html#255e43ca2de08648b205a0d89da3e9f0">p_flags</a>);
<a name="l00270"></a>00270     <span class="keyword">const</span> <a class="code" href="Cxx__Grammar_8h.html#ce2ca33d15ec9abea4a4f6eb29698faf">SgAsmElfSymverDefinedAuxPtrList</a> &amp;entries=<a class="code" href="classSgAsmElfSymverDefinedEntry.html#0e6da0786faa25f3391e8f4029dd357f">get_entries</a>()-&gt;<a class="code" href="classSgAsmElfSymverDefinedAuxList.html#b6f2d79ae3fb4d505fac7e0d4380915f">get_entries</a>();
<a name="l00271"></a>00271     <span class="keywordflow">for</span> (size_t i=0; i &lt; entries.size(); ++i)
<a name="l00272"></a>00272         fprintf(f, <span class="stringliteral">"%s %s"</span>, 0==i?<span class="stringliteral">""</span>:<span class="stringliteral">","</span>, entries[i]-&gt;<a class="code" href="namespaceSageInterface.html#d8c38176c2d0e4d2bc851e70007902f9">get_name</a>()-&gt;get_string(<span class="keyword">true</span>).c_str());
<a name="l00273"></a>00273     fputc(<span class="charliteral">'\n'</span>, f);
<a name="l00274"></a>00274 }
<a name="l00275"></a>00275 
<a name="l00277"></a>00277 <span class="keywordtype">void</span>
<a name="l00278"></a><a class="code" href="classSgAsmElfSymverDefinedSection.html#de3ddbd9b9b6bd90e785dd05977348ac">00278</a> <a class="code" href="classSgAsmElfSection.html#777c5e1c2ac65fd5378fdf08364acf85">SgAsmElfSymverDefinedSection::ctor</a>(<a class="code" href="classSgAsmElfStringSection.html">SgAsmElfStringSection</a> *strings)
<a name="l00279"></a>00279 {
<a name="l00280"></a>00280     <a class="code" href="classSgAsmElfSymverDefinedSection.html#12cbafd90d175b506149c1e81ef47499">p_entries</a> = <span class="keyword">new</span> <a class="code" href="classSgAsmElfSymverDefinedEntryList.html">SgAsmElfSymverDefinedEntryList</a>;
<a name="l00281"></a>00281     <a class="code" href="classSgAsmElfSymverDefinedSection.html#12cbafd90d175b506149c1e81ef47499">p_entries</a>-&gt;<a class="code" href="classSgNode.html#83017efa378d75b031330739c963749d">set_parent</a>(<span class="keyword">this</span>);
<a name="l00282"></a>00282   
<a name="l00283"></a>00283     ROSE_ASSERT(NULL != strings);
<a name="l00284"></a>00284     <a class="code" href="classSgAsmElfSection.html#19ea328fdfe31bd968b930c88a49d07b">p_linked_section</a> = strings;
<a name="l00285"></a>00285 }
<a name="l00286"></a>00286 
<a name="l00353"></a>00353 <a class="code" href="classSgAsmElfSymverDefinedSection.html">SgAsmElfSymverDefinedSection</a> *
<a name="l00354"></a><a class="code" href="classSgAsmElfSymverDefinedSection.html#64cdc9bed353d7fabdbce2f45ec61713">00354</a> <a class="code" href="classSgAsmElfSymverDefinedSection.html#64cdc9bed353d7fabdbce2f45ec61713">SgAsmElfSymverDefinedSection::parse</a>()
<a name="l00355"></a>00355 {
<a name="l00356"></a>00356     <a class="code" href="classSgAsmGenericSection.html#06e6f2a4c28be5858d6a0b92573908d7">SgAsmElfSection::parse</a>();
<a name="l00357"></a>00357   
<a name="l00358"></a>00358     <a class="code" href="classSgAsmElfFileHeader.html">SgAsmElfFileHeader</a> *fhdr = <a class="code" href="classSgAsmElfSection.html#a430cf4e1e6376e12f3b5dc8363099c4">get_elf_header</a>();
<a name="l00359"></a>00359     ROSE_ASSERT(NULL!=fhdr);
<a name="l00360"></a>00360     <a class="code" href="classSgAsmElfSectionTableEntry.html">SgAsmElfSectionTableEntry</a> *shdr = <a class="code" href="classSgAsmElfSection.html#9ef7cc77be330cde6c32ef598e312971">get_section_entry</a>();
<a name="l00361"></a>00361     ROSE_ASSERT(NULL!=shdr);
<a name="l00362"></a>00362     <a class="code" href="classSgAsmElfStringSection.html">SgAsmElfStringSection</a> *strsec = dynamic_cast&lt;SgAsmElfStringSection*&gt;(<a class="code" href="classSgAsmElfSection.html#44bf34de24ece59722ba6a9b3861e0cb">get_linked_section</a>());
<a name="l00363"></a>00363     ROSE_ASSERT(NULL!=strsec);
<a name="l00364"></a>00364   
<a name="l00365"></a>00365     <span class="comment">//size_t struct_size=sizeof(SgAsmElfSymverDefinedEntry::ElfSymverDefinedEntry_disk);</span>
<a name="l00366"></a>00366   
<a name="l00367"></a>00367     <a class="code" href="rosedefs_8h.html#03b4aab6bc70ede394422915678b18df">rose_addr_t</a> entry_addr=0;
<a name="l00368"></a>00368 
<a name="l00369"></a>00369     <a class="code" href="classSgAsmExecutableFileFormat.html#9f34e9e7666815ddeee9be5df5573a80">ByteOrder</a> sex=fhdr-&gt;<a class="code" href="classSgAsmGenericHeader.html#3269e8ea6c30182607e9d4ee79fc05a8">get_sex</a>();
<a name="l00370"></a>00370     <span class="comment">/* Parse each entry*/</span>
<a name="l00371"></a>00371     <span class="keywordflow">while</span> (entry_addr &lt; this-&gt;<a class="code" href="classSgAsmGenericSection.html#4c0fa714119712ac19d50340d62ab8f1">get_size</a>()) {
<a name="l00372"></a>00372         <a class="code" href="classSgAsmElfSymverDefinedEntry.html">SgAsmElfSymverDefinedEntry</a> *entry=<span class="keyword">new</span> <a class="code" href="classSgAsmElfSymverDefinedEntry.html">SgAsmElfSymverDefinedEntry</a>(<span class="keyword">this</span>); <span class="comment">/*adds SymverDefinedEntry to this*/</span>
<a name="l00373"></a>00373         <a class="code" href="structSgAsmElfSymverDefinedEntry_1_1ElfSymverDefinedEntry__disk.html">SgAsmElfSymverDefinedEntry::ElfSymverDefinedEntry_disk</a> entryDisk;
<a name="l00374"></a>00374         <a class="code" href="classSgAsmGenericSection.html#e7516833466da3f886fafd0b1bc1f803">read_content_local</a>(entry_addr, &amp;entryDisk, <span class="keyword">sizeof</span>(entryDisk));
<a name="l00375"></a>00375         entry-&gt;<a class="code" href="classSgAsmElfSymverDefinedEntry.html#5287b7b03ca58153cf944d18c4b69530">parse</a>(sex, &amp;entryDisk);
<a name="l00376"></a>00376 
<a name="l00377"></a>00377         <span class="comment">/* These are relative to the start of this entry - i.e. entry_addr */</span>
<a name="l00378"></a>00378         size_t num_aux = <a class="code" href="classSgAsmExecutableFileFormat.html#52cc73212f6067429beb52b06b9ecc75">disk_to_host</a>(sex,entryDisk.vd_cnt);
<a name="l00379"></a>00379         size_t first_aux = <a class="code" href="classSgAsmExecutableFileFormat.html#52cc73212f6067429beb52b06b9ecc75">disk_to_host</a>(sex,entryDisk.vd_aux);
<a name="l00380"></a>00380         size_t next_entry = <a class="code" href="classSgAsmExecutableFileFormat.html#52cc73212f6067429beb52b06b9ecc75">disk_to_host</a>(sex,entryDisk.vd_next);  
<a name="l00381"></a>00381 
<a name="l00382"></a>00382         <a class="code" href="rosedefs_8h.html#03b4aab6bc70ede394422915678b18df">rose_addr_t</a> aux_addr=entry_addr+first_aux;
<a name="l00383"></a>00383         <span class="keywordflow">for</span> (size_t i=0; i &lt; num_aux; ++i) {
<a name="l00384"></a>00384             <a class="code" href="classSgAsmElfSymverDefinedAux.html">SgAsmElfSymverDefinedAux</a> *aux=<span class="keyword">new</span> <a class="code" href="classSgAsmElfSymverDefinedAux.html">SgAsmElfSymverDefinedAux</a>(entry,<span class="keyword">this</span>); <span class="comment">/*adds SymverDefinedAux to this entry*/</span>
<a name="l00385"></a>00385             <a class="code" href="structSgAsmElfSymverDefinedAux_1_1ElfSymverDefinedAux__disk.html">SgAsmElfSymverDefinedAux::ElfSymverDefinedAux_disk</a> auxDisk;
<a name="l00386"></a>00386             <a class="code" href="classSgAsmGenericSection.html#e7516833466da3f886fafd0b1bc1f803">read_content_local</a>(aux_addr, &amp;auxDisk, <span class="keyword">sizeof</span>(auxDisk));
<a name="l00387"></a>00387             aux-&gt;parse(fhdr-&gt;<a class="code" href="classSgAsmGenericHeader.html#3269e8ea6c30182607e9d4ee79fc05a8">get_sex</a>(), &amp;auxDisk);
<a name="l00388"></a>00388 
<a name="l00389"></a>00389             size_t next_aux = <a class="code" href="classSgAsmExecutableFileFormat.html#52cc73212f6067429beb52b06b9ecc75">disk_to_host</a>(sex,auxDisk.vda_next);      
<a name="l00390"></a>00390             <span class="keywordflow">if</span> (next_aux == 0)
<a name="l00391"></a>00391                 <span class="keywordflow">break</span>;
<a name="l00392"></a>00392             aux_addr+=next_aux;
<a name="l00393"></a>00393         }
<a name="l00394"></a>00394 
<a name="l00395"></a>00395         <span class="keywordflow">if</span>(next_entry == 0)
<a name="l00396"></a>00396           <span class="keywordflow">break</span>;
<a name="l00397"></a>00397         entry_addr += next_entry;
<a name="l00398"></a>00398     }
<a name="l00399"></a>00399 
<a name="l00400"></a>00400     <span class="keywordflow">return</span> <span class="keyword">this</span>;
<a name="l00401"></a>00401 }
<a name="l00402"></a>00402 
<a name="l00404"></a>00404 <a class="code" href="rosedefs_8h.html#03b4aab6bc70ede394422915678b18df">rose_addr_t</a>
<a name="l00405"></a><a class="code" href="classSgAsmElfSymverDefinedSection.html#e41111f5ac38ddd2739562946f07029b">00405</a> <a class="code" href="classSgAsmElfSymverDefinedSection.html#e41111f5ac38ddd2739562946f07029b">SgAsmElfSymverDefinedSection::calculate_sizes</a>(size_t *entsize, size_t *required, size_t *optional, size_t *entcount)<span class="keyword"> const</span>
<a name="l00406"></a>00406 <span class="keyword"></span>{
<a name="l00407"></a>00407     size_t struct_size = <span class="keyword">sizeof</span>(<a class="code" href="structSgAsmElfSymverDefinedEntry_1_1ElfSymverDefinedEntry__disk.html">SgAsmElfSymverDefinedEntry::ElfSymverDefinedEntry_disk</a>);
<a name="l00408"></a>00408     size_t aux_size = <span class="keyword">sizeof</span>(<a class="code" href="structSgAsmElfSymverDefinedAux_1_1ElfSymverDefinedAux__disk.html">SgAsmElfSymverDefinedAux::ElfSymverDefinedAux_disk</a>);
<a name="l00409"></a>00409 
<a name="l00410"></a>00410     size_t extra_size = 0;
<a name="l00411"></a>00411     size_t entry_size = 0;
<a name="l00412"></a>00412     size_t nentries = <a class="code" href="classSgAsmElfSymverDefinedSection.html#746d4c8968db59523dce3fad8cb01719">get_entries</a>()-&gt;<a class="code" href="classSgAsmElfSymverDefinedEntryList.html#c48109a0f9024c3708e3f6faab05e696">get_entries</a>().size();
<a name="l00413"></a>00413 
<a name="l00414"></a>00414     size_t total_size=0;
<a name="l00415"></a>00415     <span class="comment">/* Entire entry should be at least large enough for the required part. */</span>
<a name="l00416"></a>00416     entry_size = struct_size;
<a name="l00417"></a>00417   
<a name="l00418"></a>00418     <span class="comment">/* Each entry has a list of 'aux' structures */</span>    
<a name="l00419"></a>00419     <span class="keyword">const</span> <a class="code" href="Cxx__Grammar_8h.html#a841b18a90a7366ae6d00489eb666d74">SgAsmElfSymverDefinedEntryPtrList</a> &amp;entries = <a class="code" href="classSgAsmElfSymverDefinedSection.html#746d4c8968db59523dce3fad8cb01719">get_entries</a>()-&gt;<a class="code" href="classSgAsmElfSymverDefinedEntryList.html#c48109a0f9024c3708e3f6faab05e696">get_entries</a>();
<a name="l00420"></a>00420     <span class="keywordflow">for</span> (size_t i=0; i&lt;nentries; ++i) {
<a name="l00421"></a>00421         size_t numAux = entries[i]-&gt;<a class="code" href="classSgAsmElfSymverDefinedSection.html#746d4c8968db59523dce3fad8cb01719">get_entries</a>()-&gt;<a class="code" href="classSgAsmElfSymverDefinedSection.html#746d4c8968db59523dce3fad8cb01719">get_entries</a>().size();
<a name="l00422"></a>00422         extra_size = std::max(extra_size, numAux * aux_size);
<a name="l00423"></a>00423         total_size += (struct_size + (numAux* aux_size));
<a name="l00424"></a>00424     }
<a name="l00425"></a>00425     <span class="comment">/* Note - we could try to reach into the dynamic section for nentries */</span>
<a name="l00426"></a>00426   
<a name="l00427"></a>00427     <span class="comment">/* Return values */</span>
<a name="l00428"></a>00428     <span class="keywordflow">if</span> (entsize)
<a name="l00429"></a>00429         *entsize = entry_size;
<a name="l00430"></a>00430     <span class="keywordflow">if</span> (required)
<a name="l00431"></a>00431         *required = struct_size;
<a name="l00432"></a>00432     <span class="keywordflow">if</span> (optional)
<a name="l00433"></a>00433         *optional = extra_size;
<a name="l00434"></a>00434     <span class="keywordflow">if</span> (entcount)
<a name="l00435"></a>00435         *entcount = nentries;
<a name="l00436"></a>00436     <span class="keywordflow">return</span> total_size;
<a name="l00437"></a>00437 }
<a name="l00438"></a>00438 
<a name="l00440"></a>00440 <span class="keywordtype">void</span>
<a name="l00441"></a><a class="code" href="classSgAsmElfSymverDefinedSection.html#0d0cba5d85372f8447d03ca01045b82b">00441</a> <a class="code" href="classSgAsmElfSymverDefinedSection.html#0d0cba5d85372f8447d03ca01045b82b">SgAsmElfSymverDefinedSection::unparse</a>(std::ostream &amp;f)<span class="keyword"> const</span>
<a name="l00442"></a>00442 <span class="keyword"></span>{
<a name="l00443"></a>00443     <a class="code" href="classSgAsmElfFileHeader.html">SgAsmElfFileHeader</a> *fhdr = <a class="code" href="classSgAsmElfSection.html#a430cf4e1e6376e12f3b5dc8363099c4">get_elf_header</a>();
<a name="l00444"></a>00444     ROSE_ASSERT(NULL != fhdr);
<a name="l00445"></a>00445     <a class="code" href="classSgAsmExecutableFileFormat.html#9f34e9e7666815ddeee9be5df5573a80">ByteOrder</a> sex = fhdr-&gt;<a class="code" href="classSgAsmGenericHeader.html#3269e8ea6c30182607e9d4ee79fc05a8">get_sex</a>();
<a name="l00446"></a>00446     size_t nentries;
<a name="l00447"></a>00447     <a class="code" href="classSgAsmElfSymverDefinedSection.html#e41111f5ac38ddd2739562946f07029b">calculate_sizes</a>(NULL,NULL,NULL,&amp;nentries);
<a name="l00448"></a>00448 
<a name="l00449"></a>00449     <span class="comment">/* Adjust the entry size stored in the ELF Section Table */</span>
<a name="l00450"></a>00450     <a class="code" href="classSgAsmElfSection.html#9ef7cc77be330cde6c32ef598e312971">get_section_entry</a>()-&gt;<a class="code" href="classSgAsmElfSectionTableEntry.html#d4f8b40b80fd40a7ce026db601e85911">set_sh_entsize</a>(0); <span class="comment">/*This doesn't have consistently sized entries, zero it*/</span>
<a name="l00451"></a>00451   
<a name="l00452"></a>00452     <span class="comment">/* Write each entry's required part followed by the optional part */</span>
<a name="l00453"></a>00453     <a class="code" href="rosedefs_8h.html#03b4aab6bc70ede394422915678b18df">rose_addr_t</a> entry_addr=0;<span class="comment">/*as offset from section*/</span>
<a name="l00454"></a>00454 
<a name="l00455"></a>00455     <span class="keywordflow">for</span> (size_t ent=0; ent &lt; nentries; ++ent) {
<a name="l00456"></a>00456         <a class="code" href="classSgAsmElfSymverDefinedEntry.html">SgAsmElfSymverDefinedEntry</a> *entry=<a class="code" href="classSgAsmElfSymverDefinedSection.html#746d4c8968db59523dce3fad8cb01719">get_entries</a>()-&gt;<a class="code" href="classSgAsmElfSymverDefinedSection.html#746d4c8968db59523dce3fad8cb01719">get_entries</a>()[ent];
<a name="l00457"></a>00457         <a class="code" href="structSgAsmElfSymverDefinedEntry_1_1ElfSymverDefinedEntry__disk.html">SgAsmElfSymverDefinedEntry::ElfSymverDefinedEntry_disk</a> entryDisk;
<a name="l00458"></a>00458         entry-&gt;encode(sex, &amp;entryDisk);
<a name="l00459"></a>00459         <span class="keyword">const</span> size_t entry_size=<span class="keyword">sizeof</span>(<a class="code" href="structSgAsmElfSymverDefinedEntry_1_1ElfSymverDefinedEntry__disk.html">SgAsmElfSymverDefinedEntry::ElfSymverDefinedEntry_disk</a>);
<a name="l00460"></a>00460         <span class="keyword">const</span> size_t aux_size=<span class="keyword">sizeof</span>(<a class="code" href="structSgAsmElfSymverDefinedAux_1_1ElfSymverDefinedAux__disk.html">SgAsmElfSymverDefinedAux::ElfSymverDefinedAux_disk</a>);
<a name="l00461"></a>00461     
<a name="l00462"></a>00462         <span class="keyword">const</span> <a class="code" href="Cxx__Grammar_8h.html#ce2ca33d15ec9abea4a4f6eb29698faf">SgAsmElfSymverDefinedAuxPtrList</a>&amp; auxes = entry-&gt;get_entries()-&gt;get_entries();
<a name="l00463"></a>00463         size_t num_aux = auxes.size();
<a name="l00464"></a>00464         size_t first_aux = entry_size;<span class="comment">/*we always stick Aux's just after Entry*/</span>
<a name="l00465"></a>00465         size_t next_entry = first_aux + ( num_aux * aux_size );
<a name="l00466"></a>00466         <span class="keywordflow">if</span> (nentries -1 == ent) {
<a name="l00467"></a>00467             next_entry=0; <span class="comment">/*final entry: next is null (0)*/</span>
<a name="l00468"></a>00468         }
<a name="l00469"></a>00469 
<a name="l00470"></a>00470         <a class="code" href="classSgAsmExecutableFileFormat.html#19727362aeeba713bc0cc666de3c3f13">host_to_disk</a>(sex,    num_aux, &amp;entryDisk.<a class="code" href="structSgAsmElfSymverDefinedEntry_1_1ElfSymverDefinedEntry__disk.html#708423e1e2844cc5242b09267db0960e">vd_cnt</a>);
<a name="l00471"></a>00471         <a class="code" href="classSgAsmExecutableFileFormat.html#19727362aeeba713bc0cc666de3c3f13">host_to_disk</a>(sex,  first_aux, &amp;entryDisk.<a class="code" href="structSgAsmElfSymverDefinedEntry_1_1ElfSymverDefinedEntry__disk.html#c1c9603c3044594541dac55600688b78">vd_aux</a>);
<a name="l00472"></a>00472         <a class="code" href="classSgAsmExecutableFileFormat.html#19727362aeeba713bc0cc666de3c3f13">host_to_disk</a>(sex, next_entry, &amp;entryDisk.<a class="code" href="structSgAsmElfSymverDefinedEntry_1_1ElfSymverDefinedEntry__disk.html#2b270ce527b5ae8693aa3c2c16ec02bb">vd_next</a>);
<a name="l00473"></a>00473 
<a name="l00474"></a>00474         <a class="code" href="classSgAsmGenericSection.html#8e0601bfbe531ff8973c2458543aaad6">write</a>(f, entry_addr, entry_size,&amp;entryDisk);
<a name="l00475"></a>00475 
<a name="l00476"></a>00476         <a class="code" href="rosedefs_8h.html#03b4aab6bc70ede394422915678b18df">rose_addr_t</a> aux_addr=entry_addr+first_aux;
<a name="l00477"></a>00477         <span class="keywordflow">for</span> (size_t i=0; i &lt; num_aux; ++i) {
<a name="l00478"></a>00478             <a class="code" href="classSgAsmElfSymverDefinedAux.html">SgAsmElfSymverDefinedAux</a> *aux=auxes[i];
<a name="l00479"></a>00479 
<a name="l00480"></a>00480             <a class="code" href="structSgAsmElfSymverDefinedAux_1_1ElfSymverDefinedAux__disk.html">SgAsmElfSymverDefinedAux::ElfSymverDefinedAux_disk</a> auxDisk;
<a name="l00481"></a>00481             aux-&gt;encode(sex, &amp;auxDisk);
<a name="l00482"></a>00482       
<a name="l00483"></a>00483             size_t next_aux = aux_size;<span class="comment">/*all auxes are contigious, so the next one is always just 8*/</span>
<a name="l00484"></a>00484             <span class="keywordflow">if</span> (num_aux-1 == i) {
<a name="l00485"></a>00485                 next_aux=0;<span class="comment">/* ... unless it is the final aux, then the next is null (0) */</span>
<a name="l00486"></a>00486             }
<a name="l00487"></a>00487             <a class="code" href="classSgAsmExecutableFileFormat.html#19727362aeeba713bc0cc666de3c3f13">host_to_disk</a>(sex,next_aux, &amp;auxDisk.<a class="code" href="structSgAsmElfSymverDefinedAux_1_1ElfSymverDefinedAux__disk.html#eb39d943dc20a99aea79863a909da4eb">vda_next</a>);
<a name="l00488"></a>00488 
<a name="l00489"></a>00489             <a class="code" href="classSgAsmGenericSection.html#8e0601bfbe531ff8973c2458543aaad6">write</a>(f,aux_addr,aux_size, &amp;auxDisk);
<a name="l00490"></a>00490             aux_addr+=next_aux;
<a name="l00491"></a>00491         }
<a name="l00492"></a>00492 
<a name="l00493"></a>00493         entry_addr += next_entry;
<a name="l00494"></a>00494     }
<a name="l00495"></a>00495 
<a name="l00496"></a>00496     <a class="code" href="classSgAsmGenericSection.html#5093c3cf64be87688030517c67370dae">unparse_holes</a>(f);
<a name="l00497"></a>00497 }
<a name="l00498"></a>00498 
<a name="l00500"></a>00500 <span class="keywordtype">void</span>
<a name="l00501"></a><a class="code" href="classSgAsmElfSymverDefinedSection.html#ebccf98b352c8d8d9742fe4be2bc40d9">00501</a> <a class="code" href="classSgAsmElfSymverDefinedSection.html#ebccf98b352c8d8d9742fe4be2bc40d9">SgAsmElfSymverDefinedSection::dump</a>(FILE *f, <span class="keyword">const</span> <span class="keywordtype">char</span> *<a class="code" href="SgUnaryOp_8docs.html#c6cf1576467b95ef29f025f8e47eea437afa939f8bd773f5f7e326990b07580c">prefix</a>, ssize_t idx)<span class="keyword"> const</span>
<a name="l00502"></a>00502 <span class="keyword"></span>{
<a name="l00503"></a>00503     <span class="keywordtype">char</span> p[4096];
<a name="l00504"></a>00504     <span class="keywordflow">if</span> (idx&gt;=0) {
<a name="l00505"></a>00505         sprintf(p, <span class="stringliteral">"%sElfSymverDefinedSection[%zd]."</span>, prefix, idx);
<a name="l00506"></a>00506     } <span class="keywordflow">else</span> {
<a name="l00507"></a>00507         sprintf(p, <span class="stringliteral">"%sElfSymverDefinedSection."</span>, prefix);
<a name="l00508"></a>00508     }
<a name="l00509"></a>00509     <span class="keyword">const</span> <span class="keywordtype">int</span> w = std::max(1, <a class="code" href="Cxx__Grammar_8h.html#b09cd568db5adadb46869d1ae0f6db69">DUMP_FIELD_WIDTH</a>-(<span class="keywordtype">int</span>)strlen(p));
<a name="l00510"></a>00510   
<a name="l00511"></a>00511     <a class="code" href="classSgAsmElfSection.html#4fd8ef83c67a6b432974fab51f4122b7">SgAsmElfSection::dump</a>(f, p, -1);
<a name="l00512"></a>00512     fprintf(f, <span class="stringliteral">"%s%-*s = %zu entries\n"</span>, p, w, <span class="stringliteral">"ElfSymverDefined.size"</span>, <a class="code" href="classSgAsmElfSymverDefinedSection.html#12cbafd90d175b506149c1e81ef47499">p_entries</a>-&gt;<a class="code" href="classSgAsmElfSymverDefinedEntryList.html#c48109a0f9024c3708e3f6faab05e696">get_entries</a>().size());
<a name="l00513"></a>00513     <span class="keywordflow">for</span> (size_t i = 0; i &lt; <a class="code" href="classSgAsmElfSymverDefinedSection.html#12cbafd90d175b506149c1e81ef47499">p_entries</a>-&gt;<a class="code" href="classSgAsmElfSymverDefinedEntryList.html#c48109a0f9024c3708e3f6faab05e696">get_entries</a>().size(); i++) {
<a name="l00514"></a>00514         <a class="code" href="classSgAsmElfSymverDefinedSection.html#12cbafd90d175b506149c1e81ef47499">p_entries</a>-&gt;<a class="code" href="classSgAsmElfSymverDefinedEntryList.html#c48109a0f9024c3708e3f6faab05e696">get_entries</a>()[i]-&gt;dump(f, p, i);
<a name="l00515"></a>00515     }
<a name="l00516"></a>00516   
<a name="l00517"></a>00517     <span class="keywordflow">if</span> (<a class="code" href="classSgAsmElfSymverDefinedSection.html#0649687feb6f8712106eb1ca583224e2">variantT</a>() == <a class="code" href="Cxx__Grammar_8h.html#adcb00b11de1167a498bced81d3e3464e49f7b9acd9496c947053b27516de1d5">V_SgAsmElfSymverDefinedSection</a>) <span class="comment">/*unless a base class*/</span>
<a name="l00518"></a>00518         <a class="code" href="classSgAsmExecutableFileFormat.html#548279193ba7eec2ae9ff2419c9e4d62">hexdump</a>(f, 0, std::string(p)+<span class="stringliteral">"data at "</span>, <a class="code" href="classSgAsmGenericSection.html#96573fffe8f4f825c56ead24cc89a474">p_data</a>);
<a name="l00519"></a>00519 }
<a name="l00520"></a>00520 
<a name="l00521"></a>00521 <span class="comment">/*========================================================================================================================</span>
<a name="l00522"></a>00522 <span class="comment"> * Methods for section relating to the GNU Symbol Version Requirements Table.</span>
<a name="l00523"></a>00523 <span class="comment"> *</span>
<a name="l00524"></a>00524 <span class="comment"> * SgAsmElfSymverNeededSection, each containing a list of</span>
<a name="l00525"></a>00525 <span class="comment"> * SgAsmElfSymverNeededEntry, each containing a list of</span>
<a name="l00526"></a>00526 <span class="comment"> * SgAsmElfSymverNeededAux.</span>
<a name="l00527"></a>00527 <span class="comment"> *======================================================================================================================== */</span>
<a name="l00528"></a>00528 
<a name="l00531"></a>00531 <span class="keywordtype">void</span>
<a name="l00532"></a><a class="code" href="classSgAsmElfSymverNeededAux.html#913f203f5e4dd9ce0ba4be4a54106449">00532</a> <a class="code" href="classSgAsmElfSymverNeededAux.html#913f203f5e4dd9ce0ba4be4a54106449">SgAsmElfSymverNeededAux::ctor</a>(<a class="code" href="classSgAsmElfSymverNeededEntry.html">SgAsmElfSymverNeededEntry</a>* entry, <a class="code" href="classSgAsmElfSymverNeededSection.html">SgAsmElfSymverNeededSection</a>* symver)
<a name="l00533"></a>00533 {
<a name="l00534"></a>00534     <a class="code" href="classSgAsmElfStringSection.html">SgAsmElfStringSection</a> *strsec = <a class="code" href="Cxx__Grammar_8h.html#64d6dfe1ab5333d310d55fa2e7cbc923">isSgAsmElfStringSection</a>(symver-&gt;<a class="code" href="classSgAsmElfSection.html#44bf34de24ece59722ba6a9b3861e0cb">get_linked_section</a>());
<a name="l00535"></a>00535     ROSE_ASSERT(NULL != strsec);
<a name="l00536"></a>00536 
<a name="l00537"></a>00537     <a class="code" href="classSgAsmElfSymverNeededAux.html#75f058a055b518fcda629f257ac36507">p_name</a> = <span class="keyword">new</span> <a class="code" href="classSgAsmStoredString.html">SgAsmStoredString</a>(strsec-&gt;<a class="code" href="classSgAsmElfStringSection.html#8b3438dd540f7aeb4dc27226f4eb9a07">get_strtab</a>(), 0);
<a name="l00538"></a>00538     <a class="code" href="classSgAsmElfSymverNeededAux.html#75f058a055b518fcda629f257ac36507">p_name</a>-&gt;<a class="code" href="classSgNode.html#83017efa378d75b031330739c963749d">set_parent</a>(<span class="keyword">this</span>);
<a name="l00539"></a>00539 
<a name="l00540"></a>00540     ROSE_ASSERT(NULL != entry);
<a name="l00541"></a>00541     ROSE_ASSERT(NULL != entry-&gt;<a class="code" href="classSgAsmElfSymverNeededEntry.html#b48223a3ad45eec07c21d9f5a5fc7bbc">get_entries</a>());
<a name="l00542"></a>00542     entry-&gt;<a class="code" href="classSgAsmElfSymverNeededEntry.html#b48223a3ad45eec07c21d9f5a5fc7bbc">get_entries</a>()-&gt;<a class="code" href="classSgAsmElfSymverNeededAuxList.html#dc940a2067ea4ff096ba4e450c1cd2c8">get_entries</a>().push_back(<span class="keyword">this</span>);
<a name="l00543"></a>00543     <a class="code" href="classSgNode.html#83017efa378d75b031330739c963749d">set_parent</a>(entry-&gt;<a class="code" href="classSgAsmElfSymverNeededEntry.html#b48223a3ad45eec07c21d9f5a5fc7bbc">get_entries</a>());
<a name="l00544"></a>00544 
<a name="l00545"></a>00545     <a class="code" href="classSgAsmElfSymverNeededAux.html#68a76214a24535f6324ae693226ddd38">p_flags</a>  = 0;
<a name="l00546"></a>00546     <a class="code" href="classSgAsmElfSymverNeededAux.html#d3c63d62561f66decbd7df9a63425ac6">p_other</a> = 0;
<a name="l00547"></a>00547     <a class="code" href="classSgAsmElfSymverNeededAux.html#b0aa5e642313ea8dc7cd71e8b4840458">p_hash</a>  = 0;
<a name="l00548"></a>00548 }
<a name="l00549"></a>00549 
<a name="l00553"></a>00553 <span class="keywordtype">void</span>
<a name="l00554"></a><a class="code" href="classSgAsmElfSymverNeededAux.html#8893f55f8dd3b8f25ac41d7dd5d6e435">00554</a> <a class="code" href="classSgAsmElfSymverNeededAux.html#8893f55f8dd3b8f25ac41d7dd5d6e435">SgAsmElfSymverNeededAux::dump</a>(FILE *f, <span class="keyword">const</span> <span class="keywordtype">char</span> *<a class="code" href="SgUnaryOp_8docs.html#c6cf1576467b95ef29f025f8e47eea437afa939f8bd773f5f7e326990b07580c">prefix</a>, ssize_t idx)<span class="keyword"> const</span>
<a name="l00555"></a>00555 <span class="keyword"></span>{
<a name="l00556"></a>00556     <span class="keywordtype">char</span> p[4096];
<a name="l00557"></a>00557     <span class="keywordflow">if</span> (idx&gt;=0) {
<a name="l00558"></a>00558         sprintf(p, <span class="stringliteral">"%sElfSymverNeededAux[%zd]."</span>, prefix, idx);
<a name="l00559"></a>00559     } <span class="keywordflow">else</span> {
<a name="l00560"></a>00560         sprintf(p, <span class="stringliteral">"%sElfSymverNeededAux."</span>, prefix);
<a name="l00561"></a>00561     }
<a name="l00562"></a>00562     <span class="keyword">const</span> <span class="keywordtype">int</span> w = std::max(1, <a class="code" href="Cxx__Grammar_8h.html#b09cd568db5adadb46869d1ae0f6db69">DUMP_FIELD_WIDTH</a>-(<span class="keywordtype">int</span>)strlen(p));
<a name="l00563"></a>00563     fprintf(f, <span class="stringliteral">"%s%-*s = %04zx\n"</span>, p, w, <span class="stringliteral">"other"</span>, <a class="code" href="classSgAsmElfSymverNeededAux.html#3e331ab8db57a9107eab4929e3b48732">get_other</a>());
<a name="l00564"></a>00564     fprintf(f, <span class="stringliteral">"%s%-*s = 0x%08x\n"</span>, p, w, <span class="stringliteral">"hash"</span>, <a class="code" href="classSgAsmElfSymverNeededAux.html#614eb0b16ffca715b68c4b1cf25edb11">get_hash</a>());
<a name="l00565"></a>00565     fprintf(f, <span class="stringliteral">"%s%-*s = 0x%04x\n"</span>, p, w, <span class="stringliteral">"flags"</span>, <a class="code" href="classSgAsmElfSymverNeededAux.html#be709e6fb56091c159bcaa5593723c14">get_flags</a>());
<a name="l00566"></a>00566     fprintf(f, <span class="stringliteral">"%s%-*s = %s \n"</span>, p, w, <span class="stringliteral">"name"</span>, <a class="code" href="classSgAsmElfSymverNeededAux.html#ac7ab56493ff21b0dc909ff4ac4da235">get_name</a>()-&gt;get_string(<span class="keyword">true</span>).c_str());
<a name="l00567"></a>00567 }
<a name="l00568"></a>00568 
<a name="l00570"></a>00570 <span class="keywordtype">void</span>
<a name="l00571"></a>00571 <a class="code" href="classSgAsmElfSymverNeededAux.html#7c61f1ef051b5e5b2dced01f7589f85f">SgAsmElfSymverNeededAux::parse</a>(ByteOrder sex, <span class="keyword">const</span> ElfSymverNeededAux_disk* disk)
<a name="l00572"></a>00572 {
<a name="l00573"></a>00573     <a class="code" href="classSgAsmElfSymverNeededAux.html#b0aa5e642313ea8dc7cd71e8b4840458">p_hash</a> = <a class="code" href="classSgAsmExecutableFileFormat.html#52cc73212f6067429beb52b06b9ecc75">disk_to_host</a>(sex,disk-&gt;vna_hash);
<a name="l00574"></a>00574     <a class="code" href="classSgAsmElfSymverNeededAux.html#68a76214a24535f6324ae693226ddd38">p_flags</a>= <a class="code" href="classSgAsmExecutableFileFormat.html#52cc73212f6067429beb52b06b9ecc75">disk_to_host</a>(sex,disk-&gt;vna_flags);
<a name="l00575"></a>00575     <a class="code" href="classSgAsmElfSymverNeededAux.html#d3c63d62561f66decbd7df9a63425ac6">p_other</a>= <a class="code" href="classSgAsmExecutableFileFormat.html#52cc73212f6067429beb52b06b9ecc75">disk_to_host</a>(sex,disk-&gt;vna_other);
<a name="l00576"></a>00576 
<a name="l00577"></a>00577     <a class="code" href="rosedefs_8h.html#03b4aab6bc70ede394422915678b18df">rose_addr_t</a> name_offset  = <a class="code" href="classSgAsmExecutableFileFormat.html#52cc73212f6067429beb52b06b9ecc75">disk_to_host</a>(sex, disk-&gt;vna_name);
<a name="l00578"></a>00578     <a class="code" href="classSgAsmElfSymverNeededAux.html#ac7ab56493ff21b0dc909ff4ac4da235">get_name</a>()-&gt;<a class="code" href="classSgAsmGenericString.html#041608b8297d9f4bd334806d8f277e1b">set_string</a>(name_offset);
<a name="l00579"></a>00579 }
<a name="l00580"></a>00580 
<a name="l00582"></a>00582 <span class="keywordtype">void</span> *
<a name="l00583"></a>00583 <a class="code" href="classSgAsmElfSymverNeededAux.html#f4e1d0134e3af3863df347abf3455927">SgAsmElfSymverNeededAux::encode</a>(ByteOrder sex, ElfSymverNeededAux_disk* disk)<span class="keyword"> const</span>
<a name="l00584"></a>00584 <span class="keyword"></span>{
<a name="l00585"></a>00585     <a class="code" href="classSgAsmExecutableFileFormat.html#19727362aeeba713bc0cc666de3c3f13">host_to_disk</a>(sex,<a class="code" href="classSgAsmElfSymverNeededAux.html#b0aa5e642313ea8dc7cd71e8b4840458">p_hash</a>,&amp;disk-&gt;vna_hash);
<a name="l00586"></a>00586     <a class="code" href="classSgAsmExecutableFileFormat.html#19727362aeeba713bc0cc666de3c3f13">host_to_disk</a>(sex,<a class="code" href="classSgAsmElfSymverNeededAux.html#68a76214a24535f6324ae693226ddd38">p_flags</a>,&amp;disk-&gt;vna_flags);
<a name="l00587"></a>00587     <a class="code" href="classSgAsmExecutableFileFormat.html#19727362aeeba713bc0cc666de3c3f13">host_to_disk</a>(sex,<a class="code" href="classSgAsmElfSymverNeededAux.html#d3c63d62561f66decbd7df9a63425ac6">p_other</a>,&amp;disk-&gt;vna_other);
<a name="l00588"></a>00588 
<a name="l00589"></a>00589     <a class="code" href="rosedefs_8h.html#03b4aab6bc70ede394422915678b18df">rose_addr_t</a> name_offset = <a class="code" href="classSgAsmElfSymverNeededAux.html#75f058a055b518fcda629f257ac36507">p_name</a>-&gt;<a class="code" href="classSgAsmGenericString.html#a89c6a26f3ac3e61962059d30b3bd91b">get_offset</a>();
<a name="l00590"></a>00590     ROSE_ASSERT(name_offset!=<a class="code" href="classSgAsmGenericString.html#8f170b44372ce5149d912e62fd1f7d61">SgAsmGenericString::unallocated</a>);
<a name="l00591"></a>00591     <a class="code" href="classSgAsmExecutableFileFormat.html#19727362aeeba713bc0cc666de3c3f13">host_to_disk</a>(sex, name_offset, &amp;(disk-&gt;vna_name));
<a name="l00592"></a>00592     <span class="keywordflow">return</span> disk;
<a name="l00593"></a>00593 }
<a name="l00594"></a>00594 
<a name="l00596"></a>00596 <span class="keywordtype">void</span>
<a name="l00597"></a><a class="code" href="classSgAsmElfSymverNeededEntry.html#a1bdfa6cf0634206789460ad258a54ae">00597</a> <a class="code" href="classSgAsmElfSymverNeededEntry.html#a1bdfa6cf0634206789460ad258a54ae">SgAsmElfSymverNeededEntry::ctor</a>(<a class="code" href="classSgAsmElfSymverNeededSection.html">SgAsmElfSymverNeededSection</a> *section)
<a name="l00598"></a>00598 {
<a name="l00599"></a>00599     ROSE_ASSERT(NULL != section);  
<a name="l00600"></a>00600     ROSE_ASSERT(NULL != section-&gt;<a class="code" href="classSgAsmElfSymverNeededSection.html#5953b70abb01bd9198902ad5ed9c309c">get_entries</a>());
<a name="l00601"></a>00601     section-&gt;<a class="code" href="classSgAsmElfSymverNeededSection.html#5953b70abb01bd9198902ad5ed9c309c">get_entries</a>()-&gt;<a class="code" href="classSgAsmElfSymverNeededEntryList.html#1a4514d1e5313569cf1e2e8f5f364816">get_entries</a>().push_back(<span class="keyword">this</span>);
<a name="l00602"></a>00602 
<a name="l00603"></a>00603     ROSE_ASSERT(section-&gt;<a class="code" href="classSgAsmElfSymverNeededSection.html#5953b70abb01bd9198902ad5ed9c309c">get_entries</a>()-&gt;<a class="code" href="classSgAsmElfSymverNeededEntryList.html#1a4514d1e5313569cf1e2e8f5f364816">get_entries</a>().size()&gt;0);
<a name="l00604"></a>00604     <a class="code" href="classSgNode.html#83017efa378d75b031330739c963749d">set_parent</a>(section-&gt;<a class="code" href="classSgAsmElfSymverNeededSection.html#5953b70abb01bd9198902ad5ed9c309c">get_entries</a>());
<a name="l00605"></a>00605 
<a name="l00606"></a>00606     <a class="code" href="classSgAsmElfStringSection.html">SgAsmElfStringSection</a> *strsec = <a class="code" href="Cxx__Grammar_8h.html#64d6dfe1ab5333d310d55fa2e7cbc923">isSgAsmElfStringSection</a>(section-&gt;<a class="code" href="classSgAsmElfSection.html#44bf34de24ece59722ba6a9b3861e0cb">get_linked_section</a>());
<a name="l00607"></a>00607     ROSE_ASSERT(NULL != strsec);
<a name="l00608"></a>00608 
<a name="l00609"></a>00609     <a class="code" href="classSgAsmStoredString.html">SgAsmStoredString</a> *name = <span class="keyword">new</span> <a class="code" href="classSgAsmStoredString.html">SgAsmStoredString</a>(strsec-&gt;get_strtab(), 0);
<a name="l00610"></a>00610     <a class="code" href="classSgAsmElfSymverNeededEntry.html#4056b567dd2b384cb53f55e4fb01bc81">set_file_name</a>(name);
<a name="l00611"></a>00611     name-&gt;<a class="code" href="classSgNode.html#83017efa378d75b031330739c963749d">set_parent</a>(<span class="keyword">this</span>);
<a name="l00612"></a>00612 
<a name="l00613"></a>00613     <a class="code" href="classSgAsmElfSymverNeededEntry.html#1b602b2006be7dafeef2be6a3000e61c">p_entries</a> = <span class="keyword">new</span> <a class="code" href="classSgAsmElfSymverNeededAuxList.html">SgAsmElfSymverNeededAuxList</a>;
<a name="l00614"></a>00614     <a class="code" href="classSgAsmElfSymverNeededEntry.html#1b602b2006be7dafeef2be6a3000e61c">p_entries</a>-&gt;<a class="code" href="classSgNode.html#83017efa378d75b031330739c963749d">set_parent</a>(<span class="keyword">this</span>);
<a name="l00615"></a>00615 
<a name="l00616"></a>00616     <a class="code" href="classSgAsmElfSymverNeededEntry.html#da85e1f2eb43cefe0b7fb6c2782dfabc">p_version</a>  = 0;
<a name="l00617"></a>00617 }
<a name="l00618"></a>00618 
<a name="l00620"></a>00620 <span class="keywordtype">void</span>
<a name="l00621"></a>00621 <a class="code" href="classSgAsmElfSymverNeededEntry.html#17c3715f2b6d164cb2a6f0a05ca6f129">SgAsmElfSymverNeededEntry::parse</a>(ByteOrder sex, <span class="keyword">const</span> ElfSymverNeededEntry_disk *disk)
<a name="l00622"></a>00622 {
<a name="l00623"></a>00623     <a class="code" href="classSgAsmElfSymverNeededEntry.html#da85e1f2eb43cefe0b7fb6c2782dfabc">p_version</a>  = <a class="code" href="classSgAsmExecutableFileFormat.html#52cc73212f6067429beb52b06b9ecc75">disk_to_host</a>(sex, disk-&gt;vn_version);
<a name="l00624"></a>00624     <a class="code" href="rosedefs_8h.html#03b4aab6bc70ede394422915678b18df">rose_addr_t</a> file_offset  = <a class="code" href="classSgAsmExecutableFileFormat.html#52cc73212f6067429beb52b06b9ecc75">disk_to_host</a>(sex, disk-&gt;vn_file);
<a name="l00625"></a>00625     <a class="code" href="classSgAsmElfSymverNeededEntry.html#03ad70800b9da33c0b349c639b0a206b">get_file_name</a>()-&gt;<a class="code" href="classSgAsmGenericString.html#041608b8297d9f4bd334806d8f277e1b">set_string</a>(file_offset);
<a name="l00626"></a>00626 }
<a name="l00627"></a>00627 
<a name="l00629"></a>00629 <span class="keywordtype">void</span> *
<a name="l00630"></a>00630 <a class="code" href="classSgAsmElfSymverNeededEntry.html#9d03a4177b2aea99e5b61b5f58a38810">SgAsmElfSymverNeededEntry::encode</a>(ByteOrder sex, ElfSymverNeededEntry_disk *disk)<span class="keyword"> const</span>
<a name="l00631"></a>00631 <span class="keyword"></span>{
<a name="l00632"></a>00632     <a class="code" href="classSgAsmExecutableFileFormat.html#19727362aeeba713bc0cc666de3c3f13">host_to_disk</a>(sex, <a class="code" href="classSgAsmElfSymverNeededEntry.html#da85e1f2eb43cefe0b7fb6c2782dfabc">p_version</a>, &amp;(disk-&gt;vn_version));
<a name="l00633"></a>00633 
<a name="l00634"></a>00634     <a class="code" href="rosedefs_8h.html#03b4aab6bc70ede394422915678b18df">rose_addr_t</a> file_offset = <a class="code" href="classSgAsmElfSymverNeededEntry.html#088e33219079255757fa5865e4d349c9">p_file_name</a>-&gt;<a class="code" href="classSgAsmGenericString.html#a89c6a26f3ac3e61962059d30b3bd91b">get_offset</a>();
<a name="l00635"></a>00635     ROSE_ASSERT(file_offset!=<a class="code" href="classSgAsmGenericString.html#8f170b44372ce5149d912e62fd1f7d61">SgAsmGenericString::unallocated</a>);
<a name="l00636"></a>00636     <a class="code" href="classSgAsmExecutableFileFormat.html#19727362aeeba713bc0cc666de3c3f13">host_to_disk</a>(sex, file_offset, &amp;(disk-&gt;vn_file));
<a name="l00637"></a>00637 
<a name="l00638"></a>00638     <span class="keywordflow">return</span> disk;
<a name="l00639"></a>00639 }
<a name="l00640"></a>00640 
<a name="l00642"></a>00642 <span class="keywordtype">void</span>
<a name="l00643"></a><a class="code" href="classSgAsmElfSymverNeededEntry.html#306afb9e7a1bb4e41d036b5249dc135b">00643</a> <a class="code" href="classSgAsmElfSymverNeededEntry.html#306afb9e7a1bb4e41d036b5249dc135b">SgAsmElfSymverNeededEntry::dump</a>(FILE *f, <span class="keyword">const</span> <span class="keywordtype">char</span> *<a class="code" href="SgUnaryOp_8docs.html#c6cf1576467b95ef29f025f8e47eea437afa939f8bd773f5f7e326990b07580c">prefix</a>, ssize_t idx)<span class="keyword"> const</span>
<a name="l00644"></a>00644 <span class="keyword"></span>{
<a name="l00645"></a>00645     <span class="keywordtype">char</span> p[4096];
<a name="l00646"></a>00646     <span class="keywordflow">if</span> (idx&gt;=0) {
<a name="l00647"></a>00647         sprintf(p, <span class="stringliteral">"%sElfSymverNeededEntry[%zd]."</span>, prefix, idx);
<a name="l00648"></a>00648     } <span class="keywordflow">else</span> {
<a name="l00649"></a>00649         sprintf(p, <span class="stringliteral">"%sElfSymverNeededEntry."</span>, prefix);
<a name="l00650"></a>00650     }
<a name="l00651"></a>00651     <span class="keyword">const</span> <span class="keywordtype">int</span> w = std::max(1, <a class="code" href="Cxx__Grammar_8h.html#b09cd568db5adadb46869d1ae0f6db69">DUMP_FIELD_WIDTH</a>-(<span class="keywordtype">int</span>)strlen(p));
<a name="l00652"></a>00652 
<a name="l00653"></a>00653     <span class="comment">/* compact one-line-per-entry format */</span>
<a name="l00654"></a>00654     <span class="keywordflow">if</span> (0==idx)
<a name="l00655"></a>00655         fprintf(f, <span class="stringliteral">"%s%-*s   %-8s %-22s %6s %10s %6s %s\n"</span>, p, w, <span class="stringliteral">""</span>, <span class="stringliteral">"Version"</span>, <span class="stringliteral">"File"</span>, <span class="stringliteral">"Other"</span>, <span class="stringliteral">"Hash"</span>, <span class="stringliteral">"Flags"</span>, <span class="stringliteral">"Name"</span>);
<a name="l00656"></a>00656     fprintf(f,   <span class="stringliteral">"%s%-*s =   0x%04zx %s"</span>, p, w, <span class="stringliteral">""</span>, <a class="code" href="classSgAsmElfSymverNeededEntry.html#da85e1f2eb43cefe0b7fb6c2782dfabc">p_version</a>, <a class="code" href="classSgAsmElfSymverNeededEntry.html#03ad70800b9da33c0b349c639b0a206b">get_file_name</a>()-&gt;get_string(<span class="keyword">true</span>).c_str());
<a name="l00657"></a>00657     <span class="keyword">const</span> <a class="code" href="Cxx__Grammar_8h.html#20584360eb66674735d682356e9b53e0">SgAsmElfSymverNeededAuxPtrList</a> &amp;entries=<a class="code" href="classSgAsmElfSymverNeededEntry.html#b48223a3ad45eec07c21d9f5a5fc7bbc">get_entries</a>()-&gt;<a class="code" href="classSgAsmElfSymverNeededAuxList.html#dc940a2067ea4ff096ba4e450c1cd2c8">get_entries</a>();
<a name="l00658"></a>00658     <span class="keywordflow">if</span> (entries.empty()) {
<a name="l00659"></a>00659         fprintf(f, <span class="stringliteral">"&lt;no auxiliary entries&gt;\n"</span>);
<a name="l00660"></a>00660     } <span class="keywordflow">else</span> {
<a name="l00661"></a>00661         fprintf(f, <span class="stringliteral">"\n"</span>);
<a name="l00662"></a>00662     }
<a name="l00663"></a>00663     <span class="keywordflow">for</span> (size_t i=0; i&lt;entries.size(); ++i) {
<a name="l00664"></a>00664         <a class="code" href="classSgAsmElfSymverNeededAux.html">SgAsmElfSymverNeededAux</a>* aux = entries[i];
<a name="l00665"></a>00665         <span class="keywordtype">char</span> auxname[32];
<a name="l00666"></a>00666         sprintf(auxname, <span class="stringliteral">"aux[%zu]"</span>, i);
<a name="l00667"></a>00667         fprintf(f,   <span class="stringliteral">"%s%-*s =                                 0x%04zx 0x%08x 0x%04x %s\n"</span>, p, w, auxname, 
<a name="l00668"></a>00668                 aux-&gt;get_other(), aux-&gt;get_hash(), aux-&gt;get_flags(), aux-&gt;get_name()-&gt;get_string(<span class="keyword">true</span>).c_str());
<a name="l00669"></a>00669     }
<a name="l00670"></a>00670     fprintf(f, <span class="stringliteral">"\n"</span>);
<a name="l00671"></a>00671 }
<a name="l00672"></a>00672 
<a name="l00674"></a>00674 <span class="keywordtype">void</span>
<a name="l00675"></a><a class="code" href="classSgAsmElfSymverNeededSection.html#7fda980597d547ce17652c98d4e24a54">00675</a> <a class="code" href="classSgAsmElfSection.html#777c5e1c2ac65fd5378fdf08364acf85">SgAsmElfSymverNeededSection::ctor</a>(<a class="code" href="classSgAsmElfStringSection.html">SgAsmElfStringSection</a> *strings)
<a name="l00676"></a>00676 {
<a name="l00677"></a>00677     <a class="code" href="classSgAsmElfSymverNeededSection.html#2281422c39e6e2d72563254052f2c3d6">p_entries</a> = <span class="keyword">new</span> <a class="code" href="classSgAsmElfSymverNeededEntryList.html">SgAsmElfSymverNeededEntryList</a>;
<a name="l00678"></a>00678     <a class="code" href="classSgAsmElfSymverNeededSection.html#2281422c39e6e2d72563254052f2c3d6">p_entries</a>-&gt;<a class="code" href="classSgNode.html#83017efa378d75b031330739c963749d">set_parent</a>(<span class="keyword">this</span>);
<a name="l00679"></a>00679   
<a name="l00680"></a>00680     ROSE_ASSERT(NULL != strings);
<a name="l00681"></a>00681     <a class="code" href="classSgAsmElfSection.html#19ea328fdfe31bd968b930c88a49d07b">p_linked_section</a> = strings;
<a name="l00682"></a>00682 }
<a name="l00683"></a>00683 
<a name="l00693"></a>00693 <a class="code" href="classSgAsmElfSymverNeededSection.html">SgAsmElfSymverNeededSection</a> *
<a name="l00694"></a><a class="code" href="classSgAsmElfSymverNeededSection.html#e8990e15905527c61556f71b555c9174">00694</a> <a class="code" href="classSgAsmElfSymverNeededSection.html#e8990e15905527c61556f71b555c9174">SgAsmElfSymverNeededSection::parse</a>()
<a name="l00695"></a>00695 {
<a name="l00696"></a>00696     <a class="code" href="classSgAsmGenericSection.html#06e6f2a4c28be5858d6a0b92573908d7">SgAsmElfSection::parse</a>();
<a name="l00697"></a>00697   
<a name="l00698"></a>00698     <a class="code" href="classSgAsmElfFileHeader.html">SgAsmElfFileHeader</a> *fhdr = <a class="code" href="classSgAsmElfSection.html#a430cf4e1e6376e12f3b5dc8363099c4">get_elf_header</a>();
<a name="l00699"></a>00699     ROSE_ASSERT(NULL!=fhdr);
<a name="l00700"></a>00700     <a class="code" href="classSgAsmElfSectionTableEntry.html">SgAsmElfSectionTableEntry</a> *shdr = <a class="code" href="classSgAsmElfSection.html#9ef7cc77be330cde6c32ef598e312971">get_section_entry</a>();
<a name="l00701"></a>00701     ROSE_ASSERT(NULL!=shdr);
<a name="l00702"></a>00702   
<a name="l00703"></a>00703     <span class="comment">//size_t struct_size=sizeof(SgAsmElfSymverNeededEntry::ElfSymverNeededEntry_disk);</span>
<a name="l00704"></a>00704   
<a name="l00705"></a>00705     <a class="code" href="rosedefs_8h.html#03b4aab6bc70ede394422915678b18df">rose_addr_t</a> entry_addr=0;
<a name="l00706"></a>00706 
<a name="l00707"></a>00707     <a class="code" href="classSgAsmExecutableFileFormat.html#9f34e9e7666815ddeee9be5df5573a80">ByteOrder</a> sex=fhdr-&gt;<a class="code" href="classSgAsmGenericHeader.html#3269e8ea6c30182607e9d4ee79fc05a8">get_sex</a>();
<a name="l00708"></a>00708     <span class="comment">/* Parse each entry*/</span>
<a name="l00709"></a>00709     <span class="keywordflow">while</span> (entry_addr &lt; this-&gt;<a class="code" href="classSgAsmGenericSection.html#4c0fa714119712ac19d50340d62ab8f1">get_size</a>()) {
<a name="l00710"></a>00710         <a class="code" href="classSgAsmElfSymverNeededEntry.html">SgAsmElfSymverNeededEntry</a> *entry=<span class="keyword">new</span> <a class="code" href="classSgAsmElfSymverNeededEntry.html">SgAsmElfSymverNeededEntry</a>(<span class="keyword">this</span>); <span class="comment">/*adds SymverNeededEntry to this*/</span>
<a name="l00711"></a>00711         <a class="code" href="structSgAsmElfSymverNeededEntry_1_1ElfSymverNeededEntry__disk.html">SgAsmElfSymverNeededEntry::ElfSymverNeededEntry_disk</a> entryDisk;
<a name="l00712"></a>00712         <a class="code" href="classSgAsmGenericSection.html#e7516833466da3f886fafd0b1bc1f803">read_content_local</a>(entry_addr, &amp;entryDisk, <span class="keyword">sizeof</span>(entryDisk));
<a name="l00713"></a>00713         entry-&gt;<a class="code" href="classSgAsmElfSymverNeededEntry.html#17c3715f2b6d164cb2a6f0a05ca6f129">parse</a>(sex, &amp;entryDisk);
<a name="l00714"></a>00714 
<a name="l00715"></a>00715         <span class="comment">/* These are relative to the start of this entry - i.e. entry_addr */</span>
<a name="l00716"></a>00716         size_t num_aux = <a class="code" href="classSgAsmExecutableFileFormat.html#52cc73212f6067429beb52b06b9ecc75">disk_to_host</a>(sex,entryDisk.vn_cnt);
<a name="l00717"></a>00717         size_t first_aux = <a class="code" href="classSgAsmExecutableFileFormat.html#52cc73212f6067429beb52b06b9ecc75">disk_to_host</a>(sex,entryDisk.vn_aux);
<a name="l00718"></a>00718         size_t next_entry = <a class="code" href="classSgAsmExecutableFileFormat.html#52cc73212f6067429beb52b06b9ecc75">disk_to_host</a>(sex,entryDisk.vn_next);  
<a name="l00719"></a>00719 
<a name="l00720"></a>00720         <a class="code" href="rosedefs_8h.html#03b4aab6bc70ede394422915678b18df">rose_addr_t</a> aux_addr=entry_addr+first_aux;
<a name="l00721"></a>00721         <span class="keywordflow">for</span> (size_t i=0; i &lt; num_aux; ++i) {
<a name="l00722"></a>00722             <a class="code" href="classSgAsmElfSymverNeededAux.html">SgAsmElfSymverNeededAux</a> *aux=<span class="keyword">new</span> <a class="code" href="classSgAsmElfSymverNeededAux.html">SgAsmElfSymverNeededAux</a>(entry,<span class="keyword">this</span>); <span class="comment">/*adds SymverNeededAux to this entry*/</span>
<a name="l00723"></a>00723             <a class="code" href="structSgAsmElfSymverNeededAux_1_1ElfSymverNeededAux__disk.html">SgAsmElfSymverNeededAux::ElfSymverNeededAux_disk</a> auxDisk;
<a name="l00724"></a>00724             <a class="code" href="classSgAsmGenericSection.html#e7516833466da3f886fafd0b1bc1f803">read_content_local</a>(aux_addr, &amp;auxDisk, <span class="keyword">sizeof</span>(auxDisk));
<a name="l00725"></a>00725             aux-&gt;parse(sex, &amp;auxDisk);
<a name="l00726"></a>00726 
<a name="l00727"></a>00727             size_t next_aux = <a class="code" href="classSgAsmExecutableFileFormat.html#52cc73212f6067429beb52b06b9ecc75">disk_to_host</a>(sex,auxDisk.vna_next);      
<a name="l00728"></a>00728             <span class="keywordflow">if</span> (next_aux == 0)
<a name="l00729"></a>00729                 <span class="keywordflow">break</span>;
<a name="l00730"></a>00730             aux_addr+=next_aux;
<a name="l00731"></a>00731         }
<a name="l00732"></a>00732 
<a name="l00733"></a>00733         <span class="keywordflow">if</span>(next_entry == 0)
<a name="l00734"></a>00734             <span class="keywordflow">break</span>;
<a name="l00735"></a>00735         entry_addr += next_entry;
<a name="l00736"></a>00736     }
<a name="l00737"></a>00737     <span class="keywordflow">return</span> <span class="keyword">this</span>;
<a name="l00738"></a>00738 }
<a name="l00739"></a>00739 
<a name="l00741"></a>00741 <a class="code" href="rosedefs_8h.html#03b4aab6bc70ede394422915678b18df">rose_addr_t</a>
<a name="l00742"></a><a class="code" href="classSgAsmElfSymverNeededSection.html#4873ae3e1722fe767f1b50080b2910a1">00742</a> <a class="code" href="classSgAsmElfSymverNeededSection.html#4873ae3e1722fe767f1b50080b2910a1">SgAsmElfSymverNeededSection::calculate_sizes</a>(size_t *entsize, size_t *required, size_t *optional, size_t *entcount)<span class="keyword"> const</span>
<a name="l00743"></a>00743 <span class="keyword"></span>{
<a name="l00744"></a>00744     size_t struct_size = <span class="keyword">sizeof</span>(<a class="code" href="structSgAsmElfSymverNeededEntry_1_1ElfSymverNeededEntry__disk.html">SgAsmElfSymverNeededEntry::ElfSymverNeededEntry_disk</a>);
<a name="l00745"></a>00745     size_t aux_size = <span class="keyword">sizeof</span>(<a class="code" href="structSgAsmElfSymverNeededAux_1_1ElfSymverNeededAux__disk.html">SgAsmElfSymverNeededAux::ElfSymverNeededAux_disk</a>);
<a name="l00746"></a>00746 
<a name="l00747"></a>00747     size_t extra_size = 0;
<a name="l00748"></a>00748     size_t entry_size = 0;
<a name="l00749"></a>00749     size_t nentries = <a class="code" href="classSgAsmElfSymverNeededSection.html#5953b70abb01bd9198902ad5ed9c309c">get_entries</a>()-&gt;<a class="code" href="classSgAsmElfSymverNeededEntryList.html#1a4514d1e5313569cf1e2e8f5f364816">get_entries</a>().size();
<a name="l00750"></a>00750 
<a name="l00751"></a>00751     size_t total_size=0;
<a name="l00752"></a>00752     <span class="comment">/* Entire entry should be at least large enough for the required part. */</span>
<a name="l00753"></a>00753     entry_size = struct_size;
<a name="l00754"></a>00754   
<a name="l00755"></a>00755     <span class="comment">/* Each entry has a list of 'aux' structures */</span>
<a name="l00756"></a>00756     <span class="keyword">const</span> <a class="code" href="Cxx__Grammar_8h.html#3009ce39f64a9ecbc6a7ae054a163b26">SgAsmElfSymverNeededEntryPtrList</a> &amp;entries = <a class="code" href="classSgAsmElfSymverNeededSection.html#5953b70abb01bd9198902ad5ed9c309c">get_entries</a>()-&gt;<a class="code" href="classSgAsmElfSymverNeededEntryList.html#1a4514d1e5313569cf1e2e8f5f364816">get_entries</a>();
<a name="l00757"></a>00757     <span class="keywordflow">for</span> (size_t i=0; i&lt;nentries; ++i) {
<a name="l00758"></a>00758         size_t numAux = entries[i]-&gt;<a class="code" href="classSgAsmElfSymverNeededSection.html#5953b70abb01bd9198902ad5ed9c309c">get_entries</a>()-&gt;<a class="code" href="classSgAsmElfSymverNeededSection.html#5953b70abb01bd9198902ad5ed9c309c">get_entries</a>().size();
<a name="l00759"></a>00759         extra_size = std::max(extra_size, numAux * aux_size);
<a name="l00760"></a>00760         total_size += (struct_size + (numAux* aux_size));
<a name="l00761"></a>00761     }
<a name="l00762"></a>00762     <span class="comment">/* Note - we could try to reach into the dynamic section for nentries */</span>
<a name="l00763"></a>00763   
<a name="l00764"></a>00764     <span class="comment">/* Return values */</span>
<a name="l00765"></a>00765     <span class="keywordflow">if</span> (entsize)
<a name="l00766"></a>00766         *entsize = entry_size;
<a name="l00767"></a>00767     <span class="keywordflow">if</span> (required)
<a name="l00768"></a>00768         *required = struct_size;
<a name="l00769"></a>00769     <span class="keywordflow">if</span> (optional)
<a name="l00770"></a>00770         *optional = extra_size;
<a name="l00771"></a>00771     <span class="keywordflow">if</span> (entcount)
<a name="l00772"></a>00772         *entcount = nentries;
<a name="l00773"></a>00773     <span class="keywordflow">return</span> total_size;
<a name="l00774"></a>00774 }
<a name="l00775"></a>00775 
<a name="l00777"></a>00777 <span class="keywordtype">void</span>
<a name="l00778"></a><a class="code" href="classSgAsmElfSymverNeededSection.html#9caa236e0a41e7526fa1384207e00c03">00778</a> <a class="code" href="classSgAsmElfSymverNeededSection.html#9caa236e0a41e7526fa1384207e00c03">SgAsmElfSymverNeededSection::unparse</a>(std::ostream &amp;f)<span class="keyword"> const</span>
<a name="l00779"></a>00779 <span class="keyword"></span>{
<a name="l00780"></a>00780     <a class="code" href="classSgAsmElfFileHeader.html">SgAsmElfFileHeader</a> *fhdr = <a class="code" href="classSgAsmElfSection.html#a430cf4e1e6376e12f3b5dc8363099c4">get_elf_header</a>();
<a name="l00781"></a>00781     ROSE_ASSERT(NULL != fhdr);
<a name="l00782"></a>00782     <a class="code" href="classSgAsmExecutableFileFormat.html#9f34e9e7666815ddeee9be5df5573a80">ByteOrder</a> sex = fhdr-&gt;<a class="code" href="classSgAsmGenericHeader.html#3269e8ea6c30182607e9d4ee79fc05a8">get_sex</a>();
<a name="l00783"></a>00783     size_t nentries;
<a name="l00784"></a>00784     <a class="code" href="classSgAsmElfSymverNeededSection.html#4873ae3e1722fe767f1b50080b2910a1">calculate_sizes</a>(NULL,NULL,NULL,&amp;nentries);
<a name="l00785"></a>00785 
<a name="l00786"></a>00786     <span class="comment">/* Adjust the entry size stored in the ELF Section Table */</span>
<a name="l00787"></a>00787     <a class="code" href="classSgAsmElfSection.html#9ef7cc77be330cde6c32ef598e312971">get_section_entry</a>()-&gt;<a class="code" href="classSgAsmElfSectionTableEntry.html#d4f8b40b80fd40a7ce026db601e85911">set_sh_entsize</a>(0); <span class="comment">/* This doesn't have consistently sized entries, zero it */</span>
<a name="l00788"></a>00788   
<a name="l00789"></a>00789     <span class="comment">/* Write each entry's required part followed by the optional part */</span>
<a name="l00790"></a>00790     <span class="comment">/* Parse each entry*/</span>
<a name="l00791"></a>00791     <a class="code" href="rosedefs_8h.html#03b4aab6bc70ede394422915678b18df">rose_addr_t</a> entry_addr=0; <span class="comment">/* as offset from section */</span>
<a name="l00792"></a>00792 
<a name="l00793"></a>00793     <span class="keywordflow">for</span> (size_t ent=0; ent &lt; nentries; ++ent) {
<a name="l00794"></a>00794         <a class="code" href="classSgAsmElfSymverNeededEntry.html">SgAsmElfSymverNeededEntry</a> *entry=<a class="code" href="classSgAsmElfSymverNeededSection.html#5953b70abb01bd9198902ad5ed9c309c">get_entries</a>()-&gt;<a class="code" href="classSgAsmElfSymverNeededSection.html#5953b70abb01bd9198902ad5ed9c309c">get_entries</a>()[ent];
<a name="l00795"></a>00795         <a class="code" href="structSgAsmElfSymverNeededEntry_1_1ElfSymverNeededEntry__disk.html">SgAsmElfSymverNeededEntry::ElfSymverNeededEntry_disk</a> entryDisk;
<a name="l00796"></a>00796         entry-&gt;encode(sex, &amp;entryDisk);
<a name="l00797"></a>00797         <span class="keyword">const</span> size_t entry_size=<span class="keyword">sizeof</span>(<a class="code" href="structSgAsmElfSymverNeededEntry_1_1ElfSymverNeededEntry__disk.html">SgAsmElfSymverNeededEntry::ElfSymverNeededEntry_disk</a>);
<a name="l00798"></a>00798         <span class="keyword">const</span> size_t aux_size=<span class="keyword">sizeof</span>(<a class="code" href="structSgAsmElfSymverNeededAux_1_1ElfSymverNeededAux__disk.html">SgAsmElfSymverNeededAux::ElfSymverNeededAux_disk</a>);
<a name="l00799"></a>00799     
<a name="l00800"></a>00800         <span class="keyword">const</span> <a class="code" href="Cxx__Grammar_8h.html#20584360eb66674735d682356e9b53e0">SgAsmElfSymverNeededAuxPtrList</a>&amp; auxes = entry-&gt;get_entries()-&gt;get_entries();
<a name="l00801"></a>00801         size_t num_aux = auxes.size();
<a name="l00802"></a>00802         size_t first_aux = entry_size; <span class="comment">/* we always stick Aux's just after Entry */</span>
<a name="l00803"></a>00803         size_t next_entry = first_aux + ( num_aux * aux_size );
<a name="l00804"></a>00804         <span class="keywordflow">if</span> (nentries -1 == ent) {
<a name="l00805"></a>00805             next_entry=0; <span class="comment">/* final entry: next is null (0) */</span>
<a name="l00806"></a>00806         }
<a name="l00807"></a>00807 
<a name="l00808"></a>00808         <a class="code" href="classSgAsmExecutableFileFormat.html#19727362aeeba713bc0cc666de3c3f13">host_to_disk</a>(sex,    num_aux, &amp;entryDisk.<a class="code" href="structSgAsmElfSymverNeededEntry_1_1ElfSymverNeededEntry__disk.html#49fdd41c906bcc68ccd9dd35234a4552">vn_cnt</a>);
<a name="l00809"></a>00809         <a class="code" href="classSgAsmExecutableFileFormat.html#19727362aeeba713bc0cc666de3c3f13">host_to_disk</a>(sex,  first_aux, &amp;entryDisk.<a class="code" href="structSgAsmElfSymverNeededEntry_1_1ElfSymverNeededEntry__disk.html#54cf258135f1423c68ec4a4198748706">vn_aux</a>);
<a name="l00810"></a>00810         <a class="code" href="classSgAsmExecutableFileFormat.html#19727362aeeba713bc0cc666de3c3f13">host_to_disk</a>(sex, next_entry, &amp;entryDisk.<a class="code" href="structSgAsmElfSymverNeededEntry_1_1ElfSymverNeededEntry__disk.html#7be32e01300143e1bb5364b9078355d1">vn_next</a>);
<a name="l00811"></a>00811 
<a name="l00812"></a>00812         <a class="code" href="classSgAsmGenericSection.html#8e0601bfbe531ff8973c2458543aaad6">write</a>(f, entry_addr, entry_size,&amp;entryDisk);
<a name="l00813"></a>00813 
<a name="l00814"></a>00814         <a class="code" href="rosedefs_8h.html#03b4aab6bc70ede394422915678b18df">rose_addr_t</a> aux_addr=entry_addr+first_aux;
<a name="l00815"></a>00815         <span class="keywordflow">for</span> (size_t i=0; i &lt; num_aux; ++i) {
<a name="l00816"></a>00816             <a class="code" href="classSgAsmElfSymverNeededAux.html">SgAsmElfSymverNeededAux</a> *aux=auxes[i];
<a name="l00817"></a>00817 
<a name="l00818"></a>00818             <a class="code" href="structSgAsmElfSymverNeededAux_1_1ElfSymverNeededAux__disk.html">SgAsmElfSymverNeededAux::ElfSymverNeededAux_disk</a> auxDisk;
<a name="l00819"></a>00819             aux-&gt;encode(sex, &amp;auxDisk);
<a name="l00820"></a>00820       
<a name="l00821"></a>00821             size_t next_aux = aux_size;<span class="comment">/* all auxes are contigious, so the next one is always just 8 */</span>
<a name="l00822"></a>00822             <span class="keywordflow">if</span> (num_aux-1 == i) {
<a name="l00823"></a>00823                 next_aux=0; <span class="comment">/* ... unless it is the final aux, then the next is null (0) */</span>
<a name="l00824"></a>00824             }
<a name="l00825"></a>00825             <a class="code" href="classSgAsmExecutableFileFormat.html#19727362aeeba713bc0cc666de3c3f13">host_to_disk</a>(sex,next_aux, &amp;auxDisk.<a class="code" href="structSgAsmElfSymverNeededAux_1_1ElfSymverNeededAux__disk.html#26157bc1ec2438e09dedecc18597d50d">vna_next</a>);
<a name="l00826"></a>00826 
<a name="l00827"></a>00827             <a class="code" href="classSgAsmGenericSection.html#8e0601bfbe531ff8973c2458543aaad6">write</a>(f,aux_addr,aux_size, &amp;auxDisk);
<a name="l00828"></a>00828             aux_addr+=next_aux;
<a name="l00829"></a>00829         }
<a name="l00830"></a>00830         entry_addr += next_entry;
<a name="l00831"></a>00831     }
<a name="l00832"></a>00832     <a class="code" href="classSgAsmGenericSection.html#5093c3cf64be87688030517c67370dae">unparse_holes</a>(f);
<a name="l00833"></a>00833 }
<a name="l00834"></a>00834 
<a name="l00836"></a>00836 <span class="keywordtype">void</span>
<a name="l00837"></a><a class="code" href="classSgAsmElfSymverNeededSection.html#5db7c87ad1c9b8b9cb87f748abb01131">00837</a> <a class="code" href="classSgAsmElfSymverNeededSection.html#5db7c87ad1c9b8b9cb87f748abb01131">SgAsmElfSymverNeededSection::dump</a>(FILE *f, <span class="keyword">const</span> <span class="keywordtype">char</span> *<a class="code" href="SgUnaryOp_8docs.html#c6cf1576467b95ef29f025f8e47eea437afa939f8bd773f5f7e326990b07580c">prefix</a>, ssize_t idx)<span class="keyword"> const</span>
<a name="l00838"></a>00838 <span class="keyword"></span>{
<a name="l00839"></a>00839     <span class="keywordtype">char</span> p[4096];
<a name="l00840"></a>00840     <span class="keywordflow">if</span> (idx&gt;=0) {
<a name="l00841"></a>00841         sprintf(p, <span class="stringliteral">"%sElfSymverNeededSection[%zd]."</span>, prefix, idx);
<a name="l00842"></a>00842     } <span class="keywordflow">else</span> {
<a name="l00843"></a>00843         sprintf(p, <span class="stringliteral">"%sElfSymverNeededSection."</span>, prefix);
<a name="l00844"></a>00844     }
<a name="l00845"></a>00845     <span class="keyword">const</span> <span class="keywordtype">int</span> w = std::max(1, <a class="code" href="Cxx__Grammar_8h.html#b09cd568db5adadb46869d1ae0f6db69">DUMP_FIELD_WIDTH</a>-(<span class="keywordtype">int</span>)strlen(p));
<a name="l00846"></a>00846   
<a name="l00847"></a>00847     <a class="code" href="classSgAsmElfSection.html#4fd8ef83c67a6b432974fab51f4122b7">SgAsmElfSection::dump</a>(f, p, -1);
<a name="l00848"></a>00848     fprintf(f, <span class="stringliteral">"%s%-*s = %zu entries\n"</span>, p, w, <span class="stringliteral">"ElfSymverNeeded.size"</span>, <a class="code" href="classSgAsmElfSymverNeededSection.html#2281422c39e6e2d72563254052f2c3d6">p_entries</a>-&gt;<a class="code" href="classSgAsmElfSymverNeededEntryList.html#1a4514d1e5313569cf1e2e8f5f364816">get_entries</a>().size());
<a name="l00849"></a>00849     <span class="keywordflow">for</span> (size_t i = 0; i &lt; <a class="code" href="classSgAsmElfSymverNeededSection.html#2281422c39e6e2d72563254052f2c3d6">p_entries</a>-&gt;<a class="code" href="classSgAsmElfSymverNeededEntryList.html#1a4514d1e5313569cf1e2e8f5f364816">get_entries</a>().size(); i++) {
<a name="l00850"></a>00850         <a class="code" href="classSgAsmElfSymverNeededSection.html#2281422c39e6e2d72563254052f2c3d6">p_entries</a>-&gt;<a class="code" href="classSgAsmElfSymverNeededEntryList.html#1a4514d1e5313569cf1e2e8f5f364816">get_entries</a>()[i]-&gt;dump(f, p, i);
<a name="l00851"></a>00851     }
<a name="l00852"></a>00852   
<a name="l00853"></a>00853     <span class="keywordflow">if</span> (<a class="code" href="classSgAsmElfSymverNeededSection.html#1f52cd92cf08cfb8b43149d838e119b1">variantT</a>() == <a class="code" href="Cxx__Grammar_8h.html#adcb00b11de1167a498bced81d3e3464abb8bd8fac6a1a06ac507d2e6ad411e9">V_SgAsmElfSymverNeededSection</a>) <span class="comment">/*unless a base class*/</span>
<a name="l00854"></a>00854         <a class="code" href="classSgAsmExecutableFileFormat.html#548279193ba7eec2ae9ff2419c9e4d62">hexdump</a>(f, 0, std::string(p)+<span class="stringliteral">"data at "</span>, <a class="code" href="classSgAsmGenericSection.html#96573fffe8f4f825c56ead24cc89a474">p_data</a>);
<a name="l00855"></a>00855 }
</pre></div><hr size="1"><address style="align: right;"><small>Generated on 20 Jan 2013 for ROSE by&nbsp;
<a href="http://www.doxygen.org/index.html">
<img src="doxygen.png" alt="doxygen" align="middle" border="0"></a> 1.4.7 </small></address>
</body>
</html>
