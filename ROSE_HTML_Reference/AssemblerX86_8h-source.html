<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head><meta http-equiv="Content-Type" content="text/html;charset=iso-8859-1">
<title>ROSE: AssemblerX86.h Source File</title>
<link href="doxygen.css" rel="stylesheet" type="text/css">
<link href="tabs.css" rel="stylesheet" type="text/css">
</head><body>
<!-- Generated by Doxygen 1.4.7 -->
<div class="tabs">
  <ul>
    <li><a href="main.html"><span>Main&nbsp;Page</span></a></li>
    <li><a href="modules.html"><span>Modules</span></a></li>
    <li><a href="namespaces.html"><span>Namespaces</span></a></li>
    <li><a href="annotated.html"><span>Classes</span></a></li>
    <li id="current"><a href="files.html"><span>Files</span></a></li>
    <li><a href="pages.html"><span>Related&nbsp;Pages</span></a></li>
    <li><a href="examples.html"><span>Examples</span></a></li>
    <li>
      <form action="search.php" method="get">
        <table cellspacing="0" cellpadding="0" border="0">
          <tr>
            <td><label>&nbsp;<u>S</u>earch&nbsp;for&nbsp;</label></td>
            <td><input type="text" name="query" value="" size="20" accesskey="s"/></td>
          </tr>
        </table>
      </form>
    </li>
  </ul></div>
<div class="tabs">
  <ul>
    <li><a href="files.html"><span>File&nbsp;List</span></a></li>
    <li><a href="globals.html"><span>File&nbsp;Members</span></a></li>
  </ul></div>
<h1>AssemblerX86.h</h1><a href="AssemblerX86_8h.html">Go to the documentation of this file.</a><div class="fragment"><pre class="fragment"><a name="l00001"></a>00001 <span class="comment">/* Assembly specific to the x86 architecture. */</span>
<a name="l00002"></a>00002 
<a name="l00003"></a>00003 <span class="preprocessor">#ifndef ROSE_ASSEMBLER_X86_H</span>
<a name="l00004"></a>00004 <span class="preprocessor"></span><span class="preprocessor">#define ROSE_ASSEMBLER_X86_H</span>
<a name="l00005"></a>00005 <span class="preprocessor"></span>
<a name="l00006"></a>00006 <span class="preprocessor">#include "<a class="code" href="Assembler_8h.html">Assembler.h</a>"</span>
<a name="l00007"></a>00007 
<a name="l00008"></a>00008 <span class="comment">//#include "sage3.h"</span>
<a name="l00009"></a>00009 
<a name="l00026"></a><a class="code" href="classAssemblerX86.html">00026</a> <span class="keyword">class </span><a class="code" href="classAssemblerX86.html">AssemblerX86</a>: <span class="keyword">public</span> <a class="code" href="classAssembler.html">Assembler</a> {
<a name="l00027"></a>00027 <span class="keyword">public</span>:
<a name="l00028"></a><a class="code" href="classAssemblerX86.html#9c72c73145670f7bc26554d27fe0089a">00028</a>     <a class="code" href="classAssemblerX86.html#9c72c73145670f7bc26554d27fe0089a">AssemblerX86</a>()
<a name="l00029"></a>00029         : <a class="code" href="classAssemblerX86.html#824c9d859366886fce48d0d44596356c">honor_operand_types</a>(false) {
<a name="l00030"></a>00030         <span class="keywordflow">if</span> (<a class="code" href="classAssemblerX86.html#0cd86fcbed61e176d8dd7292c392fa47">defns</a>.size()==0)
<a name="l00031"></a>00031             <a class="code" href="classAssemblerX86.html#085fe2ae49db4cb901762d2dd8cd746b">initAssemblyRules</a>();
<a name="l00032"></a>00032     }
<a name="l00033"></a>00033 
<a name="l00034"></a><a class="code" href="classAssemblerX86.html#f6e0a764d48ac730c9c040718c80fb20">00034</a>     <span class="keyword">virtual</span> <a class="code" href="classAssemblerX86.html#f6e0a764d48ac730c9c040718c80fb20">~AssemblerX86</a>() {}
<a name="l00035"></a>00035 
<a name="l00037"></a>00037     <span class="keyword">virtual</span> <a class="code" href="Cxx__Grammar_8h.html#4f57773a5fc8d0d005f7553cd47cbc4e">SgUnsignedCharList</a> <a class="code" href="classAssemblerX86.html#21738f8609dc526f22b71aac954b339e">assembleOne</a>(<a class="code" href="classSgAsmInstruction.html">SgAsmInstruction</a>*);
<a name="l00038"></a>00038     
<a name="l00044"></a><a class="code" href="classAssemblerX86.html#9176b9751f71687b1a39681b5da0bf7b">00044</a>     <span class="keywordtype">void</span> <a class="code" href="classAssemblerX86.html#9176b9751f71687b1a39681b5da0bf7b">set_honor_operand_types</a>(<span class="keywordtype">bool</span> b) {
<a name="l00045"></a>00045         <a class="code" href="classAssemblerX86.html#824c9d859366886fce48d0d44596356c">honor_operand_types</a> = b;
<a name="l00046"></a>00046     }
<a name="l00047"></a>00047 
<a name="l00050"></a><a class="code" href="classAssemblerX86.html#6a954b96acade968338b8c7286b86dfb">00050</a>     <span class="keywordtype">bool</span> <a class="code" href="classAssemblerX86.html#6a954b96acade968338b8c7286b86dfb">get_honor_operand_types</a>()<span class="keyword"> const </span>{
<a name="l00051"></a>00051         <span class="keywordflow">return</span> <a class="code" href="classAssemblerX86.html#824c9d859366886fce48d0d44596356c">honor_operand_types</a>;
<a name="l00052"></a>00052     }
<a name="l00053"></a>00053 
<a name="l00055"></a>00055     <span class="keyword">virtual</span> <a class="code" href="Cxx__Grammar_8h.html#4f57773a5fc8d0d005f7553cd47cbc4e">SgUnsignedCharList</a> <a class="code" href="classAssemblerX86.html#d19100313dc1721732b0d1d19e03d4e3">assembleProgram</a>(<span class="keyword">const</span> std::string &amp;source);
<a name="l00056"></a>00056 
<a name="l00057"></a>00057     <span class="comment">/*========================================================================================================================</span>
<a name="l00058"></a>00058 <span class="comment">     * Members for defining instructions.</span>
<a name="l00059"></a>00059 <span class="comment">     *========================================================================================================================*/</span>
<a name="l00060"></a>00060 <span class="keyword">private</span>:
<a name="l00061"></a>00061     <span class="comment">/* These bit masks specify how the opcode part of the encoding is generated. The base opcode bytes are specified with</span>
<a name="l00062"></a>00062 <span class="comment">     * a 64-bit value so that up to eight bytes of opcode can be specified.  The bytes generated come from the 64-bit opcode</span>
<a name="l00063"></a>00063 <span class="comment">     * value in big-endian order but without leading zero bytes. If the 64-bit opcode is zero then a single zero byte is</span>
<a name="l00064"></a>00064 <span class="comment">     * generated.  For instance, the MONITOR instruction has an opcode of 0x0f01c8, generating the encoding 0x0f, 0x01, 0xc8. */</span>
<a name="l00065"></a>00065     
<a name="l00069"></a><a class="code" href="classAssemblerX86.html#5f13f0a7625ffa5f488cd69c6cd75136">00069</a>     <span class="keyword">static</span> <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <a class="code" href="classAssemblerX86.html#5f13f0a7625ffa5f488cd69c6cd75136">od_e_mask</a>   = 0x00000070;                <span class="comment">/* mask for numeric value (n) part of En field. */</span>
<a name="l00070"></a><a class="code" href="classAssemblerX86.html#0c11d2e51fd7bd977daa6db5da6d22a4">00070</a>     <span class="keyword">static</span> <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <a class="code" href="classAssemblerX86.html#0c11d2e51fd7bd977daa6db5da6d22a4">od_e_pres</a>   = 0x00000080;                <span class="comment">/* bit set if En modification was specified. */</span>
<a name="l00071"></a><a class="code" href="classAssemblerX86.html#05c6a06b023e929452df26ba2b85ebd7">00071</a>     <span class="keyword">static</span> <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <a class="code" href="classAssemblerX86.html#05c6a06b023e929452df26ba2b85ebd7">od_e0</a>       = 0x00000000 | <a class="code" href="classAssemblerX86.html#0c11d2e51fd7bd977daa6db5da6d22a4">od_e_pres</a>;
<a name="l00072"></a><a class="code" href="classAssemblerX86.html#2661c8e723a67e957fa8adcde60b4726">00072</a>     <span class="keyword">static</span> <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <a class="code" href="classAssemblerX86.html#2661c8e723a67e957fa8adcde60b4726">od_e1</a>       = 0x00000010 | <a class="code" href="classAssemblerX86.html#0c11d2e51fd7bd977daa6db5da6d22a4">od_e_pres</a>;
<a name="l00073"></a><a class="code" href="classAssemblerX86.html#ec5c73d09fd42e07bf33a4fa58072302">00073</a>     <span class="keyword">static</span> <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <a class="code" href="classAssemblerX86.html#ec5c73d09fd42e07bf33a4fa58072302">od_e2</a>       = 0x00000020 | <a class="code" href="classAssemblerX86.html#0c11d2e51fd7bd977daa6db5da6d22a4">od_e_pres</a>;
<a name="l00074"></a><a class="code" href="classAssemblerX86.html#763a0ddb6657fbefae419d4a13e25228">00074</a>     <span class="keyword">static</span> <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <a class="code" href="classAssemblerX86.html#763a0ddb6657fbefae419d4a13e25228">od_e3</a>       = 0x00000030 | <a class="code" href="classAssemblerX86.html#0c11d2e51fd7bd977daa6db5da6d22a4">od_e_pres</a>;
<a name="l00075"></a><a class="code" href="classAssemblerX86.html#eb6f9e4693d3b5f25ff21ea157c870c8">00075</a>     <span class="keyword">static</span> <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <a class="code" href="classAssemblerX86.html#eb6f9e4693d3b5f25ff21ea157c870c8">od_e4</a>       = 0x00000040 | <a class="code" href="classAssemblerX86.html#0c11d2e51fd7bd977daa6db5da6d22a4">od_e_pres</a>;
<a name="l00076"></a><a class="code" href="classAssemblerX86.html#800a15f92721435b20b109255e02a41a">00076</a>     <span class="keyword">static</span> <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <a class="code" href="classAssemblerX86.html#800a15f92721435b20b109255e02a41a">od_e5</a>       = 0x00000050 | <a class="code" href="classAssemblerX86.html#0c11d2e51fd7bd977daa6db5da6d22a4">od_e_pres</a>;
<a name="l00077"></a><a class="code" href="classAssemblerX86.html#0f983a805b74ce5907b2987478e71c8e">00077</a>     <span class="keyword">static</span> <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <a class="code" href="classAssemblerX86.html#0f983a805b74ce5907b2987478e71c8e">od_e6</a>       = 0x00000060 | <a class="code" href="classAssemblerX86.html#0c11d2e51fd7bd977daa6db5da6d22a4">od_e_pres</a>;
<a name="l00078"></a><a class="code" href="classAssemblerX86.html#d01ac5fe8ed218d0d026c3798cda7c80">00078</a>     <span class="keyword">static</span> <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <a class="code" href="classAssemblerX86.html#d01ac5fe8ed218d0d026c3798cda7c80">od_e7</a>       = 0x00000070 | <a class="code" href="classAssemblerX86.html#0c11d2e51fd7bd977daa6db5da6d22a4">od_e_pres</a>;
<a name="l00079"></a><a class="code" href="classAssemblerX86.html#9914ac376e0ed2aa94b1003f40852dc6">00079</a>     <span class="keyword">static</span> size_t <a class="code" href="classAssemblerX86.html#9914ac376e0ed2aa94b1003f40852dc6">od_e_val</a>(<span class="keywordtype">unsigned</span> opcode_mods) { <span class="keywordflow">return</span> (opcode_mods &amp; <a class="code" href="classAssemblerX86.html#5f13f0a7625ffa5f488cd69c6cd75136">od_e_mask</a>)&gt;&gt;4; } 
<a name="l00084"></a><a class="code" href="classAssemblerX86.html#be77e60c04ab51f420488806114ce4ee">00084</a>     <span class="keyword">static</span> <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <a class="code" href="classAssemblerX86.html#be77e60c04ab51f420488806114ce4ee">od_rex_pres</a> = 0x00000001;                <span class="comment">/* bit set if REX prefix is present. */</span>
<a name="l00085"></a><a class="code" href="classAssemblerX86.html#7e9704821a7196116e46a906c51cf13a">00085</a>     <span class="keyword">static</span> <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <a class="code" href="classAssemblerX86.html#7e9704821a7196116e46a906c51cf13a">od_rex_mask</a> = 0x00000f00;                <span class="comment">/* mask for low nyble of REX byte. */</span>
<a name="l00086"></a><a class="code" href="classAssemblerX86.html#ff117fbbf1494550f00c04da42439051">00086</a>     <span class="keyword">static</span> <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <a class="code" href="classAssemblerX86.html#ff117fbbf1494550f00c04da42439051">od_rex</a>      = 0x00000000 | <a class="code" href="classAssemblerX86.html#be77e60c04ab51f420488806114ce4ee">od_rex_pres</a>;
<a name="l00087"></a><a class="code" href="classAssemblerX86.html#35f0a11c5e4fc8a3b45bd7015d9b79bf">00087</a>     <span class="keyword">static</span> <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <a class="code" href="classAssemblerX86.html#35f0a11c5e4fc8a3b45bd7015d9b79bf">od_rexb</a>     = 0x00000100 | <a class="code" href="classAssemblerX86.html#be77e60c04ab51f420488806114ce4ee">od_rex_pres</a>;
<a name="l00088"></a><a class="code" href="classAssemblerX86.html#9ba66d5581a727674684dbd6091c9040">00088</a>     <span class="keyword">static</span> <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <a class="code" href="classAssemblerX86.html#9ba66d5581a727674684dbd6091c9040">od_rexx</a>     = 0x00000200 | <a class="code" href="classAssemblerX86.html#be77e60c04ab51f420488806114ce4ee">od_rex_pres</a>;
<a name="l00089"></a><a class="code" href="classAssemblerX86.html#8f4b5a846fc7b7a59e9877ec33b26323">00089</a>     <span class="keyword">static</span> <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <a class="code" href="classAssemblerX86.html#8f4b5a846fc7b7a59e9877ec33b26323">od_rexxb</a>    = 0x00000300 | <a class="code" href="classAssemblerX86.html#be77e60c04ab51f420488806114ce4ee">od_rex_pres</a>;
<a name="l00090"></a><a class="code" href="classAssemblerX86.html#97054941c196fbe8ab711f830a751e7e">00090</a>     <span class="keyword">static</span> <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <a class="code" href="classAssemblerX86.html#97054941c196fbe8ab711f830a751e7e">od_rexr</a>     = 0x00000400 | <a class="code" href="classAssemblerX86.html#be77e60c04ab51f420488806114ce4ee">od_rex_pres</a>;
<a name="l00091"></a><a class="code" href="classAssemblerX86.html#5010dba3b6ba79f01967ac9fea76c8e4">00091</a>     <span class="keyword">static</span> <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <a class="code" href="classAssemblerX86.html#5010dba3b6ba79f01967ac9fea76c8e4">od_rexrb</a>    = 0x00000500 | <a class="code" href="classAssemblerX86.html#be77e60c04ab51f420488806114ce4ee">od_rex_pres</a>;
<a name="l00092"></a><a class="code" href="classAssemblerX86.html#0f3790e72f8d78e76ae4959b839b9dc0">00092</a>     <span class="keyword">static</span> <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <a class="code" href="classAssemblerX86.html#0f3790e72f8d78e76ae4959b839b9dc0">od_rexrx</a>    = 0x00000600 | <a class="code" href="classAssemblerX86.html#be77e60c04ab51f420488806114ce4ee">od_rex_pres</a>;
<a name="l00093"></a><a class="code" href="classAssemblerX86.html#5890df39cf1103cbdb67c9a853151a0f">00093</a>     <span class="keyword">static</span> <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <a class="code" href="classAssemblerX86.html#5890df39cf1103cbdb67c9a853151a0f">od_rexrxb</a>   = 0x00000700 | <a class="code" href="classAssemblerX86.html#be77e60c04ab51f420488806114ce4ee">od_rex_pres</a>;
<a name="l00094"></a><a class="code" href="classAssemblerX86.html#dde6f5262f11177bc8ef785151d9756a">00094</a>     <span class="keyword">static</span> <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <a class="code" href="classAssemblerX86.html#dde6f5262f11177bc8ef785151d9756a">od_rexw</a>     = 0x00000800 | <a class="code" href="classAssemblerX86.html#be77e60c04ab51f420488806114ce4ee">od_rex_pres</a>;
<a name="l00095"></a><a class="code" href="classAssemblerX86.html#51ec96fa37eed39b105916108b0b3894">00095</a>     <span class="keyword">static</span> <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <a class="code" href="classAssemblerX86.html#51ec96fa37eed39b105916108b0b3894">od_rexwb</a>    = 0x00000900 | <a class="code" href="classAssemblerX86.html#be77e60c04ab51f420488806114ce4ee">od_rex_pres</a>;
<a name="l00096"></a><a class="code" href="classAssemblerX86.html#86bdb8180eae70d897cd21b421e9d786">00096</a>     <span class="keyword">static</span> <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <a class="code" href="classAssemblerX86.html#86bdb8180eae70d897cd21b421e9d786">od_rexwx</a>    = 0x00000a00 | <a class="code" href="classAssemblerX86.html#be77e60c04ab51f420488806114ce4ee">od_rex_pres</a>;
<a name="l00097"></a><a class="code" href="classAssemblerX86.html#de56a52038e16256c4d589d330fe625e">00097</a>     <span class="keyword">static</span> <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <a class="code" href="classAssemblerX86.html#de56a52038e16256c4d589d330fe625e">od_rexwxb</a>   = 0x00000b00 | <a class="code" href="classAssemblerX86.html#be77e60c04ab51f420488806114ce4ee">od_rex_pres</a>;
<a name="l00098"></a><a class="code" href="classAssemblerX86.html#1bd6669e91df2fc75508f4bacbd3bfdc">00098</a>     <span class="keyword">static</span> <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <a class="code" href="classAssemblerX86.html#1bd6669e91df2fc75508f4bacbd3bfdc">od_rexwr</a>    = 0x00000c00 | <a class="code" href="classAssemblerX86.html#be77e60c04ab51f420488806114ce4ee">od_rex_pres</a>;
<a name="l00099"></a><a class="code" href="classAssemblerX86.html#8c259d9941821c2bbad4a1e857ef2965">00099</a>     <span class="keyword">static</span> <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <a class="code" href="classAssemblerX86.html#8c259d9941821c2bbad4a1e857ef2965">od_rexwrb</a>   = 0x00000d00 | <a class="code" href="classAssemblerX86.html#be77e60c04ab51f420488806114ce4ee">od_rex_pres</a>;
<a name="l00100"></a><a class="code" href="classAssemblerX86.html#ffeaf7869fa9dc62dda67c8db4c9d5a3">00100</a>     <span class="keyword">static</span> <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <a class="code" href="classAssemblerX86.html#ffeaf7869fa9dc62dda67c8db4c9d5a3">od_rexwrx</a>   = 0x00000e00 | <a class="code" href="classAssemblerX86.html#be77e60c04ab51f420488806114ce4ee">od_rex_pres</a>;
<a name="l00101"></a><a class="code" href="classAssemblerX86.html#ce0f3d822fa6bc15442da1d847bca1d7">00101</a>     <span class="keyword">static</span> <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <a class="code" href="classAssemblerX86.html#ce0f3d822fa6bc15442da1d847bca1d7">od_rexwrxb</a>  = 0x00000f00 | <a class="code" href="classAssemblerX86.html#be77e60c04ab51f420488806114ce4ee">od_rex_pres</a>;
<a name="l00102"></a><a class="code" href="classAssemblerX86.html#3c0ef98283b6ae4ea2475dc1dea28e6f">00102</a>     <span class="keyword">static</span> uint8_t <a class="code" href="classAssemblerX86.html#3c0ef98283b6ae4ea2475dc1dea28e6f">od_rex_byte</a>(<span class="keywordtype">unsigned</span> opcode_mods) { <span class="keywordflow">return</span> 0x40 | ((opcode_mods &amp; <a class="code" href="classAssemblerX86.html#7e9704821a7196116e46a906c51cf13a">od_rex_mask</a>) &gt;&gt; 8); }
<a name="l00103"></a>00103 
<a name="l00106"></a><a class="code" href="classAssemblerX86.html#3de2e14b3c09347f69ed1b1064d03a6a">00106</a>     <span class="keyword">static</span> <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <a class="code" href="classAssemblerX86.html#3de2e14b3c09347f69ed1b1064d03a6a">od_modrm</a>    = 0x00000002;
<a name="l00107"></a>00107 
<a name="l00110"></a><a class="code" href="classAssemblerX86.html#1ec5e2e201c378ab510503fcf604a9c5">00110</a>     <span class="keyword">static</span> <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <a class="code" href="classAssemblerX86.html#1ec5e2e201c378ab510503fcf604a9c5">od_c_mask</a>   = 0x00007000;
<a name="l00111"></a><a class="code" href="classAssemblerX86.html#76900dec510d44a1c2f5d43d62fb921c">00111</a>     <span class="keyword">static</span> <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <a class="code" href="classAssemblerX86.html#76900dec510d44a1c2f5d43d62fb921c">od_cb</a>       = 0x00001000;
<a name="l00112"></a><a class="code" href="classAssemblerX86.html#98c2a52fd93891b4dac8fe807d7fce8d">00112</a>     <span class="keyword">static</span> <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <a class="code" href="classAssemblerX86.html#98c2a52fd93891b4dac8fe807d7fce8d">od_cw</a>       = 0x00002000;
<a name="l00113"></a><a class="code" href="classAssemblerX86.html#352aa6d3fd09bd4b3940a85469e8a4ef">00113</a>     <span class="keyword">static</span> <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <a class="code" href="classAssemblerX86.html#352aa6d3fd09bd4b3940a85469e8a4ef">od_cd</a>       = 0x00003000;
<a name="l00114"></a><a class="code" href="classAssemblerX86.html#5f1a2cca10d59a6c8a6256475cefc42b">00114</a>     <span class="keyword">static</span> <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <a class="code" href="classAssemblerX86.html#5f1a2cca10d59a6c8a6256475cefc42b">od_cp</a>       = 0x00004000;
<a name="l00115"></a><a class="code" href="classAssemblerX86.html#64aa3b970ee9459b5c7607e1aa3c3aa4">00115</a>     <span class="keyword">static</span> <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <a class="code" href="classAssemblerX86.html#64aa3b970ee9459b5c7607e1aa3c3aa4">od_co</a>       = 0x00005000;
<a name="l00116"></a><a class="code" href="classAssemblerX86.html#107613323d0fc67c1bdb47ee37f2a6da">00116</a>     <span class="keyword">static</span> <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <a class="code" href="classAssemblerX86.html#107613323d0fc67c1bdb47ee37f2a6da">od_ct</a>       = 0x00006000;
<a name="l00117"></a>00117 
<a name="l00120"></a><a class="code" href="classAssemblerX86.html#9cc1b73232b99807615e12a1a1311fb1">00120</a>     <span class="keyword">static</span> <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <a class="code" href="classAssemblerX86.html#9cc1b73232b99807615e12a1a1311fb1">od_i_mask</a>   = 0x00070000;
<a name="l00121"></a><a class="code" href="classAssemblerX86.html#297beb5108e02f688d0a6d438694ef4f">00121</a>     <span class="keyword">static</span> <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <a class="code" href="classAssemblerX86.html#297beb5108e02f688d0a6d438694ef4f">od_ib</a>       = 0x00010000;
<a name="l00122"></a><a class="code" href="classAssemblerX86.html#696bd055be6a5a82ec7289e7703f2415">00122</a>        <span class="keyword">static</span> <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <a class="code" href="classAssemblerX86.html#696bd055be6a5a82ec7289e7703f2415">od_iw</a>       = 0x00020000;
<a name="l00123"></a><a class="code" href="classAssemblerX86.html#367f03eb633b18b1556ed56fa3708e31">00123</a>     <span class="keyword">static</span> <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <a class="code" href="classAssemblerX86.html#367f03eb633b18b1556ed56fa3708e31">od_id</a>       = 0x00030000;
<a name="l00124"></a><a class="code" href="classAssemblerX86.html#f4e5d72847a431eb99122701c97910ca">00124</a>     <span class="keyword">static</span> <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <a class="code" href="classAssemblerX86.html#f4e5d72847a431eb99122701c97910ca">od_io</a>       = 0x00040000;
<a name="l00125"></a>00125 
<a name="l00128"></a><a class="code" href="classAssemblerX86.html#eeabdc24083237053fea4b015b2fa5a4">00128</a>     <span class="keyword">static</span> <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <a class="code" href="classAssemblerX86.html#eeabdc24083237053fea4b015b2fa5a4">od_r_mask</a>   = 0x00700000;
<a name="l00129"></a><a class="code" href="classAssemblerX86.html#222c480a51792bf4c336335ccdba97ad">00129</a>     <span class="keyword">static</span> <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <a class="code" href="classAssemblerX86.html#222c480a51792bf4c336335ccdba97ad">od_rb</a>       = 0x00100000;
<a name="l00130"></a><a class="code" href="classAssemblerX86.html#b16dc04c020bee76f673657f4101c32e">00130</a>     <span class="keyword">static</span> <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <a class="code" href="classAssemblerX86.html#b16dc04c020bee76f673657f4101c32e">od_rw</a>       = 0x00200000;
<a name="l00131"></a><a class="code" href="classAssemblerX86.html#724184ba11f442cce3a36115176c903e">00131</a>     <span class="keyword">static</span> <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <a class="code" href="classAssemblerX86.html#724184ba11f442cce3a36115176c903e">od_rd</a>       = 0x00300000;
<a name="l00132"></a><a class="code" href="classAssemblerX86.html#6c75d542c246f384e77b58334ac43307">00132</a>     <span class="keyword">static</span> <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <a class="code" href="classAssemblerX86.html#6c75d542c246f384e77b58334ac43307">od_ro</a>       = 0x00400000;
<a name="l00133"></a>00133 
<a name="l00137"></a><a class="code" href="classAssemblerX86.html#259e7acf62b0a668fa7d60f76485cfd3">00137</a>     <span class="keyword">static</span> <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <a class="code" href="classAssemblerX86.html#259e7acf62b0a668fa7d60f76485cfd3">od_i</a>        = 0x00000004;
<a name="l00138"></a>00138 
<a name="l00139"></a>00139 
<a name="l00141"></a><a class="code" href="classAssemblerX86.html#26cf2311d68def86620d868d9b407111">00141</a>     <span class="keyword">enum</span> <a class="code" href="classAssemblerX86.html#26cf2311d68def86620d868d9b407111">OperandDefn</a> 
<a name="l00142"></a>00142         {
<a name="l00143"></a>00143         <a class="code" href="classAssemblerX86.html#26cf2311d68def86620d868d9b407111faec77270e839b0cb3ad1c8801779f22">od_none</a>,        
<a name="l00144"></a>00144         <a class="code" href="classAssemblerX86.html#26cf2311d68def86620d868d9b40711153f5726689e3ae27967a69901afaae3f">od_AL</a>,          
<a name="l00145"></a>00145         <a class="code" href="classAssemblerX86.html#26cf2311d68def86620d868d9b407111b6d78b9a5038ab1cafe602752bb9d9a1">od_AX</a>,          
<a name="l00146"></a>00146         <a class="code" href="classAssemblerX86.html#26cf2311d68def86620d868d9b407111aed124eabef155409f906aec0b6b1bbe">od_EAX</a>,         
<a name="l00147"></a>00147         <a class="code" href="classAssemblerX86.html#26cf2311d68def86620d868d9b407111adc1d9e2515ea8e6dc2b73c6c9d23996">od_RAX</a>,         
<a name="l00148"></a>00148         <a class="code" href="classAssemblerX86.html#26cf2311d68def86620d868d9b4071112eabd99963d7ceb577032558ecfba710">od_DX</a>,          
<a name="l00149"></a>00149         <a class="code" href="classAssemblerX86.html#26cf2311d68def86620d868d9b40711144be974bfe7e13f68fe6142c32afbce3">od_CS</a>,          
<a name="l00150"></a>00150         <a class="code" href="classAssemblerX86.html#26cf2311d68def86620d868d9b407111932d51784b3ddd118c117e6cf9898889">od_DS</a>,          
<a name="l00151"></a>00151         <a class="code" href="classAssemblerX86.html#26cf2311d68def86620d868d9b407111af4e57c79577ed587f37d5c7928b8ba1">od_ES</a>,          
<a name="l00152"></a>00152         <a class="code" href="classAssemblerX86.html#26cf2311d68def86620d868d9b4071112d5867217331f62077e8b597bd35a676">od_FS</a>,          
<a name="l00153"></a>00153         <a class="code" href="classAssemblerX86.html#26cf2311d68def86620d868d9b4071112e18a0619d6c11bbd1fbbbbd19a3fb84">od_GS</a>,          
<a name="l00154"></a>00154         <a class="code" href="classAssemblerX86.html#26cf2311d68def86620d868d9b40711138c382155962e1551da0b74d9c1bebfd">od_SS</a>,          
<a name="l00155"></a>00155         <a class="code" href="classAssemblerX86.html#26cf2311d68def86620d868d9b407111bfcb64345dbaefab195df5b942d0e9db">od_rel8</a>,        
<a name="l00157"></a>00157         <a class="code" href="classAssemblerX86.html#26cf2311d68def86620d868d9b40711197933e3a9f040fee56ad04ff1fa95ed2">od_rel16</a>,       
<a name="l00159"></a>00159         <a class="code" href="classAssemblerX86.html#26cf2311d68def86620d868d9b4071115cf9806a95585965c4f37d8c9949a898">od_rel32</a>,       
<a name="l00161"></a>00161         <a class="code" href="classAssemblerX86.html#26cf2311d68def86620d868d9b407111ba083b6d221c3d6ae962768c38fe5a30">od_rel64</a>,       
<a name="l00163"></a>00163         <a class="code" href="classAssemblerX86.html#26cf2311d68def86620d868d9b407111387828c2a776f7c64cfb38cbcf99dacc">od_ptr16_16</a>,    
<a name="l00168"></a>00168         <a class="code" href="classAssemblerX86.html#26cf2311d68def86620d868d9b4071117eaba3b0d01b8f593a982f911f8e7477">od_ptr16_32</a>,    
<a name="l00173"></a>00173         <a class="code" href="classAssemblerX86.html#26cf2311d68def86620d868d9b407111673c8ee5080a7a3b94e3a2828a091ff6">od_ptr16_64</a>,    
<a name="l00178"></a>00178         <a class="code" href="classAssemblerX86.html#26cf2311d68def86620d868d9b407111eaf70b98ff7734e5acce496c0c6dccf7">od_r8</a>,          
<a name="l00180"></a>00180         <a class="code" href="classAssemblerX86.html#26cf2311d68def86620d868d9b4071117ac1515013b6395e8d38d06232e3f6f4">od_r16</a>,         
<a name="l00182"></a>00182         <a class="code" href="classAssemblerX86.html#26cf2311d68def86620d868d9b407111cf1bb6990512186863d55d0bcae9d530">od_r32</a>,         
<a name="l00184"></a>00184         <a class="code" href="classAssemblerX86.html#26cf2311d68def86620d868d9b4071111db1ecf9180f66c78cbb195aa41d7959">od_r64</a>,         
<a name="l00186"></a>00186         <a class="code" href="classAssemblerX86.html#26cf2311d68def86620d868d9b407111366412c782a84e782002989dc0207af6">od_imm8</a>,        
<a name="l00190"></a>00190         <a class="code" href="classAssemblerX86.html#26cf2311d68def86620d868d9b40711128704b11bdab8233170a72e99bc8abac">od_imm16</a>,       
<a name="l00192"></a>00192         <a class="code" href="classAssemblerX86.html#26cf2311d68def86620d868d9b407111bc7f53d4918065a65a1b251339d402de">od_imm32</a>,       
<a name="l00194"></a>00194         <a class="code" href="classAssemblerX86.html#26cf2311d68def86620d868d9b40711168d1617559e951b7a0f0d2b480e1017c">od_imm64</a>,       
<a name="l00197"></a>00197         <a class="code" href="classAssemblerX86.html#26cf2311d68def86620d868d9b40711195c801427b24b126d492e413c95523f5">od_r_m8</a>,        
<a name="l00200"></a>00200         <a class="code" href="classAssemblerX86.html#26cf2311d68def86620d868d9b407111781c75e2dd1fc884a4143680bc75b11d">od_r_m16</a>,       
<a name="l00205"></a>00205         <a class="code" href="classAssemblerX86.html#26cf2311d68def86620d868d9b4071110858fb69c2ab52d968b71a0b2208cf34">od_r_m32</a>,       
<a name="l00210"></a>00210         <a class="code" href="classAssemblerX86.html#26cf2311d68def86620d868d9b4071111107a4a0087b1019f31ca5bbe5d50feb">od_r_m64</a>,       
<a name="l00215"></a>00215         <a class="code" href="classAssemblerX86.html#26cf2311d68def86620d868d9b4071112b867f4fea3c1c30dd61de1e04a06f75">od_m</a>,           
<a name="l00216"></a>00216         <a class="code" href="classAssemblerX86.html#26cf2311d68def86620d868d9b4071110cc1163b164636c0a79bc7bf5c3db3c3">od_m8</a>,          
<a name="l00218"></a>00218         <a class="code" href="classAssemblerX86.html#26cf2311d68def86620d868d9b4071119a44283a6f1cdaa5f7aa0c90f5a46bdf">od_m16</a>,         
<a name="l00220"></a>00220         <a class="code" href="classAssemblerX86.html#26cf2311d68def86620d868d9b4071110757c7d4216d7ebc06fe5b211b8cbcdd">od_m32</a>,         
<a name="l00222"></a>00222         <a class="code" href="classAssemblerX86.html#26cf2311d68def86620d868d9b4071116d597d1c8894badc3124c1135a75a2f7">od_m64</a>,         
<a name="l00223"></a>00223         <a class="code" href="classAssemblerX86.html#26cf2311d68def86620d868d9b407111b47976775c01bbb0e8c208434f0a73bf">od_m128</a>,        
<a name="l00224"></a>00224         <a class="code" href="classAssemblerX86.html#26cf2311d68def86620d868d9b4071110693d30ca67138eaa61021bd6dcd4196">od_m16_16</a>,      
<a name="l00227"></a>00227         <a class="code" href="classAssemblerX86.html#26cf2311d68def86620d868d9b407111234bc191ce9540ae7a5666424eb2dd8b">od_m16_32</a>,      
<a name="l00230"></a>00230         <a class="code" href="classAssemblerX86.html#26cf2311d68def86620d868d9b4071116a11dc04f9437c991042c8a21164b19c">od_m16_64</a>,      
<a name="l00233"></a>00233         <a class="code" href="classAssemblerX86.html#26cf2311d68def86620d868d9b407111d7b446bea0f669a10c0551d78eedd98d">od_m16a16</a>,      
<a name="l00237"></a>00237         <a class="code" href="classAssemblerX86.html#26cf2311d68def86620d868d9b407111d80278919a74b430be06699419fc63d2">od_m16a32</a>,      
<a name="l00242"></a>00242         <a class="code" href="classAssemblerX86.html#26cf2311d68def86620d868d9b40711197792c5c1961405bf4f6d63a8f5d0e67">od_m32a32</a>,      
<a name="l00246"></a>00246         <a class="code" href="classAssemblerX86.html#26cf2311d68def86620d868d9b40711147f03dcf89d8b5b551c14e440ae96f72">od_m16a64</a>,      
<a name="l00251"></a>00251         <a class="code" href="classAssemblerX86.html#26cf2311d68def86620d868d9b407111a5977b227f122d9bd1a40463cfd02a49">od_moffs8</a>,      
<a name="l00254"></a>00254         <a class="code" href="classAssemblerX86.html#26cf2311d68def86620d868d9b4071116a03e6fa9133aca6d26083ce3c67397e">od_moffs16</a>,      
<a name="l00257"></a>00257         <a class="code" href="classAssemblerX86.html#26cf2311d68def86620d868d9b407111ca1b056aae097e4f1e651919ab3f4754">od_moffs32</a>,     
<a name="l00260"></a>00260         <a class="code" href="classAssemblerX86.html#26cf2311d68def86620d868d9b40711176614f3ac48485364f0dac0e1027a186">od_moffs64</a>,     
<a name="l00263"></a>00263         <a class="code" href="classAssemblerX86.html#26cf2311d68def86620d868d9b40711160874bc6edc09347dba403419f7cf81c">od_sreg</a>,        
<a name="l00265"></a>00265         <a class="code" href="classAssemblerX86.html#26cf2311d68def86620d868d9b4071114c51c5dfcc3cc2030cb92cefa545f222">od_m32fp</a>,       
<a name="l00267"></a>00267         <a class="code" href="classAssemblerX86.html#26cf2311d68def86620d868d9b407111792fad26196965e1e85426469df0f49f">od_m64fp</a>,       
<a name="l00269"></a>00269         <a class="code" href="classAssemblerX86.html#26cf2311d68def86620d868d9b407111c729769db839d8dbcbc188b5a4b7a971">od_m80fp</a>,       
<a name="l00271"></a>00271         <a class="code" href="classAssemblerX86.html#26cf2311d68def86620d868d9b407111ea6df1183e59b257d8fe8efffe9a3b09">od_st0</a>,         
<a name="l00272"></a>00272         <a class="code" href="classAssemblerX86.html#26cf2311d68def86620d868d9b407111c01f7a241572498abb1b886690659a63">od_st1</a>,         
<a name="l00273"></a>00273         <a class="code" href="classAssemblerX86.html#26cf2311d68def86620d868d9b40711109720eb8d33f57b2ba4aa75d3f22ad3a">od_st2</a>,         
<a name="l00274"></a>00274         <a class="code" href="classAssemblerX86.html#26cf2311d68def86620d868d9b407111a422ae5a516fe045b413842cdb21c709">od_st3</a>,         
<a name="l00275"></a>00275         <a class="code" href="classAssemblerX86.html#26cf2311d68def86620d868d9b4071116affca87f3182bd13f1729e29ed39e43">od_st4</a>,         
<a name="l00276"></a>00276         <a class="code" href="classAssemblerX86.html#26cf2311d68def86620d868d9b4071118db70e32f98938b46ffedcc6db928504">od_st5</a>,         
<a name="l00277"></a>00277         <a class="code" href="classAssemblerX86.html#26cf2311d68def86620d868d9b407111504c5422570730decb4bdc686c9bb54e">od_st6</a>,         
<a name="l00278"></a>00278         <a class="code" href="classAssemblerX86.html#26cf2311d68def86620d868d9b4071113066189fa2efe7ce6177612451dd3b45">od_st7</a>,         
<a name="l00279"></a>00279         <a class="code" href="classAssemblerX86.html#26cf2311d68def86620d868d9b407111b3c57805155075b667264923209f9213">od_sti</a>,         
<a name="l00280"></a>00280         <a class="code" href="classAssemblerX86.html#26cf2311d68def86620d868d9b407111f3a9fd24b823d82b1f0fa7a7df7f3495">od_mm</a>,          
<a name="l00281"></a>00281         <a class="code" href="classAssemblerX86.html#26cf2311d68def86620d868d9b407111ad39cf027ea73ed2d57252a073a198f7">od_mm_m32</a>,      
<a name="l00284"></a>00284         <a class="code" href="classAssemblerX86.html#26cf2311d68def86620d868d9b407111a92780bcf575beda1ca5f31f68e6d290">od_mm_m64</a>,      
<a name="l00287"></a>00287         <a class="code" href="classAssemblerX86.html#26cf2311d68def86620d868d9b40711112747e27b155dc780d3e8f2171e09ad8">od_xmm</a>,         
<a name="l00289"></a>00289         <a class="code" href="classAssemblerX86.html#26cf2311d68def86620d868d9b407111116f8543f13e48a7d76c95aa839b535e">od_xmm_m16</a>,     
<a name="l00290"></a>00290         <a class="code" href="classAssemblerX86.html#26cf2311d68def86620d868d9b407111f5e887c6ca4f95c2bd425c831dd74d29">od_xmm_m32</a>,     
<a name="l00293"></a>00293         <a class="code" href="classAssemblerX86.html#26cf2311d68def86620d868d9b40711137938702b02e3ac1b59aa1479a1769c7">od_xmm_m64</a>,     
<a name="l00296"></a>00296         <a class="code" href="classAssemblerX86.html#26cf2311d68def86620d868d9b4071113eb3b885ffa12628847bf78e9f958fef">od_xmm_m128</a>,    
<a name="l00299"></a>00299         <span class="comment">/* The following are not documented in section 3.1.1.2 but are used elsewhere in the manual */</span>
<a name="l00300"></a>00300         <a class="code" href="classAssemblerX86.html#26cf2311d68def86620d868d9b407111dfb13e6629253d560c8e831ff874d6c1">od_XMM0</a>,        
<a name="l00301"></a>00301         <a class="code" href="classAssemblerX86.html#26cf2311d68def86620d868d9b407111951c7e9bba1a2dfac6b404140af7c7ce">od_0</a>,           
<a name="l00302"></a>00302         <a class="code" href="classAssemblerX86.html#26cf2311d68def86620d868d9b4071113e42bd5ac2af5354c62292ba0c55d5c0">od_1</a>,           
<a name="l00303"></a>00303         <a class="code" href="classAssemblerX86.html#26cf2311d68def86620d868d9b4071119139ea99f17c75c7f603e48256f83845">od_m80</a>,         
<a name="l00304"></a>00304         <a class="code" href="classAssemblerX86.html#26cf2311d68def86620d868d9b40711178a5cd944f69f128120863696ab58879">od_dec</a>,         
<a name="l00305"></a>00305         <a class="code" href="classAssemblerX86.html#26cf2311d68def86620d868d9b407111dfacf60ef5bc2ebf1cf78cf1dd89905a">od_m80bcd</a>,      
<a name="l00306"></a>00306         <a class="code" href="classAssemblerX86.html#26cf2311d68def86620d868d9b407111cb51c59073acfe13e959598c198482ea">od_m2byte</a>,      
<a name="l00307"></a>00307         <a class="code" href="classAssemblerX86.html#26cf2311d68def86620d868d9b407111abb52db5691ca10c3889122c4ce1e1bc">od_m14_28byte</a>,  
<a name="l00308"></a>00308         <a class="code" href="classAssemblerX86.html#26cf2311d68def86620d868d9b4071113aa95930119d5080b9f6aa5b38339028">od_m94_108byte</a>, 
<a name="l00309"></a>00309         <a class="code" href="classAssemblerX86.html#26cf2311d68def86620d868d9b40711134335041c309503ef70fd3fb31c3535f">od_m512byte</a>,    
<a name="l00310"></a>00310         <a class="code" href="classAssemblerX86.html#26cf2311d68def86620d868d9b407111abea3f5831c8b75cd30cb342ef0640ff">od_r16_m16</a>,     
<a name="l00311"></a>00311         <a class="code" href="classAssemblerX86.html#26cf2311d68def86620d868d9b40711119d5620b557997d9291d13b8c44ed01e">od_r32_m8</a>,      
<a name="l00312"></a>00312         <a class="code" href="classAssemblerX86.html#26cf2311d68def86620d868d9b4071117db62a852e69cc8dcd5d9a2d06953c48">od_r32_m16</a>,     
<a name="l00313"></a>00313         <a class="code" href="classAssemblerX86.html#26cf2311d68def86620d868d9b407111cb92b6ff3e78055c88cbd428afa6223b">od_r64_m16</a>,     
<a name="l00314"></a>00314         <a class="code" href="classAssemblerX86.html#26cf2311d68def86620d868d9b407111529d73862608a623f371b3ff578717bd">od_CR0</a>,         
<a name="l00315"></a>00315         <a class="code" href="classAssemblerX86.html#26cf2311d68def86620d868d9b407111add6c22d0d1770eb6db421b1a64f7a4c">od_CR7</a>,         
<a name="l00316"></a>00316         <a class="code" href="classAssemblerX86.html#26cf2311d68def86620d868d9b4071113b552630bf3702f5f152abff32878df7">od_CR8</a>,         
<a name="l00317"></a>00317         <a class="code" href="classAssemblerX86.html#26cf2311d68def86620d868d9b40711169a472cdd5daab42bf9c45eddc85f86f">od_CR0CR7</a>,      
<a name="l00318"></a>00318         <a class="code" href="classAssemblerX86.html#26cf2311d68def86620d868d9b4071110a17ef856917b6cce69655e25981b2c6">od_DR0DR7</a>,      
<a name="l00319"></a>00319         <a class="code" href="classAssemblerX86.html#26cf2311d68def86620d868d9b40711117851b35d838a12494813051a813efe4">od_reg</a>,         
<a name="l00320"></a>00320         <a class="code" href="classAssemblerX86.html#26cf2311d68def86620d868d9b4071119d6058659228d7c6e77d3f89eeb3a0fc">od_CL</a>,          
<a name="l00321"></a>00321     };
<a name="l00322"></a>00322 
<a name="l00324"></a><a class="code" href="classAssemblerX86.html#f2a332f1330e5dfca06d8f265f40da86">00324</a>     <span class="keyword">static</span> <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <a class="code" href="classAssemblerX86.html#f2a332f1330e5dfca06d8f265f40da86">COMPAT_LEGACY</a> = 0x01; 
<a name="l00325"></a><a class="code" href="classAssemblerX86.html#f90657e39440b1e175f61e29edd70a13">00325</a>     <span class="keyword">static</span> <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <a class="code" href="classAssemblerX86.html#f90657e39440b1e175f61e29edd70a13">COMPAT_64</a>     = 0x02; 
<a name="l00328"></a><a class="code" href="classAssemblerX86.html#f429fa5e269039b144f60c131126e8ad">00328</a>     <span class="keyword">static</span> uint8_t <a class="code" href="classAssemblerX86.html#f429fa5e269039b144f60c131126e8ad">build_modrm</a>(<span class="keywordtype">unsigned</span> mod, <span class="keywordtype">unsigned</span> reg, <span class="keywordtype">unsigned</span> rm) {
<a name="l00329"></a>00329         <span class="keywordflow">return</span> ((mod&amp;0x3)&lt;&lt;6) | ((reg&amp;0x7)&lt;&lt;3) | (rm&amp;0x7);
<a name="l00330"></a>00330     }
<a name="l00331"></a>00331 
<a name="l00333"></a><a class="code" href="classAssemblerX86.html#2a39d332cc5daef7ddf270461f91cabd">00333</a>     <span class="keyword">static</span> <span class="keywordtype">unsigned</span> <a class="code" href="classAssemblerX86.html#2a39d332cc5daef7ddf270461f91cabd">modrm_mod</a>(uint8_t modrm) { <span class="keywordflow">return</span> modrm&gt;&gt;6; }
<a name="l00334"></a>00334 
<a name="l00336"></a><a class="code" href="classAssemblerX86.html#44be0bdc6ce6c33dba2b66c7d326fe9b">00336</a>     <span class="keyword">static</span> <span class="keywordtype">unsigned</span> <a class="code" href="classAssemblerX86.html#44be0bdc6ce6c33dba2b66c7d326fe9b">modrm_reg</a>(uint8_t modrm) { <span class="keywordflow">return</span> (modrm&gt;&gt;3) &amp; 0x7; }
<a name="l00337"></a>00337 
<a name="l00339"></a><a class="code" href="classAssemblerX86.html#eb952fa634535dc6337862c7138976f6">00339</a>     <span class="keyword">static</span> <span class="keywordtype">unsigned</span> <a class="code" href="classAssemblerX86.html#eb952fa634535dc6337862c7138976f6">modrm_rm</a>(uint8_t modrm) { <span class="keywordflow">return</span> modrm &amp; 0x7; }
<a name="l00340"></a>00340 
<a name="l00342"></a><a class="code" href="classAssemblerX86.html#62b6b9225ebc8cbd332c6b35d49f5b06">00342</a>     <span class="keyword">static</span> uint8_t <a class="code" href="classAssemblerX86.html#62b6b9225ebc8cbd332c6b35d49f5b06">build_sib</a>(<span class="keywordtype">unsigned</span> ss, <span class="keywordtype">unsigned</span> index, <span class="keywordtype">unsigned</span> base) {
<a name="l00343"></a>00343         <span class="keywordflow">return</span> ((ss&amp;0x3)&lt;&lt;6) | ((index&amp;0x7)&lt;&lt;3) | (base&amp;0x7);
<a name="l00344"></a>00344     }
<a name="l00345"></a>00345 
<a name="l00347"></a><a class="code" href="classAssemblerX86.html#f8b013f0198e282093e5057fd6d98f74">00347</a>     <span class="keyword">static</span> <span class="keywordtype">unsigned</span> <a class="code" href="classAssemblerX86.html#f8b013f0198e282093e5057fd6d98f74">sib_ss</a>(uint8_t sib) {<span class="keywordflow">return</span> sib&gt;&gt;6; }
<a name="l00348"></a>00348 
<a name="l00350"></a><a class="code" href="classAssemblerX86.html#bd6a3bc636e7a5a7c6ab8a5ea4ca01f1">00350</a>     <span class="keyword">static</span> <span class="keywordtype">unsigned</span> <a class="code" href="classAssemblerX86.html#bd6a3bc636e7a5a7c6ab8a5ea4ca01f1">sib_index</a>(uint8_t sib) { <span class="keywordflow">return</span> (sib&gt;&gt;3) &amp; 0x7; }
<a name="l00351"></a>00351 
<a name="l00353"></a><a class="code" href="classAssemblerX86.html#0eccd9354b39cd029a30defbebd29a74">00353</a>     <span class="keyword">static</span> <span class="keywordtype">unsigned</span> <a class="code" href="classAssemblerX86.html#0eccd9354b39cd029a30defbebd29a74">sib_base</a>(uint8_t sib) { <span class="keywordflow">return</span> sib &amp; 0x7; }
<a name="l00354"></a>00354     
<a name="l00358"></a><a class="code" href="classAssemblerX86_1_1InsnDefn.html">00358</a>     <span class="keyword">class </span><a class="code" href="classAssemblerX86_1_1InsnDefn.html">InsnDefn</a> {
<a name="l00359"></a>00359     <span class="keyword">public</span>:
<a name="l00360"></a><a class="code" href="classAssemblerX86_1_1InsnDefn.html#2577ec5f54b09f2472380cc79a58106e">00360</a>         <a class="code" href="classAssemblerX86_1_1InsnDefn.html#2577ec5f54b09f2472380cc79a58106e">InsnDefn</a>(<span class="keyword">const</span> std::string &amp;<a class="code" href="classAssemblerX86_1_1InsnDefn.html#471684a122a474689c14e96cb61440d8">mnemonic</a>, <a class="code" href="AssemblerX86Init_8h.html#cb800e57ccb0a3ac5b7a89056bca5571">X86InstructionKind</a> <a class="code" href="classAssemblerX86_1_1InsnDefn.html#1e3034fb4a991d3fe060c54d459ca3b3">kind</a>, <span class="keywordtype">unsigned</span> <a class="code" href="classAssemblerX86_1_1InsnDefn.html#26edbe6bf27b479ec3fe2e49910f6a70">compatibility</a>, uint64_t <a class="code" href="classAssemblerX86_1_1InsnDefn.html#ec80d1e92ec4b5f57fb39d22a6daa425">opcode</a>,
<a name="l00361"></a>00361                  <span class="keywordtype">unsigned</span> <a class="code" href="classAssemblerX86_1_1InsnDefn.html#410abd654211572ba6bf1bf7e6ede0b4">opcode_modifiers</a>, <a class="code" href="classAssemblerX86.html#26cf2311d68def86620d868d9b407111">OperandDefn</a> op1=<a class="code" href="classAssemblerX86.html#26cf2311d68def86620d868d9b407111faec77270e839b0cb3ad1c8801779f22">od_none</a>, <a class="code" href="classAssemblerX86.html#26cf2311d68def86620d868d9b407111">OperandDefn</a> op2=<a class="code" href="classAssemblerX86.html#26cf2311d68def86620d868d9b407111faec77270e839b0cb3ad1c8801779f22">od_none</a>, <a class="code" href="classAssemblerX86.html#26cf2311d68def86620d868d9b407111">OperandDefn</a> op3=<a class="code" href="classAssemblerX86.html#26cf2311d68def86620d868d9b407111faec77270e839b0cb3ad1c8801779f22">od_none</a>,
<a name="l00362"></a>00362                  <a class="code" href="classAssemblerX86.html#26cf2311d68def86620d868d9b407111">OperandDefn</a> op4=<a class="code" href="classAssemblerX86.html#26cf2311d68def86620d868d9b407111faec77270e839b0cb3ad1c8801779f22">od_none</a>)
<a name="l00363"></a>00363             : mnemonic(mnemonic), kind(kind), compatibility(compatibility), opcode(opcode), opcode_modifiers(opcode_modifiers) {
<a name="l00364"></a>00364             <span class="keywordflow">if</span> (op1) <a class="code" href="classAssemblerX86_1_1InsnDefn.html#908df4b0986f53f4ec913742ca958809">operands</a>.push_back(op1);
<a name="l00365"></a>00365             <span class="keywordflow">if</span> (op2) <a class="code" href="classAssemblerX86_1_1InsnDefn.html#908df4b0986f53f4ec913742ca958809">operands</a>.push_back(op2);
<a name="l00366"></a>00366             <span class="keywordflow">if</span> (op3) <a class="code" href="classAssemblerX86_1_1InsnDefn.html#908df4b0986f53f4ec913742ca958809">operands</a>.push_back(op3);
<a name="l00367"></a>00367             <span class="keywordflow">if</span> (op4) <a class="code" href="classAssemblerX86_1_1InsnDefn.html#908df4b0986f53f4ec913742ca958809">operands</a>.push_back(op4);
<a name="l00368"></a>00368         }
<a name="l00369"></a>00369         std::string <a class="code" href="classAssemblerX86_1_1InsnDefn.html#a7850517c5cc0307d7639f75a28e7c52">to_str</a>() <span class="keyword">const</span>;
<a name="l00370"></a><a class="code" href="classAssemblerX86_1_1InsnDefn.html#78ad306756ae7a40367b2586b9d29bd7">00370</a>         <span class="keywordtype">void</span> <a class="code" href="classAssemblerX86_1_1InsnDefn.html#78ad306756ae7a40367b2586b9d29bd7">set_location</a>(<span class="keyword">const</span> std::string &amp;s) {
<a name="l00371"></a>00371             <a class="code" href="classAssemblerX86_1_1InsnDefn.html#eb6be50c77ac86e3e5a6df68dcbe2f39">location</a> = s;
<a name="l00372"></a>00372         }
<a name="l00373"></a><a class="code" href="classAssemblerX86_1_1InsnDefn.html#471684a122a474689c14e96cb61440d8">00373</a>         std::string <a class="code" href="classAssemblerX86_1_1InsnDefn.html#471684a122a474689c14e96cb61440d8">mnemonic</a>;
<a name="l00374"></a><a class="code" href="classAssemblerX86_1_1InsnDefn.html#1e3034fb4a991d3fe060c54d459ca3b3">00374</a>         <a class="code" href="AssemblerX86Init_8h.html#cb800e57ccb0a3ac5b7a89056bca5571">X86InstructionKind</a> <a class="code" href="classAssemblerX86_1_1InsnDefn.html#1e3034fb4a991d3fe060c54d459ca3b3">kind</a>;
<a name="l00375"></a><a class="code" href="classAssemblerX86_1_1InsnDefn.html#26edbe6bf27b479ec3fe2e49910f6a70">00375</a>         <span class="keywordtype">unsigned</span> <a class="code" href="classAssemblerX86_1_1InsnDefn.html#26edbe6bf27b479ec3fe2e49910f6a70">compatibility</a>;
<a name="l00376"></a><a class="code" href="classAssemblerX86_1_1InsnDefn.html#ec80d1e92ec4b5f57fb39d22a6daa425">00376</a>         uint64_t <a class="code" href="classAssemblerX86_1_1InsnDefn.html#ec80d1e92ec4b5f57fb39d22a6daa425">opcode</a>;
<a name="l00377"></a><a class="code" href="classAssemblerX86_1_1InsnDefn.html#410abd654211572ba6bf1bf7e6ede0b4">00377</a>         <span class="keywordtype">unsigned</span> <a class="code" href="classAssemblerX86_1_1InsnDefn.html#410abd654211572ba6bf1bf7e6ede0b4">opcode_modifiers</a>;
<a name="l00378"></a><a class="code" href="classAssemblerX86_1_1InsnDefn.html#908df4b0986f53f4ec913742ca958809">00378</a>         std::vector&lt;OperandDefn&gt; <a class="code" href="classAssemblerX86_1_1InsnDefn.html#908df4b0986f53f4ec913742ca958809">operands</a>;
<a name="l00379"></a><a class="code" href="classAssemblerX86_1_1InsnDefn.html#eb6be50c77ac86e3e5a6df68dcbe2f39">00379</a>         std::string <a class="code" href="classAssemblerX86_1_1InsnDefn.html#eb6be50c77ac86e3e5a6df68dcbe2f39">location</a>;                           <span class="comment">/* location of instruction documentation */</span>
<a name="l00380"></a>00380     };
<a name="l00381"></a>00381 
<a name="l00382"></a><a class="code" href="classAssemblerX86.html#204f87ef5e30dd1d57196fd2d81e6ebf">00382</a>     <span class="keyword">enum</span> <a class="code" href="classAssemblerX86.html#204f87ef5e30dd1d57196fd2d81e6ebf">MemoryReferencePattern</a> 
<a name="l00383"></a>00383         {
<a name="l00384"></a>00384         <a class="code" href="classAssemblerX86.html#204f87ef5e30dd1d57196fd2d81e6ebfcb3935dbc7f30f9ba719780485c72c84">mrp_unknown</a>,
<a name="l00385"></a>00385         <a class="code" href="classAssemblerX86.html#204f87ef5e30dd1d57196fd2d81e6ebf35bf7b67d552ebd993409433b6dc2cc3">mrp_disp</a>,                       <span class="comment">/* displacement */</span>
<a name="l00386"></a>00386         <a class="code" href="classAssemblerX86.html#204f87ef5e30dd1d57196fd2d81e6ebfeb23319e60be002c72befd588ce9d214">mrp_index</a>,                      <span class="comment">/* register*scale */</span>
<a name="l00387"></a>00387         <a class="code" href="classAssemblerX86.html#204f87ef5e30dd1d57196fd2d81e6ebf4fb7bfa77da1ef968303952540f24a09">mrp_index_disp</a>,                 <span class="comment">/* register*scale + displacement */</span>
<a name="l00388"></a>00388         <a class="code" href="classAssemblerX86.html#204f87ef5e30dd1d57196fd2d81e6ebfa66205af45303370304198fc00ad9b43">mrp_base</a>,                       <span class="comment">/* register */</span>
<a name="l00389"></a>00389         <a class="code" href="classAssemblerX86.html#204f87ef5e30dd1d57196fd2d81e6ebf88577037350c6011b8ea965d2965031e">mrp_base_disp</a>,                  <span class="comment">/* register + displacement */</span>
<a name="l00390"></a>00390         <a class="code" href="classAssemblerX86.html#204f87ef5e30dd1d57196fd2d81e6ebf905e109835e860f083ba5bffce0bfe83">mrp_base_index</a>,                 <span class="comment">/* register + register*scale */</span>
<a name="l00391"></a>00391         <a class="code" href="classAssemblerX86.html#204f87ef5e30dd1d57196fd2d81e6ebf99678e9ea5adecbeafaf107275b6b6a5">mrp_base_index_disp</a>             <span class="comment">/* register + register*scale + displacement */</span>
<a name="l00392"></a>00392     };
<a name="l00393"></a>00393 
<a name="l00395"></a><a class="code" href="classAssemblerX86.html#b8f002aff93ce57df6fba27649898570">00395</a>     <span class="keyword">typedef</span> std::vector&lt;const InsnDefn*&gt; <a class="code" href="classAssemblerX86.html#b8f002aff93ce57df6fba27649898570">DictionaryPage</a>;
<a name="l00396"></a>00396 
<a name="l00398"></a><a class="code" href="classAssemblerX86.html#3b6b574ffa4468a219611e0909c92328">00398</a>     <span class="keyword">typedef</span> std::map&lt;X86InstructionKind, DictionaryPage&gt; <a class="code" href="classAssemblerX86.html#3b6b574ffa4468a219611e0909c92328">InsnDictionary</a>;
<a name="l00399"></a>00399 
<a name="l00401"></a>00401     <span class="keyword">static</span> <span class="keywordtype">void</span> <a class="code" href="classAssemblerX86.html#085fe2ae49db4cb901762d2dd8cd746b">initAssemblyRules</a>();
<a name="l00402"></a>00402     <span class="keyword">static</span> <span class="keywordtype">void</span> <a class="code" href="classAssemblerX86.html#d875527259651989abfbd9f548172ea7">initAssemblyRules_part1</a>();
<a name="l00403"></a>00403     <span class="keyword">static</span> <span class="keywordtype">void</span> <a class="code" href="classAssemblerX86.html#83110bec629d5859a37d563b3a444ab9">initAssemblyRules_part2</a>();
<a name="l00404"></a>00404     <span class="keyword">static</span> <span class="keywordtype">void</span> <a class="code" href="classAssemblerX86.html#bb3452c0ebf3b909c1292a8df4c274f3">initAssemblyRules_part3</a>();
<a name="l00405"></a>00405     <span class="keyword">static</span> <span class="keywordtype">void</span> <a class="code" href="classAssemblerX86.html#833f872b3ed98d9d8eb0e000570ebbfd">initAssemblyRules_part4</a>();
<a name="l00406"></a>00406     <span class="keyword">static</span> <span class="keywordtype">void</span> <a class="code" href="classAssemblerX86.html#311360123030aa63e8b829a342a5d5af">initAssemblyRules_part5</a>();
<a name="l00407"></a>00407     <span class="keyword">static</span> <span class="keywordtype">void</span> <a class="code" href="classAssemblerX86.html#3a2c045f5bd6285d2e0374447693ddbd">initAssemblyRules_part6</a>();
<a name="l00408"></a>00408     <span class="keyword">static</span> <span class="keywordtype">void</span> <a class="code" href="classAssemblerX86.html#bf2f8698e840a1a51a24e6c893cf0d68">initAssemblyRules_part7</a>();
<a name="l00409"></a>00409     <span class="keyword">static</span> <span class="keywordtype">void</span> <a class="code" href="classAssemblerX86.html#ec7292b8bc6e60f918331f909878f70b">initAssemblyRules_part8</a>();
<a name="l00410"></a>00410     <span class="keyword">static</span> <span class="keywordtype">void</span> <a class="code" href="classAssemblerX86.html#6b1bef769b0cdd0d1e5974f99e74982f">initAssemblyRules_part9</a>();
<a name="l00411"></a>00411 
<a name="l00413"></a><a class="code" href="classAssemblerX86.html#3f2d26b834dfdd15dff8cceb1ca01ca2">00413</a>     <span class="keyword">static</span> <span class="keywordtype">void</span> <a class="code" href="classAssemblerX86.html#3f2d26b834dfdd15dff8cceb1ca01ca2">define</a>(<span class="keyword">const</span> <a class="code" href="classAssemblerX86_1_1InsnDefn.html">InsnDefn</a> *d) {
<a name="l00414"></a>00414         <a class="code" href="classAssemblerX86.html#0cd86fcbed61e176d8dd7292c392fa47">defns</a>[d-&gt;<a class="code" href="classAssemblerX86_1_1InsnDefn.html#1e3034fb4a991d3fe060c54d459ca3b3">kind</a>].push_back(d);
<a name="l00415"></a>00415     }
<a name="l00416"></a>00416     
<a name="l00420"></a>00420     <span class="keyword">static</span> std::string <a class="code" href="classAssemblerX86.html#1ee8ecae94bd836caf2ae03017028c6e">to_str</a>(<a class="code" href="AssemblerX86Init_8h.html#cb800e57ccb0a3ac5b7a89056bca5571">X86InstructionKind</a>);
<a name="l00421"></a>00421 
<a name="l00427"></a>00427     <a class="code" href="Cxx__Grammar_8h.html#4f57773a5fc8d0d005f7553cd47cbc4e">SgUnsignedCharList</a> <a class="code" href="classAssemblerX86.html#ae8fd5cebac1a8da068090922f95515f">fixup_prefix_bytes</a>(<a class="code" href="classSgAsmx86Instruction.html">SgAsmx86Instruction</a> *insn, <a class="code" href="Cxx__Grammar_8h.html#4f57773a5fc8d0d005f7553cd47cbc4e">SgUnsignedCharList</a> source);
<a name="l00428"></a>00428 
<a name="l00431"></a>00431     <a class="code" href="Cxx__Grammar_8h.html#4f57773a5fc8d0d005f7553cd47cbc4e">SgUnsignedCharList</a> <a class="code" href="classAssemblerX86.html#40040d9edbb6d07c8b9ff1a55ec0ef4a">assemble</a>(<a class="code" href="classSgAsmx86Instruction.html">SgAsmx86Instruction</a> *insn, <span class="keyword">const</span> InsnDefn *defn);
<a name="l00432"></a>00432 
<a name="l00436"></a>00436     <span class="keywordtype">void</span> <a class="code" href="classAssemblerX86.html#2b674c012a1c7662946a9aa147b2b060">matches</a>(<span class="keyword">const</span> InsnDefn *defn, <a class="code" href="classSgAsmx86Instruction.html">SgAsmx86Instruction</a> *insn, int64_t *disp, int64_t *imm) <span class="keyword">const</span>;
<a name="l00437"></a>00437 
<a name="l00440"></a>00440     <span class="keywordtype">bool</span> <a class="code" href="classAssemblerX86.html#2b674c012a1c7662946a9aa147b2b060">matches</a>(<a class="code" href="classAssemblerX86.html#26cf2311d68def86620d868d9b407111">OperandDefn</a>, <a class="code" href="classSgAsmExpression.html">SgAsmExpression</a>*, <a class="code" href="classSgAsmInstruction.html">SgAsmInstruction</a>*, int64_t *disp, int64_t *imm) <span class="keyword">const</span>;
<a name="l00441"></a>00441 
<a name="l00443"></a>00443     <span class="keyword">static</span> <span class="keywordtype">bool</span> <a class="code" href="classAssemblerX86.html#78eacca68d997354dd31f508905dfee9">matches_rel</a>(<a class="code" href="classSgAsmInstruction.html">SgAsmInstruction</a>*, int64_t val, size_t nbytes);
<a name="l00444"></a>00444         
<a name="l00448"></a>00448     <span class="keyword">static</span> <a class="code" href="classAssemblerX86.html#204f87ef5e30dd1d57196fd2d81e6ebf">MemoryReferencePattern</a> <a class="code" href="classAssemblerX86.html#29ce64dbbc067c081e379372024a633e">parse_memref</a>(<a class="code" href="classSgAsmInstruction.html">SgAsmInstruction</a> *insn, <a class="code" href="classSgAsmMemoryReferenceExpression.html">SgAsmMemoryReferenceExpression</a> *expr,
<a name="l00449"></a>00449                                                <a class="code" href="classSgAsmx86RegisterReferenceExpression.html">SgAsmx86RegisterReferenceExpression</a> **base_reg<span class="comment">/*out*/</span>,
<a name="l00450"></a>00450                                                <a class="code" href="classSgAsmx86RegisterReferenceExpression.html">SgAsmx86RegisterReferenceExpression</a> **index_reg<span class="comment">/*out*/</span>,
<a name="l00451"></a>00451                                                <a class="code" href="classSgAsmValueExpression.html">SgAsmValueExpression</a> **scale<span class="comment">/*out*/</span>, <a class="code" href="classSgAsmValueExpression.html">SgAsmValueExpression</a> **displacement<span class="comment">/*out*/</span>);
<a name="l00452"></a>00452 
<a name="l00454"></a>00454     uint8_t <a class="code" href="classAssemblerX86.html#f429fa5e269039b144f60c131126e8ad">build_modrm</a>(<span class="keyword">const</span> InsnDefn*, <a class="code" href="classSgAsmx86Instruction.html">SgAsmx86Instruction</a>*, size_t argno,
<a name="l00455"></a>00455                         uint8_t *sib, int64_t *displacement, uint8_t *rex) <span class="keyword">const</span>;
<a name="l00456"></a>00456 
<a name="l00458"></a>00458     <span class="keywordtype">void</span> <a class="code" href="classAssemblerX86.html#803d14b2755c2afe37a806b1704a84f9">build_modreg</a>(<span class="keyword">const</span> InsnDefn*, <a class="code" href="classSgAsmx86Instruction.html">SgAsmx86Instruction</a>*, size_t argno, uint8_t *modrm, uint8_t *rex) <span class="keyword">const</span>;
<a name="l00459"></a>00459 
<a name="l00462"></a>00462     uint8_t <a class="code" href="classAssemblerX86.html#32fadb25541189b9ceeac7c9aafaf493">segment_override</a>(<a class="code" href="classSgAsmx86Instruction.html">SgAsmx86Instruction</a>*);
<a name="l00463"></a>00463 
<a name="l00464"></a><a class="code" href="classAssemblerX86.html#0cd86fcbed61e176d8dd7292c392fa47">00464</a>     <span class="keyword">static</span> <a class="code" href="classAssemblerX86.html#3b6b574ffa4468a219611e0909c92328">InsnDictionary</a> <a class="code" href="classAssemblerX86.html#0cd86fcbed61e176d8dd7292c392fa47">defns</a>;                
<a name="l00465"></a><a class="code" href="classAssemblerX86.html#824c9d859366886fce48d0d44596356c">00465</a>     <span class="keywordtype">bool</span> <a class="code" href="classAssemblerX86.html#824c9d859366886fce48d0d44596356c">honor_operand_types</a>;                   
<a name="l00466"></a>00466 };
<a name="l00467"></a>00467 
<a name="l00468"></a>00468 <span class="preprocessor">#endif</span>
</pre></div><hr size="1"><address style="align: right;"><small>Generated on 20 Jan 2013 for ROSE by&nbsp;
<a href="http://www.doxygen.org/index.html">
<img src="doxygen.png" alt="doxygen" align="middle" border="0"></a> 1.4.7 </small></address>
</body>
</html>
