<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head><meta http-equiv="Content-Type" content="text/html;charset=iso-8859-1">
<title>ROSE: detectFunctionStarts.C File Reference</title>
<link href="doxygen.css" rel="stylesheet" type="text/css">
</head><body>
<!-- Generated by Doxygen 1.3.9.1 -->
<div class="qindex"><a class="qindex" href="main.html">Main&nbsp;Page</a> | <a class="qindex" href="modules.html">Modules</a> | <a class="qindex" href="namespaces.html">Namespace List</a> | <a class="qindex" href="hierarchy.html">Class&nbsp;Hierarchy</a> | <a class="qindex" href="annotated.html">Class&nbsp;List</a> | <a class="qindex" href="dirs.html">Directories</a> | <a class="qindex" href="files.html">File&nbsp;List</a> | <a class="qindex" href="namespacemembers.html">Namespace&nbsp;Members</a> | <a class="qindex" href="functions.html">Class&nbsp;Members</a> | <a class="qindex" href="globals.html">File&nbsp;Members</a> | <a class="qindex" href="pages.html">Related&nbsp;Pages</a></div>
<div class="nav">
<a class="el" href="dir_000000.html">sourcetree</a>&nbsp;/&nbsp;<a class="el" href="dir_000001.html">src</a>&nbsp;/&nbsp;<a class="el" href="dir_000003.html">frontend</a>&nbsp;/&nbsp;<a class="el" href="dir_000020.html">Disassemblers</a></div>
<h1>detectFunctionStarts.C File Reference</h1>
<p>
<code>#include "rose.h"</code><br>
<code>#include &lt;inttypes.h&gt;</code><br>

<p>
Include dependency graph for detectFunctionStarts.C:<p><center><img src="detectFunctionStarts_8C__incl.png" border="0" usemap="#detectFunctionStarts.C_map" alt="Include dependency graph"></center>
<table border="0" cellpadding="0" cellspacing="0">
<tr><td></td></tr>
<tr><td colspan="2"><br><h2>Namespaces</h2></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">namespace &nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespaceDisassemblerCommon.html">DisassemblerCommon</a></td></tr>

<tr><td colspan="2"><br><h2>Defines</h2></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="detectFunctionStarts_8C.html#a0">__STDC_FORMAT_MACROS</a></td></tr>

<tr><td colspan="2"><br><h2>Functions</h2></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="el" href="Cxx__Grammar_8h.html#a7">rose_addr_t</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespaceDisassemblerCommon.html#a0">value_of</a> (<a class="el" href="classSgAsmValueExpression.html">SgAsmValueExpression</a> *e)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="el" href="Cxx__Grammar_8h.html#a7">rose_addr_t</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespaceDisassemblerCommon.html#a1">get_indirection_addr</a> (<a class="el" href="classSgAsmInstruction.html">SgAsmInstruction</a> *g_insn)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespaceDisassemblerCommon.html#a2">mark_entry_targets</a> (<a class="el" href="classSgAsmInterpretation.html">SgAsmInterpretation</a> *interp, std::map&lt; uint64_t, <a class="el" href="classSgAsmInstruction.html">SgAsmInstruction</a> * &gt; &amp;insns, FunctionStarts &amp;func_starts)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespaceDisassemblerCommon.html#a3">mark_call_targets</a> (<a class="el" href="classSgAsmInterpretation.html">SgAsmInterpretation</a> *interp, std::map&lt; uint64_t, <a class="el" href="classSgAsmInstruction.html">SgAsmInstruction</a> * &gt; &amp;insns, FunctionStarts &amp;func_starts)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespaceDisassemblerCommon.html#a4">mark_eh_frames</a> (<a class="el" href="classSgAsmInterpretation.html">SgAsmInterpretation</a> *interp, std::map&lt; uint64_t, <a class="el" href="classSgAsmInstruction.html">SgAsmInstruction</a> * &gt; &amp;insns, FunctionStarts &amp;func_starts)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespaceDisassemblerCommon.html#a5">mark_func_symbols</a> (<a class="el" href="classSgAsmInterpretation.html">SgAsmInterpretation</a> *interp, std::map&lt; uint64_t, <a class="el" href="classSgAsmInstruction.html">SgAsmInstruction</a> * &gt; &amp;insns, FunctionStarts &amp;func_starts)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespaceDisassemblerCommon.html#a6">mark_graph_edges</a> (<a class="el" href="classSgAsmInterpretation.html">SgAsmInterpretation</a> *interp, std::map&lt; uint64_t, <a class="el" href="classSgAsmInstruction.html">SgAsmInstruction</a> * &gt; &amp;insns, BasicBlockStarts &amp;basicBlockStarts, FunctionStarts &amp;functionStarts)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespaceDisassemblerCommon.html#a7">name_plt_entries</a> (<a class="el" href="classSgAsmInterpretation.html">SgAsmInterpretation</a> *interp, std::map&lt; uint64_t, <a class="el" href="classSgAsmInstruction.html">SgAsmInstruction</a> * &gt; &amp;insns, FunctionStarts &amp;func_starts)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespaceDisassemblerCommon.html#a8">detectFunctionStarts</a> (<a class="el" href="classSgAsmInterpretation.html">SgAsmInterpretation</a> *interp, std::map&lt; uint64_t, <a class="el" href="classSgAsmInstruction.html">SgAsmInstruction</a> * &gt; &amp;insns, BasicBlockStarts &amp;basicBlockStarts, FunctionStarts &amp;functionStarts)</td></tr>

</table>
<hr><h2>Define Documentation</h2>
<a class="anchor" name="a0" doxytag="detectFunctionStarts.C::__STDC_FORMAT_MACROS"></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">#define __STDC_FORMAT_MACROS          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
    </td>
  </tr>
</table>
<hr><h2>Function Documentation</h2>
<a class="anchor" name="file_a0" doxytag="detectFunctionStarts.C::value_of"></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"><a class="el" href="Cxx__Grammar_8h.html#a7">rose_addr_t</a> value_of           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top"><a class="el" href="classSgAsmValueExpression.html">SgAsmValueExpression</a> *&nbsp;</td>
          <td class="mdname1" valign="top" nowrap> <em>e</em>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap><code> [static]</code></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
    </td>
  </tr>
</table>
<a class="anchor" name="file_a1" doxytag="detectFunctionStarts.C::get_indirection_addr"></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"><a class="el" href="Cxx__Grammar_8h.html#a7">rose_addr_t</a> get_indirection_addr           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top"><a class="el" href="classSgAsmInstruction.html">SgAsmInstruction</a> *&nbsp;</td>
          <td class="mdname1" valign="top" nowrap> <em>g_insn</em>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap><code> [static]</code></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
    </td>
  </tr>
</table>
<a class="anchor" name="file_a2" doxytag="detectFunctionStarts.C::mark_entry_targets"></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">void mark_entry_targets           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top"><a class="el" href="classSgAsmInterpretation.html">SgAsmInterpretation</a> *&nbsp;</td>
          <td class="mdname" nowrap> <em>interp</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>std::map&lt; uint64_t, <a class="el" href="classSgAsmInstruction.html">SgAsmInstruction</a> * &gt; &amp;&nbsp;</td>
          <td class="mdname" nowrap> <em>insns</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>FunctionStarts &amp;&nbsp;</td>
          <td class="mdname" nowrap> <em>func_starts</em></td>
        </tr>
        <tr>
          <td class="md"></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"><code> [static]</code></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Marks program entry addresses (stored in the <a class="el" href="classSgAsmGenericHeader.html">SgAsmGenericHeader</a>) as functions.     </td>
  </tr>
</table>
<a class="anchor" name="file_a3" doxytag="detectFunctionStarts.C::mark_call_targets"></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">void mark_call_targets           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top"><a class="el" href="classSgAsmInterpretation.html">SgAsmInterpretation</a> *&nbsp;</td>
          <td class="mdname" nowrap> <em>interp</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>std::map&lt; uint64_t, <a class="el" href="classSgAsmInstruction.html">SgAsmInstruction</a> * &gt; &amp;&nbsp;</td>
          <td class="mdname" nowrap> <em>insns</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>FunctionStarts &amp;&nbsp;</td>
          <td class="mdname" nowrap> <em>func_starts</em></td>
        </tr>
        <tr>
          <td class="md"></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"><code> [static]</code></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Marks CALL targets as functions. Not all functions are called this way, but we assume that all appearances of a CALL-like instruction with a constant target which corresponds to the known address of an instruction causes that target to become the entry point of a function.<p>
Note: any CALL whose target is the next instruction is ignored since this usually just happens for ip-relative calls that need a reloc applied, and thus have a zero offset. Such calls are common in ELF object files contained in library archives (lib*.a).     </td>
  </tr>
</table>
<a class="anchor" name="file_a4" doxytag="detectFunctionStarts.C::mark_eh_frames"></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">void mark_eh_frames           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top"><a class="el" href="classSgAsmInterpretation.html">SgAsmInterpretation</a> *&nbsp;</td>
          <td class="mdname" nowrap> <em>interp</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>std::map&lt; uint64_t, <a class="el" href="classSgAsmInstruction.html">SgAsmInstruction</a> * &gt; &amp;&nbsp;</td>
          <td class="mdname" nowrap> <em>insns</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>FunctionStarts &amp;&nbsp;</td>
          <td class="mdname" nowrap> <em>func_starts</em></td>
        </tr>
        <tr>
          <td class="md"></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"><code> [static]</code></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Use the Frame Descriptor Entry Records of the ELF .eh_frame section to mark functions.     </td>
  </tr>
</table>
<a class="anchor" name="file_a5" doxytag="detectFunctionStarts.C::mark_func_symbols"></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">void mark_func_symbols           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top"><a class="el" href="classSgAsmInterpretation.html">SgAsmInterpretation</a> *&nbsp;</td>
          <td class="mdname" nowrap> <em>interp</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>std::map&lt; uint64_t, <a class="el" href="classSgAsmInstruction.html">SgAsmInstruction</a> * &gt; &amp;&nbsp;</td>
          <td class="mdname" nowrap> <em>insns</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>FunctionStarts &amp;&nbsp;</td>
          <td class="mdname" nowrap> <em>func_starts</em></td>
        </tr>
        <tr>
          <td class="md"></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"><code> [static]</code></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Use symbol tables to determine function entry points.     </td>
  </tr>
</table>
<a class="anchor" name="file_a6" doxytag="detectFunctionStarts.C::mark_graph_edges"></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">void mark_graph_edges           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top"><a class="el" href="classSgAsmInterpretation.html">SgAsmInterpretation</a> *&nbsp;</td>
          <td class="mdname" nowrap> <em>interp</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>std::map&lt; uint64_t, <a class="el" href="classSgAsmInstruction.html">SgAsmInstruction</a> * &gt; &amp;&nbsp;</td>
          <td class="mdname" nowrap> <em>insns</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>BasicBlockStarts &amp;&nbsp;</td>
          <td class="mdname" nowrap> <em>basicBlockStarts</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>FunctionStarts &amp;&nbsp;</td>
          <td class="mdname" nowrap> <em>functionStarts</em></td>
        </tr>
        <tr>
          <td class="md"></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"><code> [static]</code></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Use the inter-basicblock branch information to determine the length of each function, creating new functions as necessary when a suspected function is shortened. We make the following assumptions: 1. Function entry points that are already determined will remain 2. The first (lowest address) basic block serves as the single entry point for a function. 3. The body of the function is contiguous basic blocks. 4. Each basic block that follows a function is the entry point of a subsequent function.     </td>
  </tr>
</table>
<a class="anchor" name="file_a7" doxytag="detectFunctionStarts.C::name_plt_entries"></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">void name_plt_entries           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top"><a class="el" href="classSgAsmInterpretation.html">SgAsmInterpretation</a> *&nbsp;</td>
          <td class="mdname" nowrap> <em>interp</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>std::map&lt; uint64_t, <a class="el" href="classSgAsmInstruction.html">SgAsmInstruction</a> * &gt; &amp;&nbsp;</td>
          <td class="mdname" nowrap> <em>insns</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>FunctionStarts &amp;&nbsp;</td>
          <td class="mdname" nowrap> <em>func_starts</em></td>
        </tr>
        <tr>
          <td class="md"></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"><code> [static]</code></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Give names to the dynamic linking trampolines in the .plt section. This method must be called after function entry points are detected since all it does is give names to functions that already exist.     </td>
  </tr>
</table>
<a class="anchor" name="file_a8" doxytag="detectFunctionStarts.C::detectFunctionStarts"></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">void detectFunctionStarts           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top"><a class="el" href="classSgAsmInterpretation.html">SgAsmInterpretation</a> *&nbsp;</td>
          <td class="mdname" nowrap> <em>interp</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>std::map&lt; uint64_t, <a class="el" href="classSgAsmInstruction.html">SgAsmInstruction</a> * &gt; &amp;&nbsp;</td>
          <td class="mdname" nowrap> <em>insns</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>BasicBlockStarts &amp;&nbsp;</td>
          <td class="mdname" nowrap> <em>basicBlockStarts</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>FunctionStarts &amp;&nbsp;</td>
          <td class="mdname" nowrap> <em>functionStarts</em></td>
        </tr>
        <tr>
          <td class="md"></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
    </td>
  </tr>
</table>
<hr size="1"><address style="align: right;"><small>Generated on Thu Jun 18 12:49:32 2009 for ROSE by&nbsp;
<a href="http://www.doxygen.org/index.html">
<img src="doxygen.png" alt="doxygen" align="middle" border="0"></a> 1.3.9.1 </small></address>
</body>
</html>
