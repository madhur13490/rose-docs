<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<title>ROSE: BinaryControlFlow.h Source File</title>

<link href="tabs.css" rel="stylesheet" type="text/css"/>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
</script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { searchBox.OnSelectItem(0); });
</script>

</head>
<body>
<div id="top"><!-- do not remove this div! -->


<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  
  
  <td style="padding-left: 0.5em;">
   <div id="projectname">ROSE
   &#160;<span id="projectnumber">0.9.5a</span>
   </div>
   
  </td>
  
  
  
 </tr>
 </tbody>
</table>
</div>

<!-- Generated by Doxygen 1.7.5.1 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="pages.html"><span>Related&#160;Pages</span></a></li>
      <li><a href="modules.html"><span>Modules</span></a></li>
      <li><a href="namespaces.html"><span>Namespaces</span></a></li>
      <li><a href="annotated.html"><span>Classes</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
      <li><a href="examples.html"><span>Examples</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="files.html"><span>File&#160;List</span></a></li>
      <li><a href="globals.html"><span>File&#160;Members</span></a></li>
    </ul>
  </div>
</div>
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
  initNavTree('BinaryControlFlow_8h.html','');
</script>
<div id="doc-content">
<div class="header">
  <div class="headertitle">
<div class="title">BinaryControlFlow.h</div>  </div>
</div>
<div class="contents">
<a href="BinaryControlFlow_8h.html">Go to the documentation of this file.</a><div class="fragment"><pre class="fragment"><a name="l00001"></a>00001 <span class="preprocessor">#ifndef ROSE_BinaryAnalysis_ControlFlow_H</span>
<a name="l00002"></a>00002 <span class="preprocessor"></span><span class="preprocessor">#define ROSE_BinaryAnalysis_ControlFlow_H</span>
<a name="l00003"></a>00003 <span class="preprocessor"></span>
<a name="l00004"></a><a class="code" href="BinaryControlFlow_8h.html#aacbb9e1f38be71e22df1584a37c56693">00004</a> <span class="preprocessor">#define __STDC_FORMAT_MACROS</span>
<a name="l00005"></a>00005 <span class="preprocessor"></span><span class="preprocessor">#include &lt;inttypes.h&gt;</span>
<a name="l00006"></a>00006 
<a name="l00007"></a>00007 <span class="preprocessor">#include &lt;boost/graph/adjacency_list.hpp&gt;</span>
<a name="l00008"></a>00008 <span class="preprocessor">#include &lt;boost/graph/depth_first_search.hpp&gt;</span>
<a name="l00009"></a>00009 
<a name="l00010"></a>00010 <span class="keyword">class </span><a class="code" href="classSgNode.html" title="This class represents the base class for all IR nodes within Sage III.">SgNode</a>;
<a name="l00011"></a>00011 <span class="keyword">class </span><a class="code" href="classSgAsmBlock.html">SgAsmBlock</a>;
<a name="l00012"></a>00012 
<a name="l00014"></a><a class="code" href="namespaceBinaryAnalysis.html">00014</a> <span class="keyword">namespace </span>BinaryAnalysis {
<a name="l00015"></a>00015 
<a name="l00115"></a><a class="code" href="classBinaryAnalysis_1_1ControlFlow.html">00115</a>     <span class="keyword">class </span><a class="code" href="classBinaryAnalysis_1_1ControlFlow.html" title="Binary control flow analysis.">ControlFlow</a> {
<a name="l00116"></a>00116     <span class="keyword">public</span>:
<a name="l00117"></a><a class="code" href="classBinaryAnalysis_1_1ControlFlow.html#ad94587a729936415c40e65d1c274b0b2">00117</a>         <a class="code" href="classBinaryAnalysis_1_1ControlFlow.html#ad94587a729936415c40e65d1c274b0b2">ControlFlow</a>()
<a name="l00118"></a>00118             : <a class="code" href="classBinaryAnalysis_1_1ControlFlow.html#a86fb22efa66d4b6a8562cb67e33c6781">vertex_filter</a>(NULL), <a class="code" href="classBinaryAnalysis_1_1ControlFlow.html#a80d77204cf9f714828a775faff29dfac">edge_filter</a>(NULL)
<a name="l00119"></a>00119             {}
<a name="l00120"></a>00120         
<a name="l00121"></a>00121 
<a name="l00140"></a>00140         <span class="keyword">typedef</span> boost::adjacency_list&lt;boost::setS,                                  <span class="comment">/* edges of each vertex in std::list */</span>
<a name="l00141"></a>00141                                       boost::vecS,                                  <span class="comment">/* vertices in std::vector */</span>
<a name="l00142"></a>00142                                       boost::bidirectionalS,
<a name="l00143"></a><a class="code" href="classBinaryAnalysis_1_1ControlFlow.html#ad704a3d62401287d23f40c0aed8b70e8">00143</a>                                       boost::property&lt;boost::vertex_name_t, SgAsmBlock*&gt; &gt; <a class="code" href="classBinaryAnalysis_1_1ControlFlow.html#ad704a3d62401287d23f40c0aed8b70e8" title="Default control flow graph type.">Graph</a>;
<a name="l00144"></a>00144 
<a name="l00145"></a>00145         <span class="comment">/**********************************************************************************************************************</span>
<a name="l00146"></a>00146 <span class="comment">         *                                      Filters</span>
<a name="l00147"></a>00147 <span class="comment">         **********************************************************************************************************************/</span>
<a name="l00148"></a>00148     <span class="keyword">public</span>:
<a name="l00149"></a>00149 
<a name="l00154"></a><a class="code" href="classBinaryAnalysis_1_1ControlFlow_1_1VertexFilter.html">00154</a>         <span class="keyword">class </span><a class="code" href="classBinaryAnalysis_1_1ControlFlow_1_1VertexFilter.html" title="Filter for vertices.">VertexFilter</a> {
<a name="l00155"></a>00155         <span class="keyword">public</span>:
<a name="l00156"></a><a class="code" href="classBinaryAnalysis_1_1ControlFlow_1_1VertexFilter.html#ad09982449414dfe8626cee63eadf11d6">00156</a>             <span class="keyword">virtual</span> <a class="code" href="classBinaryAnalysis_1_1ControlFlow_1_1VertexFilter.html#ad09982449414dfe8626cee63eadf11d6">~VertexFilter</a>() {}
<a name="l00157"></a>00157             <span class="keyword">virtual</span> <span class="keywordtype">bool</span> <a class="code" href="classBinaryAnalysis_1_1ControlFlow_1_1VertexFilter.html#a903dbeb2b8c770899cfa060d408bc14f">operator()</a>(<a class="code" href="classBinaryAnalysis_1_1ControlFlow.html" title="Binary control flow analysis.">ControlFlow</a>*, <a class="code" href="classSgAsmBlock.html">SgAsmBlock</a>*) = 0;
<a name="l00158"></a>00158         };
<a name="l00159"></a>00159 
<a name="l00164"></a><a class="code" href="classBinaryAnalysis_1_1ControlFlow_1_1EdgeFilter.html">00164</a>         <span class="keyword">class </span><a class="code" href="classBinaryAnalysis_1_1ControlFlow_1_1EdgeFilter.html" title="Filter for edges.">EdgeFilter</a> {
<a name="l00165"></a>00165         <span class="keyword">public</span>:
<a name="l00166"></a><a class="code" href="classBinaryAnalysis_1_1ControlFlow_1_1EdgeFilter.html#a62d86d9b6a325dad772572f5ca126385">00166</a>             <span class="keyword">virtual</span> <a class="code" href="classBinaryAnalysis_1_1ControlFlow_1_1EdgeFilter.html#a62d86d9b6a325dad772572f5ca126385">~EdgeFilter</a>() {}
<a name="l00167"></a>00167             <span class="keyword">virtual</span> <span class="keywordtype">bool</span> <a class="code" href="classBinaryAnalysis_1_1ControlFlow_1_1EdgeFilter.html#a19dcb012a144251e23442267b046ffca">operator()</a>(<a class="code" href="classBinaryAnalysis_1_1ControlFlow.html" title="Binary control flow analysis.">ControlFlow</a>*, <a class="code" href="classSgAsmBlock.html">SgAsmBlock</a> *source, <a class="code" href="classSgAsmBlock.html">SgAsmBlock</a> *target) = 0;
<a name="l00168"></a>00168         };
<a name="l00169"></a>00169 
<a name="l00177"></a><a class="code" href="classBinaryAnalysis_1_1ControlFlow.html#a8c601fcc466e5264ac2b95a9b97b4972">00177</a>         <span class="keywordtype">void</span> <a class="code" href="classBinaryAnalysis_1_1ControlFlow.html#a8c601fcc466e5264ac2b95a9b97b4972" title="Manipulate the vertex filter.">set_vertex_filter</a>(<a class="code" href="classBinaryAnalysis_1_1ControlFlow_1_1VertexFilter.html" title="Filter for vertices.">VertexFilter</a> *filter) { <a class="code" href="classBinaryAnalysis_1_1ControlFlow.html#a86fb22efa66d4b6a8562cb67e33c6781">vertex_filter</a> = filter; }
<a name="l00178"></a><a class="code" href="classBinaryAnalysis_1_1ControlFlow.html#a0e956b6a5e301fddce57bdc560bc1e07">00178</a>         <a class="code" href="classBinaryAnalysis_1_1ControlFlow_1_1VertexFilter.html" title="Filter for vertices.">VertexFilter</a> *<a class="code" href="classBinaryAnalysis_1_1ControlFlow.html#a0e956b6a5e301fddce57bdc560bc1e07" title="Manipulate the vertex filter.">get_vertex_filter</a>()<span class="keyword"> const </span>{ <span class="keywordflow">return</span> <a class="code" href="classBinaryAnalysis_1_1ControlFlow.html#a86fb22efa66d4b6a8562cb67e33c6781">vertex_filter</a>; }
<a name="l00187"></a><a class="code" href="classBinaryAnalysis_1_1ControlFlow.html#abcf4d93c4f4c729804a2f2d2aa4fa016">00187</a>         <span class="keywordtype">void</span> <a class="code" href="classBinaryAnalysis_1_1ControlFlow.html#abcf4d93c4f4c729804a2f2d2aa4fa016" title="Manipulate the edge filter.">set_edge_filter</a>(<a class="code" href="classBinaryAnalysis_1_1ControlFlow_1_1EdgeFilter.html" title="Filter for edges.">EdgeFilter</a> *filter) { <a class="code" href="classBinaryAnalysis_1_1ControlFlow.html#a80d77204cf9f714828a775faff29dfac">edge_filter</a> = filter; }
<a name="l00188"></a><a class="code" href="classBinaryAnalysis_1_1ControlFlow.html#acaa73fc90ba2d46bde1beb8ad7076c58">00188</a>         <a class="code" href="classBinaryAnalysis_1_1ControlFlow_1_1EdgeFilter.html" title="Filter for edges.">EdgeFilter</a> *<a class="code" href="classBinaryAnalysis_1_1ControlFlow.html#acaa73fc90ba2d46bde1beb8ad7076c58" title="Manipulate the edge filter.">get_edge_filter</a>()<span class="keyword"> const </span>{ <span class="keywordflow">return</span> <a class="code" href="classBinaryAnalysis_1_1ControlFlow.html#a80d77204cf9f714828a775faff29dfac">edge_filter</a>; }
<a name="l00196"></a><a class="code" href="classBinaryAnalysis_1_1ControlFlow.html#a5e6e8bcad74de9f7774aaef4b020551b">00196</a>         <span class="keywordtype">bool</span> <a class="code" href="classBinaryAnalysis_1_1ControlFlow.html#a5e6e8bcad74de9f7774aaef4b020551b" title="Determines if a vertex is filtered out.">is_vertex_filtered</a>(<a class="code" href="classSgAsmBlock.html">SgAsmBlock</a> *block, <a class="code" href="classBinaryAnalysis_1_1ControlFlow_1_1VertexFilter.html" title="Filter for vertices.">VertexFilter</a> *filter) { <span class="keywordflow">return</span> filter &amp;&amp; !(*filter)(<span class="keyword">this</span>, block); }
<a name="l00197"></a><a class="code" href="classBinaryAnalysis_1_1ControlFlow.html#a5d79bb2dd20a320394a688bec0ca745f">00197</a>         <span class="keywordtype">bool</span> <a class="code" href="classBinaryAnalysis_1_1ControlFlow.html#a5d79bb2dd20a320394a688bec0ca745f" title="Determines if a vertex is filtered out.">is_vertex_filtered</a>(<a class="code" href="classSgAsmBlock.html">SgAsmBlock</a> *block) { <span class="keywordflow">return</span> <a class="code" href="classBinaryAnalysis_1_1ControlFlow.html#a5d79bb2dd20a320394a688bec0ca745f" title="Determines if a vertex is filtered out.">is_vertex_filtered</a>(block, <a class="code" href="classBinaryAnalysis_1_1ControlFlow.html#a86fb22efa66d4b6a8562cb67e33c6781">vertex_filter</a>); }
<a name="l00205"></a><a class="code" href="classBinaryAnalysis_1_1ControlFlow.html#aa5f92125604556805185b1093276cbbd">00205</a>         <span class="keywordtype">bool</span> <a class="code" href="classBinaryAnalysis_1_1ControlFlow.html#aa5f92125604556805185b1093276cbbd" title="Determines if an edge is filtered out.">is_edge_filtered</a>(<a class="code" href="classSgAsmBlock.html">SgAsmBlock</a> *src, <a class="code" href="classSgAsmBlock.html">SgAsmBlock</a> *dst, <a class="code" href="classBinaryAnalysis_1_1ControlFlow_1_1EdgeFilter.html" title="Filter for edges.">EdgeFilter</a> *filter) {
<a name="l00206"></a>00206             <span class="keywordflow">return</span> filter &amp;&amp; !(*filter)(<span class="keyword">this</span>, src, dst);
<a name="l00207"></a>00207         }
<a name="l00208"></a><a class="code" href="classBinaryAnalysis_1_1ControlFlow.html#acfa4725abb0f7dfb9c3fae68e52ce021">00208</a>         <span class="keywordtype">bool</span> <a class="code" href="classBinaryAnalysis_1_1ControlFlow.html#acfa4725abb0f7dfb9c3fae68e52ce021" title="Determines if an edge is filtered out.">is_edge_filtered</a>(<a class="code" href="classSgAsmBlock.html">SgAsmBlock</a> *src, <a class="code" href="classSgAsmBlock.html">SgAsmBlock</a> *dst) {
<a name="l00209"></a>00209             <span class="keywordflow">return</span> <a class="code" href="classBinaryAnalysis_1_1ControlFlow.html#aa5f92125604556805185b1093276cbbd" title="Determines if an edge is filtered out.">is_edge_filtered</a>(src, dst, <a class="code" href="classBinaryAnalysis_1_1ControlFlow.html#a80d77204cf9f714828a775faff29dfac">edge_filter</a>);
<a name="l00210"></a>00210         }
<a name="l00213"></a>00213     <span class="keyword">protected</span>:
<a name="l00214"></a><a class="code" href="classBinaryAnalysis_1_1ControlFlow.html#a86fb22efa66d4b6a8562cb67e33c6781">00214</a>         <a class="code" href="classBinaryAnalysis_1_1ControlFlow_1_1VertexFilter.html" title="Filter for vertices.">VertexFilter</a> *<a class="code" href="classBinaryAnalysis_1_1ControlFlow.html#a86fb22efa66d4b6a8562cb67e33c6781">vertex_filter</a>;
<a name="l00215"></a><a class="code" href="classBinaryAnalysis_1_1ControlFlow.html#a80d77204cf9f714828a775faff29dfac">00215</a>         <a class="code" href="classBinaryAnalysis_1_1ControlFlow_1_1EdgeFilter.html" title="Filter for edges.">EdgeFilter</a> *<a class="code" href="classBinaryAnalysis_1_1ControlFlow.html#a80d77204cf9f714828a775faff29dfac">edge_filter</a>;
<a name="l00216"></a>00216 
<a name="l00217"></a>00217         <span class="comment">/**********************************************************************************************************************</span>
<a name="l00218"></a>00218 <span class="comment">         *                                      Methods that modify the AST</span>
<a name="l00219"></a>00219 <span class="comment">         **********************************************************************************************************************/</span>
<a name="l00220"></a>00220     <span class="keyword">public</span>:
<a name="l00221"></a>00221 
<a name="l00228"></a>00228         <span class="keywordtype">void</span> <a class="code" href="classBinaryAnalysis_1_1ControlFlow.html#a4c1d71eaa352ed643ebab2ed32c065f0" title="Clears successor information from the AST.">clear_ast</a>(<a class="code" href="classSgNode.html" title="This class represents the base class for all IR nodes within Sage III.">SgNode</a> *ast);
<a name="l00229"></a>00229 
<a name="l00239"></a>00239         <span class="keyword">template</span>&lt;<span class="keyword">class</span> ControlFlowGraph&gt;
<a name="l00240"></a>00240         <span class="keywordtype">void</span> <a class="code" href="classBinaryAnalysis_1_1ControlFlow.html#a310b6f962abf974e1b11eab2adee75f5" title="Applies graph to AST.">apply_to_ast</a>(<span class="keyword">const</span> ControlFlowGraph&amp;);
<a name="l00241"></a>00241 
<a name="l00255"></a>00255         <span class="keyword">template</span>&lt;<span class="keyword">class</span> ControlFlowGraph&gt;
<a name="l00256"></a>00256         <span class="keywordtype">void</span> <a class="code" href="classBinaryAnalysis_1_1ControlFlow.html#a14567bd8326f28398c92a7e0336d4db2" title="Cache vertex descriptors in AST.">cache_vertex_descriptors</a>(<span class="keyword">const</span> ControlFlowGraph&amp;);
<a name="l00257"></a>00257 
<a name="l00258"></a>00258         <span class="comment">/**********************************************************************************************************************</span>
<a name="l00259"></a>00259 <span class="comment">         *                                      Graph construction methods</span>
<a name="l00260"></a>00260 <span class="comment">         **********************************************************************************************************************/</span>
<a name="l00261"></a>00261     <span class="keyword">public</span>:
<a name="l00262"></a>00262 
<a name="l00282"></a>00282         <span class="keyword">template</span>&lt;<span class="keyword">class</span> ControlFlowGraph&gt;
<a name="l00283"></a>00283         ControlFlowGraph <a class="code" href="classBinaryAnalysis_1_1ControlFlow.html#aacbfd1c9c77baee618228c5e4934cbeb" title="Builds a control flow graph for part of an AST.">build_cfg_from_ast</a>(<a class="code" href="classSgNode.html" title="This class represents the base class for all IR nodes within Sage III.">SgNode</a> *root);
<a name="l00284"></a>00284 
<a name="l00285"></a>00285         <span class="keyword">template</span>&lt;<span class="keyword">class</span> ControlFlowGraph&gt;
<a name="l00286"></a>00286         <span class="keywordtype">void</span> <a class="code" href="classBinaryAnalysis_1_1ControlFlow.html#aacbfd1c9c77baee618228c5e4934cbeb" title="Builds a control flow graph for part of an AST.">build_cfg_from_ast</a>(<a class="code" href="classSgNode.html" title="This class represents the base class for all IR nodes within Sage III.">SgNode</a> *root, ControlFlowGraph &amp;cfg<span class="comment">/*out*/</span>);
<a name="l00298"></a>00298         <span class="keyword">template</span>&lt;<span class="keyword">class</span> ControlFlowGraph&gt;
<a name="l00299"></a>00299         ControlFlowGraph <a class="code" href="classBinaryAnalysis_1_1ControlFlow.html#a7e084fca4986332d543aa90e442bdf00" title="Builds a control flow graph with only function call edges.">build_cg_from_ast</a>(<a class="code" href="classSgNode.html" title="This class represents the base class for all IR nodes within Sage III.">SgNode</a> *root);
<a name="l00300"></a>00300 
<a name="l00301"></a>00301         <span class="keyword">template</span>&lt;<span class="keyword">class</span> ControlFlowGraph&gt;
<a name="l00302"></a>00302         <span class="keywordtype">void</span> <a class="code" href="classBinaryAnalysis_1_1ControlFlow.html#a7e084fca4986332d543aa90e442bdf00" title="Builds a control flow graph with only function call edges.">build_cg_from_ast</a>(<a class="code" href="classSgNode.html" title="This class represents the base class for all IR nodes within Sage III.">SgNode</a> *root, ControlFlowGraph &amp;cfg<span class="comment">/*out*/</span>);
<a name="l00315"></a>00315         <span class="keyword">template</span>&lt;<span class="keyword">class</span> ControlFlowGraph&gt;
<a name="l00316"></a>00316         ControlFlowGraph <a class="code" href="classBinaryAnalysis_1_1ControlFlow.html#a5ff8f19f83b57e1e52d11b30cee174b8" title="Copies a graph while filtering.">copy</a>(<span class="keyword">const</span> ControlFlowGraph &amp;src);
<a name="l00317"></a>00317 
<a name="l00318"></a>00318         <span class="keyword">template</span>&lt;<span class="keyword">class</span> ControlFlowGraph&gt;
<a name="l00319"></a>00319         <span class="keywordtype">void</span> <a class="code" href="classBinaryAnalysis_1_1ControlFlow.html#a5ff8f19f83b57e1e52d11b30cee174b8" title="Copies a graph while filtering.">copy</a>(<span class="keyword">const</span> ControlFlowGraph &amp;src, ControlFlowGraph &amp;dst<span class="comment">/*out*/</span>);
<a name="l00322"></a>00322         <span class="comment">/**********************************************************************************************************************</span>
<a name="l00323"></a>00323 <span class="comment">         *                                      Miscellaneous members</span>
<a name="l00324"></a>00324 <span class="comment">         **********************************************************************************************************************/</span>
<a name="l00325"></a>00325 
<a name="l00326"></a>00326     <span class="keyword">private</span>:
<a name="l00327"></a>00327         <span class="comment">/* Visitor used by flow_order().  Declaring this in function scope results in boost errors (boost-1.42, 2011-05). */</span>
<a name="l00328"></a>00328         <span class="keyword">template</span>&lt;<span class="keyword">class</span> ControlFlowGraph&gt;
<a name="l00329"></a><a class="code" href="structBinaryAnalysis_1_1ControlFlow_1_1FlowOrder.html">00329</a>         <span class="keyword">struct </span><a class="code" href="structBinaryAnalysis_1_1ControlFlow_1_1FlowOrder.html">FlowOrder</a>: <span class="keyword">public</span> boost::default_dfs_visitor {
<a name="l00330"></a><a class="code" href="structBinaryAnalysis_1_1ControlFlow_1_1FlowOrder.html#a3ed6228f9cd259e8cb6ca340e2fc39bc">00330</a>             <span class="keyword">typedef</span> <span class="keyword">typename</span> boost::graph_traits&lt;ControlFlowGraph&gt;::vertex_descriptor <a class="code" href="structBinaryAnalysis_1_1ControlFlow_1_1FlowOrder.html#a3ed6228f9cd259e8cb6ca340e2fc39bc">Vertex</a>;
<a name="l00331"></a><a class="code" href="structBinaryAnalysis_1_1ControlFlow_1_1FlowOrder.html#ac2ad6979c018ec72d22cb95c4b7208ed">00331</a>             <span class="keyword">typedef</span> std::vector&lt;Vertex&gt; <a class="code" href="structBinaryAnalysis_1_1ControlFlow_1_1FlowOrder.html#ac2ad6979c018ec72d22cb95c4b7208ed">VertexList</a>;
<a name="l00332"></a><a class="code" href="structBinaryAnalysis_1_1ControlFlow_1_1FlowOrder.html#a4335b4d700de1b01fd13835ce9d57637">00332</a>             <span class="keyword">typedef</span> std::vector&lt;size_t&gt; <a class="code" href="structBinaryAnalysis_1_1ControlFlow_1_1FlowOrder.html#a4335b4d700de1b01fd13835ce9d57637">ReverseVertexList</a>;
<a name="l00333"></a><a class="code" href="structBinaryAnalysis_1_1ControlFlow_1_1FlowOrder.html#afc060e6a0f0f98debfa1d648e632db51">00333</a>             <a class="code" href="structBinaryAnalysis_1_1ControlFlow_1_1FlowOrder.html#ac2ad6979c018ec72d22cb95c4b7208ed">VertexList</a> *<a class="code" href="structBinaryAnalysis_1_1ControlFlow_1_1FlowOrder.html#afc060e6a0f0f98debfa1d648e632db51">forward_order</a>;
<a name="l00334"></a><a class="code" href="structBinaryAnalysis_1_1ControlFlow_1_1FlowOrder.html#a04d860d1b02f111ccbb5c7b8e0b8ddcc">00334</a>             <a class="code" href="structBinaryAnalysis_1_1ControlFlow_1_1FlowOrder.html#a04d860d1b02f111ccbb5c7b8e0b8ddcc">FlowOrder</a>(<a class="code" href="structBinaryAnalysis_1_1ControlFlow_1_1FlowOrder.html#ac2ad6979c018ec72d22cb95c4b7208ed">VertexList</a> *<a class="code" href="structBinaryAnalysis_1_1ControlFlow_1_1FlowOrder.html#afc060e6a0f0f98debfa1d648e632db51">forward_order</a>): forward_order(forward_order) {}
<a name="l00335"></a>00335             <span class="keywordtype">void</span> <a class="code" href="structBinaryAnalysis_1_1ControlFlow_1_1FlowOrder.html#a22e5735c5cad972619db5c17d4f99603">compute</a>(<span class="keyword">const</span> ControlFlowGraph &amp;g, <a class="code" href="structBinaryAnalysis_1_1ControlFlow_1_1FlowOrder.html#a3ed6228f9cd259e8cb6ca340e2fc39bc">Vertex</a> v0, <a class="code" href="structBinaryAnalysis_1_1ControlFlow_1_1FlowOrder.html#a4335b4d700de1b01fd13835ce9d57637">ReverseVertexList</a> *reverse_order);
<a name="l00336"></a>00336             <span class="keywordtype">void</span> <a class="code" href="structBinaryAnalysis_1_1ControlFlow_1_1FlowOrder.html#a0e5c9c743d077c26c320f328e4e370f8">finish_vertex</a>(<a class="code" href="structBinaryAnalysis_1_1ControlFlow_1_1FlowOrder.html#a3ed6228f9cd259e8cb6ca340e2fc39bc">Vertex</a> v, ControlFlowGraph g);
<a name="l00337"></a>00337         };
<a name="l00338"></a>00338             
<a name="l00339"></a>00339     <span class="keyword">public</span>:
<a name="l00372"></a>00372         <span class="keyword">template</span>&lt;<span class="keyword">class</span> ControlFlowGraph&gt;
<a name="l00373"></a>00373         std::vector&lt;typename boost::graph_traits&lt;ControlFlowGraph&gt;::vertex_descriptor&gt;
<a name="l00374"></a>00374         <a class="code" href="classBinaryAnalysis_1_1ControlFlow.html#a6efa50703657c9b3521a9d3e961d265d" title="Orders nodes by depth first search reverse post order.">flow_order</a>(<span class="keyword">const</span> ControlFlowGraph&amp;,
<a name="l00375"></a>00375                    <span class="keyword">typename</span> boost::graph_traits&lt;ControlFlowGraph&gt;::vertex_descriptor start,
<a name="l00376"></a>00376                    std::vector&lt;size_t&gt; *reverse_order=NULL);
<a name="l00377"></a>00377 
<a name="l00378"></a>00378     <span class="keyword">private</span>:
<a name="l00379"></a>00379         <span class="comment">/* Visitor used by return_blocks(). Declaring this in function scope results in boost errors (boost-1.42, 2011-05). */</span>
<a name="l00380"></a>00380         <span class="keyword">template</span>&lt;<span class="keyword">class</span> ControlFlowGraph&gt;
<a name="l00381"></a><a class="code" href="structBinaryAnalysis_1_1ControlFlow_1_1ReturnBlocks.html">00381</a>         <span class="keyword">struct </span><a class="code" href="structBinaryAnalysis_1_1ControlFlow_1_1ReturnBlocks.html">ReturnBlocks</a>: <span class="keyword">public</span> boost::default_dfs_visitor {
<a name="l00382"></a><a class="code" href="structBinaryAnalysis_1_1ControlFlow_1_1ReturnBlocks.html#a21add2d6c0b3947c61092b0dd8ac7efc">00382</a>             <span class="keyword">typedef</span> <span class="keyword">typename</span> boost::graph_traits&lt;ControlFlowGraph&gt;::vertex_descriptor <a class="code" href="structBinaryAnalysis_1_1ControlFlow_1_1ReturnBlocks.html#a21add2d6c0b3947c61092b0dd8ac7efc">Vertex</a>;
<a name="l00383"></a><a class="code" href="structBinaryAnalysis_1_1ControlFlow_1_1ReturnBlocks.html#a5044ea2766d5c4dfd78b311fe6bd14ea">00383</a>             <span class="keyword">typedef</span> std::vector&lt;Vertex&gt; <a class="code" href="structBinaryAnalysis_1_1ControlFlow_1_1ReturnBlocks.html#a5044ea2766d5c4dfd78b311fe6bd14ea">Vector</a>;
<a name="l00384"></a><a class="code" href="structBinaryAnalysis_1_1ControlFlow_1_1ReturnBlocks.html#a9d24095c3a036fde3622770095c3a250">00384</a>             <a class="code" href="structBinaryAnalysis_1_1ControlFlow_1_1ReturnBlocks.html#a5044ea2766d5c4dfd78b311fe6bd14ea">Vector</a> &amp;<a class="code" href="structBinaryAnalysis_1_1ControlFlow_1_1ReturnBlocks.html#a9d24095c3a036fde3622770095c3a250">blocks</a>;
<a name="l00385"></a><a class="code" href="structBinaryAnalysis_1_1ControlFlow_1_1ReturnBlocks.html#a8350d96f1b749765e533ac57c983f4d6">00385</a>             <a class="code" href="structBinaryAnalysis_1_1ControlFlow_1_1ReturnBlocks.html#a8350d96f1b749765e533ac57c983f4d6">ReturnBlocks</a>(<a class="code" href="structBinaryAnalysis_1_1ControlFlow_1_1ReturnBlocks.html#a5044ea2766d5c4dfd78b311fe6bd14ea">Vector</a> &amp;<a class="code" href="structBinaryAnalysis_1_1ControlFlow_1_1ReturnBlocks.html#a9d24095c3a036fde3622770095c3a250">blocks</a>): blocks(blocks) {}
<a name="l00386"></a>00386             <span class="keywordtype">void</span> <a class="code" href="structBinaryAnalysis_1_1ControlFlow_1_1ReturnBlocks.html#a085b412b5d5dc3adfd4a86053786d9a9">finish_vertex</a>(<a class="code" href="structBinaryAnalysis_1_1ControlFlow_1_1ReturnBlocks.html#a21add2d6c0b3947c61092b0dd8ac7efc">Vertex</a> v, ControlFlowGraph g);
<a name="l00387"></a>00387         };
<a name="l00388"></a>00388 
<a name="l00389"></a>00389     <span class="keyword">public</span>:
<a name="l00395"></a>00395         <span class="keyword">template</span>&lt;<span class="keyword">class</span> ControlFlowGraph&gt;
<a name="l00396"></a>00396         std::vector&lt;typename boost::graph_traits&lt;ControlFlowGraph&gt;::vertex_descriptor&gt;
<a name="l00397"></a>00397         <a class="code" href="classBinaryAnalysis_1_1ControlFlow.html#a6a96acd6e23f8cec283a20bed4086bae" title="Returns list of function return blocks.">return_blocks</a>(<span class="keyword">const</span> ControlFlowGraph &amp;cfg,
<a name="l00398"></a>00398                       <span class="keyword">typename</span> boost::graph_traits&lt;ControlFlowGraph&gt;::vertex_descriptor start);
<a name="l00399"></a>00399     };
<a name="l00400"></a>00400 }
<a name="l00401"></a>00401 
<a name="l00402"></a>00402 
<a name="l00403"></a>00403 
<a name="l00404"></a>00404 
<a name="l00405"></a>00405 
<a name="l00406"></a>00406 <span class="comment">/******************************************************************************************************************************</span>
<a name="l00407"></a>00407 <span class="comment"> *                                      Function template definitions</span>
<a name="l00408"></a>00408 <span class="comment"> ******************************************************************************************************************************/</span>
<a name="l00409"></a>00409 
<a name="l00410"></a>00410 <span class="keyword">template</span>&lt;<span class="keyword">class</span> ControlFlowGraph&gt;
<a name="l00411"></a>00411 <span class="keywordtype">void</span>
<a name="l00412"></a><a class="code" href="classBinaryAnalysis_1_1ControlFlow.html#a310b6f962abf974e1b11eab2adee75f5">00412</a> <a class="code" href="classBinaryAnalysis_1_1ControlFlow.html#a310b6f962abf974e1b11eab2adee75f5" title="Applies graph to AST.">BinaryAnalysis::ControlFlow::apply_to_ast</a>(<span class="keyword">const</span> ControlFlowGraph &amp;cfg)
<a name="l00413"></a>00413 {
<a name="l00414"></a>00414     <span class="keyword">typename</span> boost::graph_traits&lt;ControlFlowGraph&gt;::vertex_iterator vi, vi_end;
<a name="l00415"></a>00415     <span class="keywordflow">for</span> (boost::tie(vi, vi_end)=vertices(cfg); vi!=vi_end; ++vi) {
<a name="l00416"></a>00416         <a class="code" href="classSgAsmBlock.html">SgAsmBlock</a> *block = <span class="keyword">get</span>(boost::vertex_name, cfg, *vi);
<a name="l00417"></a>00417         <span class="keywordflow">if</span> (!block || <a class="code" href="classBinaryAnalysis_1_1ControlFlow.html#a5e6e8bcad74de9f7774aaef4b020551b" title="Determines if a vertex is filtered out.">is_vertex_filtered</a>(block))
<a name="l00418"></a>00418             <span class="keywordflow">continue</span>;
<a name="l00419"></a>00419 
<a name="l00420"></a>00420         <span class="comment">/* Delete old targets */</span>
<a name="l00421"></a>00421         <span class="keyword">const</span> <a class="code" href="Cxx__Grammar_8h.html#af778ba3b929629b66fb8dffc3f20ccd3">SgAsmTargetPtrList</a> &amp;targets = block-&gt;<a class="code" href="classSgAsmBlock.html#aba2774c1d3c913d6a46cf3de05390336">get_successors</a>();
<a name="l00422"></a>00422         <span class="keywordflow">for</span> (SgAsmTargetPtrList::const_iterator ti=targets.begin(); ti!=targets.end(); ++ti)
<a name="l00423"></a>00423             <span class="keyword">delete</span> *ti;
<a name="l00424"></a>00424 
<a name="l00425"></a>00425         <span class="comment">/* Add new targets */</span>
<a name="l00426"></a>00426         block-&gt;<a class="code" href="classSgAsmBlock.html#a5bc8828b73e2e1695e336a618ca3213b">set_successors_complete</a>(<span class="keyword">true</span>);
<a name="l00427"></a>00427         block-&gt;<a class="code" href="classSgAsmBlock.html#aba2774c1d3c913d6a46cf3de05390336">get_successors</a>().clear();
<a name="l00428"></a>00428         <span class="keyword">typename</span> boost::graph_traits&lt;ControlFlowGraph&gt;::out_edge_iterator ei, ei_end;
<a name="l00429"></a>00429         <span class="keywordflow">for</span> (boost::tie(ei, ei_end)=out_edges(*vi, cfg); ei!=ei_end; ++ei) {
<a name="l00430"></a>00430             <a class="code" href="classSgAsmBlock.html">SgAsmBlock</a> *target_block = <span class="keyword">get</span>(boost::vertex_name, cfg, target(*ei, cfg));
<a name="l00431"></a>00431             <span class="keywordflow">if</span> (target_block &amp;&amp; !<a class="code" href="classBinaryAnalysis_1_1ControlFlow.html#aa5f92125604556805185b1093276cbbd" title="Determines if an edge is filtered out.">is_edge_filtered</a>(block, target_block)) {
<a name="l00432"></a>00432                 <a class="code" href="classSgAsmTarget.html" title="This class represents a possible link between SgAsmBlock objects.">SgAsmTarget</a> *target = <span class="keyword">new</span> <a class="code" href="classSgAsmTarget.html" title="This class represents a possible link between SgAsmBlock objects.">SgAsmTarget</a>();
<a name="l00433"></a>00433                 target-&gt;<a class="code" href="classSgAsmTarget.html#a9db652bb773a613fdb2d651ba5838133">set_address</a>(target_block-&gt;<a class="code" href="classSgAsmStatement.html#a9d16f5ff82380f8b9c4071afe9f094a5">get_address</a>());
<a name="l00434"></a>00434                 target-&gt;<a class="code" href="classSgAsmTarget.html#aa78cae8eb71511db475ff09dc552e075">set_block</a>(target_block);
<a name="l00435"></a>00435             }
<a name="l00436"></a>00436         }
<a name="l00437"></a>00437     }
<a name="l00438"></a>00438 }
<a name="l00439"></a>00439 
<a name="l00440"></a>00440 <span class="keyword">template</span>&lt;<span class="keyword">class</span> ControlFlowGraph&gt;
<a name="l00441"></a>00441 <span class="keywordtype">void</span>
<a name="l00442"></a><a class="code" href="classBinaryAnalysis_1_1ControlFlow.html#a14567bd8326f28398c92a7e0336d4db2">00442</a> <a class="code" href="classBinaryAnalysis_1_1ControlFlow.html#a14567bd8326f28398c92a7e0336d4db2" title="Cache vertex descriptors in AST.">BinaryAnalysis::ControlFlow::cache_vertex_descriptors</a>(<span class="keyword">const</span> ControlFlowGraph &amp;cfg)
<a name="l00443"></a>00443 {
<a name="l00444"></a>00444     <span class="keyword">typename</span> boost::graph_traits&lt;ControlFlowGraph&gt;::vertex_iterator vi, vi_end;
<a name="l00445"></a>00445     <span class="keywordflow">for</span> (boost::tie(vi, vi_end)=vertices(cfg); vi!=vi_end; ++vi) {
<a name="l00446"></a>00446         <a class="code" href="classSgAsmBlock.html">SgAsmBlock</a> *block = <span class="keyword">get</span>(boost::vertex_name, cfg, *vi);
<a name="l00447"></a>00447         <span class="keywordflow">if</span> (block &amp;&amp; !is_vertex_filtered(block))
<a name="l00448"></a>00448             block-&gt;<a class="code" href="classSgAsmBlock.html#a74a6e0cfca3498557b3024ffcb21b8a6">set_cached_vertex</a>(*vi);
<a name="l00449"></a>00449     }
<a name="l00450"></a>00450 }
<a name="l00451"></a>00451 
<a name="l00452"></a>00452 <span class="keyword">template</span>&lt;<span class="keyword">class</span> ControlFlowGraph&gt;
<a name="l00453"></a>00453 <span class="keywordtype">void</span>
<a name="l00454"></a><a class="code" href="classBinaryAnalysis_1_1ControlFlow.html#a90289a604cc914cda65a6a8d32f6ad1f">00454</a> <a class="code" href="classBinaryAnalysis_1_1ControlFlow.html#aacbfd1c9c77baee618228c5e4934cbeb" title="Builds a control flow graph for part of an AST.">BinaryAnalysis::ControlFlow::build_cfg_from_ast</a>(<a class="code" href="classSgNode.html" title="This class represents the base class for all IR nodes within Sage III.">SgNode</a> *root, ControlFlowGraph &amp;cfg)
<a name="l00455"></a>00455 {
<a name="l00456"></a>00456     <span class="keyword">typedef</span> <span class="keyword">typename</span> boost::graph_traits&lt;ControlFlowGraph&gt;::vertex_descriptor Vertex;
<a name="l00457"></a>00457     <span class="keyword">typedef</span> std::map&lt;SgAsmBlock*, Vertex&gt; BlockVertexMap;
<a name="l00458"></a>00458     BlockVertexMap bv_map;
<a name="l00459"></a>00459 
<a name="l00460"></a>00460     cfg.clear();
<a name="l00461"></a>00461 
<a name="l00462"></a>00462     <span class="comment">/* Define the vertices. */</span>
<a name="l00463"></a>00463     <span class="keyword">struct </span>T1: <span class="keyword">public</span> <a class="code" href="classAstSimpleProcessing.html" title="Class for traversing the AST.">AstSimpleProcessing</a> {
<a name="l00464"></a>00464         <a class="code" href="classBinaryAnalysis_1_1ControlFlow.html" title="Binary control flow analysis.">ControlFlow</a> *analyzer;
<a name="l00465"></a>00465         ControlFlowGraph &amp;cfg;
<a name="l00466"></a>00466         BlockVertexMap &amp;bv_map;
<a name="l00467"></a>00467         T1(<a class="code" href="classBinaryAnalysis_1_1ControlFlow.html" title="Binary control flow analysis.">ControlFlow</a> *analyzer, ControlFlowGraph &amp;cfg, BlockVertexMap &amp;bv_map)
<a name="l00468"></a>00468             : analyzer(analyzer), cfg(cfg), bv_map(bv_map)
<a name="l00469"></a>00469             {}
<a name="l00470"></a>00470         <span class="keywordtype">void</span> visit(<a class="code" href="classSgNode.html" title="This class represents the base class for all IR nodes within Sage III.">SgNode</a> *node) {
<a name="l00471"></a>00471             <a class="code" href="classSgAsmBlock.html">SgAsmBlock</a> *block = <a class="code" href="Cxx__Grammar_8h.html#a0f21c6b7a4aede1900e16a5122233a83">isSgAsmBlock</a>(node);
<a name="l00472"></a>00472             <span class="keywordflow">if</span> (block &amp;&amp; !analyzer-&gt;<a class="code" href="classBinaryAnalysis_1_1ControlFlow.html#a5e6e8bcad74de9f7774aaef4b020551b" title="Determines if a vertex is filtered out.">is_vertex_filtered</a>(block)) {
<a name="l00473"></a>00473                 Vertex vertex = add_vertex(cfg);
<a name="l00474"></a>00474                 bv_map[block] = vertex;
<a name="l00475"></a>00475                 put(boost::vertex_name, cfg, vertex, block);
<a name="l00476"></a>00476             }
<a name="l00477"></a>00477         }
<a name="l00478"></a>00478     };
<a name="l00479"></a>00479     T1(<span class="keyword">this</span>, cfg, bv_map).traverse(root, <a class="code" href="Cxx__Grammar_8h.html#a59f7fee88581c4dd75f5fb25dbefa29eadefb5d09673c144dc5b4dc177e278696">preorder</a>); <span class="comment">/* preorder guarantees that the highest SgAsmBlock will be vertex zero */</span>
<a name="l00480"></a>00480 
<a name="l00481"></a>00481     <span class="comment">/* Add the edges. */</span>
<a name="l00482"></a>00482     <span class="keyword">typename</span> boost::graph_traits&lt;ControlFlowGraph&gt;::vertex_iterator vi, vi_end;
<a name="l00483"></a>00483     <span class="keywordflow">for</span> (boost::tie(vi, vi_end)=vertices(cfg); vi!=vi_end; ++vi) {
<a name="l00484"></a>00484         <a class="code" href="classSgAsmBlock.html">SgAsmBlock</a> *source = boost::get(boost::vertex_name, cfg, *vi);
<a name="l00485"></a>00485         <span class="keyword">const</span> <a class="code" href="Cxx__Grammar_8h.html#af778ba3b929629b66fb8dffc3f20ccd3">SgAsmTargetPtrList</a> &amp;succs = source-&gt;<a class="code" href="classSgAsmBlock.html#aba2774c1d3c913d6a46cf3de05390336">get_successors</a>();
<a name="l00486"></a>00486         <span class="keywordflow">for</span> (SgAsmTargetPtrList::const_iterator si=succs.begin(); si!=succs.end(); ++si) {
<a name="l00487"></a>00487             <a class="code" href="classSgAsmBlock.html">SgAsmBlock</a> *target = (*si)-&gt;get_block(); <span class="comment">// might be null</span>
<a name="l00488"></a>00488             <span class="keywordflow">if</span> (target &amp;&amp; !is_edge_filtered(source, target)) {
<a name="l00489"></a>00489                 <span class="keyword">typename</span> BlockVertexMap::iterator bvmi=bv_map.find(target);
<a name="l00490"></a>00490                 <span class="keywordflow">if</span> (bvmi!=bv_map.end())
<a name="l00491"></a>00491                     add_edge(*vi, bvmi-&gt;second, cfg);
<a name="l00492"></a>00492             }
<a name="l00493"></a>00493         }
<a name="l00494"></a>00494     }
<a name="l00495"></a>00495 }
<a name="l00496"></a>00496 
<a name="l00497"></a>00497 <span class="keyword">template</span>&lt;<span class="keyword">class</span> ControlFlowGraph&gt;
<a name="l00498"></a>00498 <span class="keywordtype">void</span>
<a name="l00499"></a><a class="code" href="classBinaryAnalysis_1_1ControlFlow.html#ac859226b2cc7d8c00cdc639030840aa4">00499</a> <a class="code" href="classBinaryAnalysis_1_1ControlFlow.html#a7e084fca4986332d543aa90e442bdf00" title="Builds a control flow graph with only function call edges.">BinaryAnalysis::ControlFlow::build_cg_from_ast</a>(<a class="code" href="classSgNode.html" title="This class represents the base class for all IR nodes within Sage III.">SgNode</a> *root, ControlFlowGraph &amp;cfg<span class="comment">/*out*/</span>)
<a name="l00500"></a>00500 {
<a name="l00501"></a>00501     <span class="keyword">struct </span>T1: <span class="keyword">public</span> <a class="code" href="classBinaryAnalysis_1_1ControlFlow_1_1EdgeFilter.html" title="Filter for edges.">EdgeFilter</a> {
<a name="l00502"></a>00502         <a class="code" href="classBinaryAnalysis_1_1ControlFlow_1_1EdgeFilter.html" title="Filter for edges.">EdgeFilter</a> *parent;
<a name="l00503"></a>00503         T1(<a class="code" href="classBinaryAnalysis_1_1ControlFlow_1_1EdgeFilter.html" title="Filter for edges.">EdgeFilter</a> *parent): parent(parent) {}
<a name="l00504"></a>00504         <span class="keywordtype">bool</span> operator()(<a class="code" href="classBinaryAnalysis_1_1ControlFlow.html" title="Binary control flow analysis.">ControlFlow</a> *analyzer, <a class="code" href="classSgAsmBlock.html">SgAsmBlock</a> *src, <a class="code" href="classSgAsmBlock.html">SgAsmBlock</a> *dst) {
<a name="l00505"></a>00505             <a class="code" href="classSgAsmFunction.html">SgAsmFunction</a> *func = dst ? dst-&gt;<a class="code" href="classSgAsmBlock.html#abdd6257d93832cc2b0dcbdf07f9ccd3c">get_enclosing_function</a>() : NULL;
<a name="l00506"></a>00506             <span class="keywordflow">if</span> (!func || dst!=func-&gt;<a class="code" href="classSgAsmFunction.html#ae4b655e005eac45d3436c18438d8e5e4">get_entry_block</a>())
<a name="l00507"></a>00507                 <span class="keywordflow">return</span> <span class="keyword">false</span>;
<a name="l00508"></a>00508             <span class="keywordflow">if</span> (parent)
<a name="l00509"></a>00509                 <span class="keywordflow">return</span> (*parent)(analyzer, src, dst);
<a name="l00510"></a>00510             <span class="keywordflow">return</span> <span class="keyword">true</span>;
<a name="l00511"></a>00511         }
<a name="l00512"></a>00512     };
<a name="l00513"></a>00513 
<a name="l00514"></a>00514     <a class="code" href="classBinaryAnalysis_1_1ControlFlow_1_1EdgeFilter.html" title="Filter for edges.">EdgeFilter</a> *parent = get_edge_filter();
<a name="l00515"></a>00515     T1 edge_filter(parent);
<a name="l00516"></a>00516     <span class="keywordflow">try</span> {
<a name="l00517"></a>00517         set_edge_filter(&amp;edge_filter);
<a name="l00518"></a>00518         build_cfg_from_ast(root, cfg);
<a name="l00519"></a>00519     } <span class="keywordflow">catch</span> (...) {
<a name="l00520"></a>00520         set_edge_filter(parent);
<a name="l00521"></a>00521         <span class="keywordflow">throw</span>;
<a name="l00522"></a>00522     }
<a name="l00523"></a>00523     set_edge_filter(parent);
<a name="l00524"></a>00524 }
<a name="l00525"></a>00525 
<a name="l00526"></a>00526 <span class="keyword">template</span>&lt;<span class="keyword">class</span> ControlFlowGraph&gt;
<a name="l00527"></a>00527 <span class="keywordtype">void</span>
<a name="l00528"></a><a class="code" href="classBinaryAnalysis_1_1ControlFlow.html#a256b126849613020f7eb6904708dfa8d">00528</a> <a class="code" href="classBinaryAnalysis_1_1ControlFlow.html#a5ff8f19f83b57e1e52d11b30cee174b8" title="Copies a graph while filtering.">BinaryAnalysis::ControlFlow::copy</a>(<span class="keyword">const</span> ControlFlowGraph &amp;src, ControlFlowGraph &amp;dst<span class="comment">/*out*/</span>)
<a name="l00529"></a>00529 {
<a name="l00530"></a>00530     <span class="keyword">typedef</span> <span class="keyword">typename</span> boost::graph_traits&lt;ControlFlowGraph&gt;::vertex_descriptor Vertex;
<a name="l00531"></a>00531     Vertex NO_VERTEX = boost::graph_traits&lt;ControlFlowGraph&gt;::null_vertex();
<a name="l00532"></a>00532 
<a name="l00533"></a>00533     dst.clear();
<a name="l00534"></a>00534     std::vector&lt;Vertex&gt; src_to_dst(num_vertices(src), NO_VERTEX);
<a name="l00535"></a>00535 
<a name="l00536"></a>00536     <span class="keyword">typename</span> boost::graph_traits&lt;ControlFlowGraph&gt;::vertex_iterator vi, vi_end;
<a name="l00537"></a>00537     <span class="keywordflow">for</span> (boost::tie(vi, vi_end)=vertices(src); vi!=vi_end; ++vi) {
<a name="l00538"></a>00538         <a class="code" href="classSgAsmBlock.html">SgAsmBlock</a> *block = <span class="keyword">get</span>(boost::vertex_name, src, *vi);
<a name="l00539"></a>00539         <span class="keywordflow">if</span> (!is_vertex_filtered(block)) {
<a name="l00540"></a>00540             src_to_dst[*vi] = add_vertex(dst);
<a name="l00541"></a>00541             put(boost::vertex_name, dst, src_to_dst[*vi], block);
<a name="l00542"></a>00542         }
<a name="l00543"></a>00543     }
<a name="l00544"></a>00544 
<a name="l00545"></a>00545     <span class="keyword">typename</span> boost::graph_traits&lt;ControlFlowGraph&gt;::edge_iterator ei, ei_end;
<a name="l00546"></a>00546     <span class="keywordflow">for</span> (boost::tie(ei, ei_end)=edges(src); ei!=ei_end; ++ei) {
<a name="l00547"></a>00547         <span class="keywordflow">if</span> (NO_VERTEX!=src_to_dst[source(*ei, src)] &amp;&amp; NO_VERTEX!=src_to_dst[target(*ei, src)]) {
<a name="l00548"></a>00548             <a class="code" href="classSgAsmBlock.html">SgAsmBlock</a> *block1 = <span class="keyword">get</span>(boost::vertex_name, src, source(*ei, src));
<a name="l00549"></a>00549             <a class="code" href="classSgAsmBlock.html">SgAsmBlock</a> *block2 = <span class="keyword">get</span>(boost::vertex_name, src, target(*ei, src));
<a name="l00550"></a>00550             <span class="keywordflow">if</span> (!is_edge_filtered(block1, block2))
<a name="l00551"></a>00551                 add_edge(src_to_dst[source(*ei, src)], src_to_dst[target(*ei, src)], dst);
<a name="l00552"></a>00552         }
<a name="l00553"></a>00553     }
<a name="l00554"></a>00554 }
<a name="l00555"></a>00555 
<a name="l00556"></a>00556 <span class="keyword">template</span>&lt;<span class="keyword">class</span> ControlFlowGraph&gt;
<a name="l00557"></a>00557 ControlFlowGraph
<a name="l00558"></a><a class="code" href="classBinaryAnalysis_1_1ControlFlow.html#a5ff8f19f83b57e1e52d11b30cee174b8">00558</a> <a class="code" href="classBinaryAnalysis_1_1ControlFlow.html#a5ff8f19f83b57e1e52d11b30cee174b8" title="Copies a graph while filtering.">BinaryAnalysis::ControlFlow::copy</a>(<span class="keyword">const</span> ControlFlowGraph &amp;src)
<a name="l00559"></a>00559 {
<a name="l00560"></a>00560     ControlFlowGraph dst;
<a name="l00561"></a>00561     copy(src, dst);
<a name="l00562"></a>00562     <span class="keywordflow">return</span> dst;
<a name="l00563"></a>00563 }
<a name="l00564"></a>00564 
<a name="l00565"></a>00565 <span class="keyword">template</span>&lt;<span class="keyword">class</span> ControlFlowGraph&gt;
<a name="l00566"></a>00566 <span class="keywordtype">void</span>
<a name="l00567"></a><a class="code" href="structBinaryAnalysis_1_1ControlFlow_1_1FlowOrder.html#a22e5735c5cad972619db5c17d4f99603">00567</a> <a class="code" href="structBinaryAnalysis_1_1ControlFlow_1_1FlowOrder.html">BinaryAnalysis::ControlFlow::FlowOrder&lt;ControlFlowGraph&gt;::compute</a>(<span class="keyword">const</span> ControlFlowGraph &amp;g, <a class="code" href="structBinaryAnalysis_1_1ControlFlow_1_1FlowOrder.html#a3ed6228f9cd259e8cb6ca340e2fc39bc">Vertex</a> v0,
<a name="l00568"></a>00568                                                                   <a class="code" href="structBinaryAnalysis_1_1ControlFlow_1_1FlowOrder.html#a4335b4d700de1b01fd13835ce9d57637">ReverseVertexList</a> *reverse_order) {
<a name="l00569"></a>00569     forward_order-&gt;clear();
<a name="l00570"></a>00570     std::vector&lt;boost::default_color_type&gt; colors(num_vertices(g), boost::white_color);
<a name="l00571"></a>00571     depth_first_visit(g, v0, *<span class="keyword">this</span>, &amp;(colors[0]));
<a name="l00572"></a>00572     assert(!forward_order-&gt;empty()); <span class="comment">/* it should at least contain v0 */</span>
<a name="l00573"></a>00573     std::reverse(forward_order-&gt;begin(), forward_order-&gt;end());
<a name="l00574"></a>00574     <span class="keywordflow">if</span> (reverse_order) {
<a name="l00575"></a>00575         reverse_order-&gt;clear();
<a name="l00576"></a>00576         reverse_order-&gt;resize(num_vertices(g), (<span class="keywordtype">size_t</span>)(-1));
<a name="l00577"></a>00577         <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> i=0; i&lt;forward_order-&gt;size(); i++)
<a name="l00578"></a>00578             (*reverse_order)[(*forward_order)[i]] = i;
<a name="l00579"></a>00579     }
<a name="l00580"></a>00580 }
<a name="l00581"></a>00581 
<a name="l00582"></a>00582 <span class="keyword">template</span>&lt;<span class="keyword">class</span> ControlFlowGraph&gt;
<a name="l00583"></a>00583 <span class="keywordtype">void</span>
<a name="l00584"></a><a class="code" href="structBinaryAnalysis_1_1ControlFlow_1_1FlowOrder.html#a0e5c9c743d077c26c320f328e4e370f8">00584</a> <a class="code" href="structBinaryAnalysis_1_1ControlFlow_1_1FlowOrder.html">BinaryAnalysis::ControlFlow::FlowOrder&lt;ControlFlowGraph&gt;::finish_vertex</a>(<a class="code" href="structBinaryAnalysis_1_1ControlFlow_1_1FlowOrder.html#a3ed6228f9cd259e8cb6ca340e2fc39bc">Vertex</a> v, ControlFlowGraph g) {
<a name="l00585"></a>00585     forward_order-&gt;push_back(v);
<a name="l00586"></a>00586 }
<a name="l00587"></a>00587 
<a name="l00588"></a>00588 <span class="keyword">template</span>&lt;<span class="keyword">class</span> ControlFlowGraph&gt;
<a name="l00589"></a>00589 std::vector&lt;typename boost::graph_traits&lt;ControlFlowGraph&gt;::vertex_descriptor&gt;
<a name="l00590"></a><a class="code" href="classBinaryAnalysis_1_1ControlFlow.html#a6efa50703657c9b3521a9d3e961d265d">00590</a> <a class="code" href="classBinaryAnalysis_1_1ControlFlow.html#a6efa50703657c9b3521a9d3e961d265d" title="Orders nodes by depth first search reverse post order.">BinaryAnalysis::ControlFlow::flow_order</a>(<span class="keyword">const</span> ControlFlowGraph &amp;cfg,
<a name="l00591"></a>00591                                         <span class="keyword">typename</span> boost::graph_traits&lt;ControlFlowGraph&gt;::vertex_descriptor start,
<a name="l00592"></a>00592                                         std::vector&lt;size_t&gt; *reverse_order<span class="comment">/*=NULL*/</span>)
<a name="l00593"></a>00593 {
<a name="l00594"></a>00594     std::vector&lt;typename boost::graph_traits&lt;ControlFlowGraph&gt;::vertex_descriptor&gt; forward_order;
<a name="l00595"></a>00595     <a class="code" href="structBinaryAnalysis_1_1ControlFlow_1_1FlowOrder.html">FlowOrder&lt;ControlFlowGraph&gt;</a>(&amp;forward_order).compute(cfg, start, reverse_order);
<a name="l00596"></a>00596     <span class="keywordflow">return</span> forward_order;
<a name="l00597"></a>00597 }
<a name="l00598"></a>00598 
<a name="l00599"></a>00599 <span class="keyword">template</span>&lt;<span class="keyword">class</span> ControlFlowGraph&gt;
<a name="l00600"></a>00600 <span class="keywordtype">void</span>
<a name="l00601"></a><a class="code" href="structBinaryAnalysis_1_1ControlFlow_1_1ReturnBlocks.html#a085b412b5d5dc3adfd4a86053786d9a9">00601</a> <a class="code" href="structBinaryAnalysis_1_1ControlFlow_1_1ReturnBlocks.html">BinaryAnalysis::ControlFlow::ReturnBlocks&lt;ControlFlowGraph&gt;::finish_vertex</a>(<a class="code" href="structBinaryAnalysis_1_1ControlFlow_1_1ReturnBlocks.html#a21add2d6c0b3947c61092b0dd8ac7efc">Vertex</a> v, ControlFlowGraph g)
<a name="l00602"></a>00602 {
<a name="l00603"></a>00603     <span class="keyword">typename</span> boost::graph_traits&lt;ControlFlowGraph&gt;::out_edge_iterator ei, ei_end;
<a name="l00604"></a>00604     boost::tie(ei, ei_end) = out_edges(v, g);
<a name="l00605"></a>00605     <span class="keywordflow">if</span> (ei==ei_end)
<a name="l00606"></a>00606         blocks.push_back(v);
<a name="l00607"></a>00607 }
<a name="l00608"></a>00608     
<a name="l00609"></a>00609 <span class="keyword">template</span>&lt;<span class="keyword">class</span> ControlFlowGraph&gt;
<a name="l00610"></a>00610 std::vector&lt;typename boost::graph_traits&lt;ControlFlowGraph&gt;::vertex_descriptor&gt;
<a name="l00611"></a><a class="code" href="classBinaryAnalysis_1_1ControlFlow.html#a6a96acd6e23f8cec283a20bed4086bae">00611</a> <a class="code" href="classBinaryAnalysis_1_1ControlFlow.html#a6a96acd6e23f8cec283a20bed4086bae" title="Returns list of function return blocks.">BinaryAnalysis::ControlFlow::return_blocks</a>(<span class="keyword">const</span> ControlFlowGraph &amp;cfg,
<a name="l00612"></a>00612                                            <span class="keyword">typename</span> boost::graph_traits&lt;ControlFlowGraph&gt;::vertex_descriptor start)
<a name="l00613"></a>00613 {
<a name="l00614"></a>00614     <span class="keyword">typename</span> <a class="code" href="structBinaryAnalysis_1_1ControlFlow_1_1ReturnBlocks.html#a5044ea2766d5c4dfd78b311fe6bd14ea">ReturnBlocks&lt;ControlFlowGraph&gt;::Vector</a> result;
<a name="l00615"></a>00615     <a class="code" href="structBinaryAnalysis_1_1ControlFlow_1_1ReturnBlocks.html">ReturnBlocks&lt;ControlFlowGraph&gt;</a> visitor(result);
<a name="l00616"></a>00616     std::vector&lt;boost::default_color_type&gt; colors(num_vertices(cfg), boost::white_color);
<a name="l00617"></a>00617     depth_first_visit(cfg, start, visitor, &amp;(colors[0]));
<a name="l00618"></a>00618     <span class="keywordflow">return</span> result;
<a name="l00619"></a>00619 }
<a name="l00620"></a>00620 
<a name="l00621"></a>00621 <span class="keyword">template</span>&lt;<span class="keyword">class</span> ControlFlowGraph&gt;
<a name="l00622"></a>00622 ControlFlowGraph
<a name="l00623"></a><a class="code" href="classBinaryAnalysis_1_1ControlFlow.html#aacbfd1c9c77baee618228c5e4934cbeb">00623</a> <a class="code" href="classBinaryAnalysis_1_1ControlFlow.html#aacbfd1c9c77baee618228c5e4934cbeb" title="Builds a control flow graph for part of an AST.">BinaryAnalysis::ControlFlow::build_cfg_from_ast</a>(<a class="code" href="classSgNode.html" title="This class represents the base class for all IR nodes within Sage III.">SgNode</a> *root)
<a name="l00624"></a>00624 {
<a name="l00625"></a>00625     ControlFlowGraph cfg;
<a name="l00626"></a>00626     build_cfg_from_ast(root, cfg);
<a name="l00627"></a>00627     <span class="keywordflow">return</span> cfg;
<a name="l00628"></a>00628 }
<a name="l00629"></a>00629 
<a name="l00630"></a>00630 <span class="keyword">template</span>&lt;<span class="keyword">class</span> ControlFlowGraph&gt;
<a name="l00631"></a>00631 ControlFlowGraph
<a name="l00632"></a><a class="code" href="classBinaryAnalysis_1_1ControlFlow.html#a7e084fca4986332d543aa90e442bdf00">00632</a> <a class="code" href="classBinaryAnalysis_1_1ControlFlow.html#a7e084fca4986332d543aa90e442bdf00" title="Builds a control flow graph with only function call edges.">BinaryAnalysis::ControlFlow::build_cg_from_ast</a>(<a class="code" href="classSgNode.html" title="This class represents the base class for all IR nodes within Sage III.">SgNode</a> *root)
<a name="l00633"></a>00633 {
<a name="l00634"></a>00634     ControlFlowGraph cfg;
<a name="l00635"></a>00635     build_cg_from_ast(root, cfg);
<a name="l00636"></a>00636     <span class="keywordflow">return</span> cfg;
<a name="l00637"></a>00637 }
<a name="l00638"></a>00638 
<a name="l00639"></a>00639 <span class="preprocessor">#endif</span>
</pre></div></div>
</div>
  <div id="nav-path" class="navpath">
    <ul>
      <li class="navelem"><a class="el" href="BinaryControlFlow_8h.html">BinaryControlFlow.h</a>      </li>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
<a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(0)"><span class="SelectionMark">&#160;</span>All</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(1)"><span class="SelectionMark">&#160;</span>Classes</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(2)"><span class="SelectionMark">&#160;</span>Namespaces</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(3)"><span class="SelectionMark">&#160;</span>Files</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(4)"><span class="SelectionMark">&#160;</span>Functions</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(5)"><span class="SelectionMark">&#160;</span>Variables</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(6)"><span class="SelectionMark">&#160;</span>Typedefs</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(7)"><span class="SelectionMark">&#160;</span>Enumerations</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(8)"><span class="SelectionMark">&#160;</span>Enumerator</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(9)"><span class="SelectionMark">&#160;</span>Friends</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(10)"><span class="SelectionMark">&#160;</span>Defines</a></div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>


    <li class="footer">Generated on Thu Dec 1 2011 16:31:13 for ROSE by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.7.5.1 </li>
   </ul>
 </div>


</body>
</html>
